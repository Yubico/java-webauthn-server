// Copyright (c) 2018, Yubico AB
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
// 1. Redistributions of source code must retain the above copyright notice, this
//    list of conditions and the following disclaimer.
//
// 2. Redistributions in binary form must reproduce the above copyright notice,
//    this list of conditions and the following disclaimer in the documentation
//    and/or other materials provided with the distribution.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

package com.yubico.webauthn

import com.fasterxml.jackson.databind.JsonNode
import com.fasterxml.jackson.databind.node.JsonNodeFactory
import com.fasterxml.jackson.databind.node.ObjectNode
import com.yubico.internal.util.CertificateParser
import com.yubico.internal.util.JacksonCodecs
import com.yubico.webauthn.TestAuthenticator.AttestationCert
import com.yubico.webauthn.TestAuthenticator.AttestationMaker
import com.yubico.webauthn.TestAuthenticator.AttestationSigner
import com.yubico.webauthn.data.AttestationObject
import com.yubico.webauthn.data.AuthenticatorAssertionResponse
import com.yubico.webauthn.data.AuthenticatorAttestationResponse
import com.yubico.webauthn.data.AuthenticatorSelectionCriteria
import com.yubico.webauthn.data.AuthenticatorTransport
import com.yubico.webauthn.data.ByteArray
import com.yubico.webauthn.data.COSEAlgorithmIdentifier
import com.yubico.webauthn.data.ClientAssertionExtensionOutputs
import com.yubico.webauthn.data.ClientRegistrationExtensionOutputs
import com.yubico.webauthn.data.CollectedClientData
import com.yubico.webauthn.data.PublicKeyCredential
import com.yubico.webauthn.data.PublicKeyCredentialCreationOptions
import com.yubico.webauthn.data.PublicKeyCredentialParameters
import com.yubico.webauthn.data.RegistrationExtensionInputs
import com.yubico.webauthn.data.RelyingPartyIdentity
import com.yubico.webauthn.data.UserIdentity
import org.bouncycastle.asn1.ASN1ObjectIdentifier
import org.bouncycastle.asn1.DERSequence
import org.bouncycastle.asn1.DERUTF8String
import org.bouncycastle.asn1.x500.AttributeTypeAndValue
import org.bouncycastle.asn1.x500.RDN
import org.bouncycastle.asn1.x500.X500Name
import org.bouncycastle.asn1.x509.Extension
import org.bouncycastle.asn1.x509.GeneralName
import org.bouncycastle.asn1.x509.GeneralNamesBuilder

import java.nio.charset.StandardCharsets
import java.security.KeyFactory
import java.security.KeyPair
import java.security.PrivateKey
import java.security.cert.X509Certificate
import java.security.spec.PKCS8EncodedKeySpec
import scala.jdk.CollectionConverters._
import scala.jdk.OptionConverters.RichOption
import scala.util.Failure
import scala.util.Success
import scala.util.Try

object RegistrationTestDataGenerator extends App {
  regenerateTestData()

  def importAttestationCa(
      certBase64: String,
      keyAlgorithm: String,
      keyBase64: String,
  ): (X509Certificate, PrivateKey) = {
    val cert: X509Certificate = CertificateParser.parsePem(certBase64)

    val kf = KeyFactory.getInstance(keyAlgorithm)
    val key: PrivateKey = kf.generatePrivate(
      new PKCS8EncodedKeySpec(ByteArray.fromBase64(keyBase64).getBytes)
    )

    (cert, key)
  }

  def printTestDataCode(
      testData: RegistrationTestData
  ): Unit = {
    println(
      s"""alg = COSEAlgorithmIdentifier.${testData.alg.name},
               |attestationObject = ByteArray.fromHex("${testData.attestationObject.getHex}"),
               |clientDataJson = \"\"\"${testData.clientDataJson}\"\"\",
               |privateKey = Some(ByteArray.fromHex("${testData.privateKey.get.getHex}")),""".stripMargin
    )

    if (testData.attestationCertChain.nonEmpty) {
      println(s"""attestationCertChain = List(${testData.attestationCertChain
        .map({
          case (cert, key) =>
            s"""RegistrationTestDataGenerator.importAttestationCa("${new ByteArray(
              cert.getEncoded
            ).getBase64}", "${key.getAlgorithm}", "${new ByteArray(
              key.getEncoded
            ).getBase64}")"""
        })
        .mkString(", ")}),""")
    }

    testData.assertion foreach { assertion =>
      println(s"""|assertion = Some(AssertionTestData(
                  |  request = JacksonCodecs.json().readValue(\"\"\"${JacksonCodecs
        .json()
        .writeValueAsString(
          assertion.request
        )}\"\"\", classOf[AssertionRequest]),
                  |  response = PublicKeyCredential.parseAssertionResponseJson(\"\"\"${JacksonCodecs
        .json()
        .writeValueAsString(assertion.response)}\"\"\")
                  |)),
                  """.stripMargin)
    }
  }

  def regenerateTestData(): Unit = {
    val td = RegistrationTestData
    for {
      (testData, i) <- List(
        td.AndroidSafetynet.BasicAttestation,
        td.AndroidSafetynet.WrongHostname,
        td.AndroidSafetynet.FalseCtsProfileMatch,
        td.FidoU2f.BasicAttestation,
        td.FidoU2f.SelfAttestation,
        td.NoneAttestation.Default,
        td.Packed.BasicAttestation,
        td.Packed.BasicAttestationEdDsa,
        td.Packed.BasicAttestationRsa,
        td.Packed.BasicAttestationRs1,
        td.Packed.BasicAttestationWithoutAaguidExtension,
        td.Packed.BasicAttestationWithWrongAaguidExtension,
        td.Packed.SelfAttestation,
        td.Packed.SelfAttestationRs1,
        td.Tpm.ValidEs256,
        td.Tpm.ValidEs384,
        td.Tpm.ValidEs512,
        td.Tpm.ValidRs256,
        td.Tpm.ValidRs1,
      ).zipWithIndex
    } {
      testData.regenerateFull() match {
        case Success(newTestData) =>
          println(i)
          printTestDataCode(newTestData)
        case Failure(e) =>
          println("Failed to regenerate")
          e.printStackTrace()
      }
    }
  }
}

object RegistrationTestData {
  private def jsonFactory: JsonNodeFactory = JsonNodeFactory.instance

  def defaultSettingsValidExamples =
    List(
      AndroidSafetynet.RealExample,
      AndroidSafetynet.BasicAttestation,
      FidoU2f.BasicAttestation,
      FidoU2f.SelfAttestation,
      NoneAttestation.Default,
      Packed.BasicAttestation,
      Packed.BasicAttestationEdDsa,
      Packed.BasicAttestationRsa,
      Packed.BasicAttestationRsaReal,
      Packed.SelfAttestation,
      Tpm.RealExample,
      Tpm.ValidEs256,
      Tpm.ValidEs384,
      Tpm.ValidEs512,
      Tpm.ValidRs256,
    )

  object AndroidKey {
    val BasicAttestation: RegistrationTestData =
      Packed.SelfAttestation.setAttestationStatementFormat("android-key")
  }
  object AndroidSafetynet {
    val RealExample: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromBase64Url("o2NmbXRxYW5kcm9pZC1zYWZldHluZXRnYXR0U3RtdKJjdmVyaDE0Nzk5MDIxaHJlc3BvbnNlWRS9ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbmcxWXlJNld5Sk5TVWxHYTJwRFEwSkljV2RCZDBsQ1FXZEpVVkpZY205T01GcFBaRkpyUWtGQlFVRkJRVkIxYm5wQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFSkRUVkZ6ZDBOUldVUldVVkZIUlhkS1ZsVjZSV1ZOUW5kSFFURlZSVU5vVFZaU01qbDJXako0YkVsR1VubGtXRTR3U1VaT2JHTnVXbkJaTWxaNlRWSk5kMFZSV1VSV1VWRkVSWGR3U0ZaR1RXZFJNRVZuVFZVNGVFMUNORmhFVkVVMFRWUkJlRTFFUVROTlZHc3dUbFp2V0VSVVJUVk5WRUYzVDFSQk0wMVVhekJPVm05M1lrUkZURTFCYTBkQk1WVkZRbWhOUTFaV1RYaEZla0ZTUW1kT1ZrSkJaMVJEYTA1b1lrZHNiV0l6U25WaFYwVjRSbXBCVlVKblRsWkNRV05VUkZVeGRtUlhOVEJaVjJ4MVNVWmFjRnBZWTNoRmVrRlNRbWRPVmtKQmIxUkRhMlIyWWpKa2MxcFRRazFVUlUxNFIzcEJXa0puVGxaQ1FVMVVSVzFHTUdSSFZucGtRelZvWW0xU2VXSXliR3RNYlU1MllsUkRRMEZUU1hkRVVWbEtTMjlhU1doMlkwNUJVVVZDUWxGQlJHZG5SVkJCUkVORFFWRnZRMmRuUlVKQlRtcFlhM293WlVzeFUwVTBiU3N2UnpWM1QyOHJXRWRUUlVOeWNXUnVPRGh6UTNCU04yWnpNVFJtU3pCU2FETmFRMWxhVEVaSWNVSnJOa0Z0V2xaM01rczVSa2N3VHpseVVsQmxVVVJKVmxKNVJUTXdVWFZ1VXpsMVowaEROR1ZuT1c5MmRrOXRLMUZrV2pKd09UTllhSHAxYmxGRmFGVlhXRU40UVVSSlJVZEtTek5UTW1GQlpucGxPVGxRVEZNeU9XaE1ZMUYxV1ZoSVJHRkROMDlhY1U1dWIzTnBUMGRwWm5NNGRqRnFhVFpJTDNob2JIUkRXbVV5YkVvck4wZDFkSHBsZUV0d2VIWndSUzkwV2xObVlsazVNRFZ4VTJ4Q2FEbG1jR293TVRWamFtNVJSbXRWYzBGVmQyMUxWa0ZWZFdWVmVqUjBTMk5HU3pSd1pYWk9UR0Y0UlVGc0swOXJhV3hOZEVsWlJHRmpSRFZ1Wld3MGVFcHBlWE0wTVROb1lXZHhWekJYYUdnMVJsQXpPV2hIYXpsRkwwSjNVVlJxWVhwVGVFZGtkbGd3YlRaNFJsbG9hQzh5VmsxNVdtcFVORXQ2VUVwRlEwRjNSVUZCWVU5RFFXeG5kMmRuU2xWTlFUUkhRVEZWWkVSM1JVSXZkMUZGUVhkSlJtOUVRVlJDWjA1V1NGTlZSVVJFUVV0Q1oyZHlRbWRGUmtKUlkwUkJWRUZOUW1kT1ZraFNUVUpCWmpoRlFXcEJRVTFDTUVkQk1WVmtSR2RSVjBKQ1VYRkNVWGRIVjI5S1FtRXhiMVJMY1hWd2J6UlhObmhVTm1veVJFRm1RbWRPVmtoVFRVVkhSRUZYWjBKVFdUQm1hSFZGVDNaUWJTdDRaMjU0YVZGSE5rUnlabEZ1T1V0NlFtdENaMmR5UW1kRlJrSlJZMEpCVVZKWlRVWlpkMHAzV1VsTGQxbENRbEZWU0UxQlIwZEhNbWd3WkVoQk5reDVPWFpaTTA1M1RHNUNjbUZUTlc1aU1qbHVUREprTUdONlJuWk5WRUZ5UW1kbmNrSm5SVVpDVVdOM1FXOVpabUZJVWpCalJHOTJURE5DY21GVE5XNWlNamx1VERKa2VtTnFTWFpTTVZKVVRWVTRlRXh0VG5sa1JFRmtRbWRPVmtoU1JVVkdha0ZWWjJoS2FHUklVbXhqTTFGMVdWYzFhMk50T1hCYVF6VnFZakl3ZDBsUldVUldVakJuUWtKdmQwZEVRVWxDWjFwdVoxRjNRa0ZuU1hkRVFWbExTM2RaUWtKQlNGZGxVVWxHUVhwQmRrSm5UbFpJVWpoRlMwUkJiVTFEVTJkSmNVRm5hR2cxYjJSSVVuZFBhVGgyV1ROS2MweHVRbkpoVXpWdVlqSTVia3d3WkZWVmVrWlFUVk0xYW1OdGQzZG5aMFZGUW1kdmNrSm5SVVZCWkZvMVFXZFJRMEpKU0RGQ1NVaDVRVkJCUVdSM1EydDFVVzFSZEVKb1dVWkpaVGRGTmt4TldqTkJTMUJFVjFsQ1VHdGlNemRxYW1RNE1FOTVRVE5qUlVGQlFVRlhXbVJFTTFCTVFVRkJSVUYzUWtsTlJWbERTVkZEVTFwRFYyVk1Tblp6YVZaWE5rTm5LMmRxTHpsM1dWUktVbnAxTkVocGNXVTBaVmswWXk5dGVYcHFaMGxvUVV4VFlta3ZWR2g2WTNweGRHbHFNMlJyTTNaaVRHTkpWek5NYkRKQ01HODNOVWRSWkdoTmFXZGlRbWRCU0ZWQlZtaFJSMjFwTDFoM2RYcFVPV1ZIT1ZKTVNTdDRNRm95ZFdKNVdrVldla0UzTlZOWlZtUmhTakJPTUVGQlFVWnRXRkU1ZWpWQlFVRkNRVTFCVW1wQ1JVRnBRbU5EZDBFNWFqZE9WRWRZVURJM09IbzBhSEl2ZFVOSWFVRkdUSGx2UTNFeVN6QXJlVXhTZDBwVlltZEpaMlk0WjBocWRuQjNNbTFDTVVWVGFuRXlUMll6UVRCQlJVRjNRMnR1UTJGRlMwWlZlVm8zWmk5UmRFbDNSRkZaU2t0dldrbG9kbU5PUVZGRlRFSlJRVVJuWjBWQ1FVazVibFJtVWt0SlYyZDBiRmRzTTNkQ1REVTFSVlJXTm10aGVuTndhRmN4ZVVGak5VUjFiVFpZVHpReGExcDZkMG8yTVhkS2JXUlNVbFF2VlhORFNYa3hTMFYwTW1Nd1JXcG5iRzVLUTBZeVpXRjNZMFZYYkV4UldUSllVRXg1Um1wclYxRk9ZbE5vUWpGcE5GY3lUbEpIZWxCb2RETnRNV0kwT1doaWMzUjFXRTAyZEZnMVEzbEZTRzVVYURoQ2IyMDBMMWRzUm1sb2VtaG5iamd4Ukd4a2IyZDZMMHN5VlhkTk5sTTJRMEl2VTBWNGEybFdabllyZW1KS01ISnFkbWM1TkVGc1pHcFZabFYzYTBrNVZrNU5ha1ZRTldVNGVXUkNNMjlNYkRabmJIQkRaVVkxWkdkbVUxZzBWVGw0TXpWdmFpOUpTV1F6VlVVdlpGQndZaTl4WjBkMmMydG1aR1Y2ZEcxVmRHVXZTMU50Y21sM1kyZFZWMWRsV0daVVlra3plbk5wYTNkYVltdHdiVkpaUzIxcVVHMW9kalJ5YkdsNlIwTkhkRGhRYmpod2NUaE5Na3RFWmk5UU0ydFdiM1F6WlRFNFVUMGlMQ0pOU1VsRlUycERRMEY2UzJkQmQwbENRV2RKVGtGbFR6QnRjVWRPYVhGdFFrcFhiRkYxUkVGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGRVFrMU5VMEYzU0dkWlJGWlJVVXhGZUdSSVlrYzVhVmxYZUZSaFYyUjFTVVpLZG1JelVXZFJNRVZuVEZOQ1UwMXFSVlJOUWtWSFFURlZSVU5vVFV0U01uaDJXVzFHYzFVeWJHNWlha1ZVVFVKRlIwRXhWVVZCZUUxTFVqSjRkbGx0Um5OVk1teHVZbXBCWlVaM01IaE9la0V5VFZSVmQwMUVRWGRPUkVwaFJuY3dlVTFVUlhsTlZGVjNUVVJCZDA1RVNtRk5SVWw0UTNwQlNrSm5UbFpDUVZsVVFXeFdWRTFTTkhkSVFWbEVWbEZSUzBWNFZraGlNamx1WWtkVloxWklTakZqTTFGblZUSldlV1J0YkdwYVdFMTRSWHBCVWtKblRsWkNRVTFVUTJ0a1ZWVjVRa1JSVTBGNFZIcEZkMmRuUldsTlFUQkhRMU54UjFOSllqTkVVVVZDUVZGVlFVRTBTVUpFZDBGM1oyZEZTMEZ2U1VKQlVVUlJSMDA1UmpGSmRrNHdOWHByVVU4NUszUk9NWEJKVW5aS2VucDVUMVJJVnpWRWVrVmFhRVF5WlZCRGJuWlZRVEJSYXpJNFJtZEpRMlpMY1VNNVJXdHpRelJVTW1aWFFsbHJMMnBEWmtNelVqTldXazFrVXk5a1RqUmFTME5GVUZwU2NrRjZSSE5wUzFWRWVsSnliVUpDU2pWM2RXUm5lbTVrU1UxWlkweGxMMUpIUjBac05YbFBSRWxMWjJwRmRpOVRTa2d2VlV3clpFVmhiSFJPTVRGQ2JYTkxLMlZSYlUxR0t5dEJZM2hIVG1oeU5UbHhUUzg1YVd3M01Va3laRTQ0UmtkbVkyUmtkM1ZoWldvMFlsaG9jREJNWTFGQ1ltcDRUV05KTjBwUU1HRk5NMVEwU1N0RWMyRjRiVXRHYzJKcWVtRlVUa001ZFhwd1JteG5UMGxuTjNKU01qVjRiM2x1VlhoMk9IWk9iV3R4TjNwa1VFZElXR3Q0VjFrM2IwYzVhaXRLYTFKNVFrRkNhemRZY2twbWIzVmpRbHBGY1VaS1NsTlFhemRZUVRCTVMxY3dXVE42Tlc5Nk1rUXdZekYwU2t0M1NFRm5UVUpCUVVkcVoyZEZlazFKU1VKTWVrRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwRlpXWGRJVVZsRVZsSXdiRUpDV1hkR1FWbEpTM2RaUWtKUlZVaEJkMFZIUTBOelIwRlJWVVpDZDAxRFRVSkpSMEV4VldSRmQwVkNMM2RSU1UxQldVSkJaamhEUVZGQmQwaFJXVVJXVWpCUFFrSlpSVVpLYWxJclJ6UlJOamdyWWpkSFEyWkhTa0ZpYjA5ME9VTm1NSEpOUWpoSFFURlZaRWwzVVZsTlFtRkJSa3AyYVVJeFpHNUlRamRCWVdkaVpWZGlVMkZNWkM5alIxbFpkVTFFVlVkRFEzTkhRVkZWUmtKM1JVSkNRMnQzU25wQmJFSm5aM0pDWjBWR1FsRmpkMEZaV1ZwaFNGSXdZMFJ2ZGt3eU9XcGpNMEYxWTBkMGNFeHRaSFppTW1OMldqTk9lVTFxUVhsQ1owNVdTRkk0UlV0NlFYQk5RMlZuU21GQmFtaHBSbTlrU0ZKM1QyazRkbGt6U25OTWJrSnlZVk0xYm1JeU9XNU1NbVI2WTJwSmRsb3pUbmxOYVRWcVkyMTNkMUIzV1VSV1VqQm5Ra1JuZDA1cVFUQkNaMXB1WjFGM1FrRm5TWGRMYWtGdlFtZG5ja0puUlVaQ1VXTkRRVkpaWTJGSVVqQmpTRTAyVEhrNWQyRXlhM1ZhTWpsMlduazVlVnBZUW5aak1td3dZak5LTlV4NlFVNUNaMnR4YUd0cFJ6bDNNRUpCVVhOR1FVRlBRMEZSUlVGSGIwRXJUbTV1TnpoNU5uQlNhbVE1V0d4UlYwNWhOMGhVWjJsYUwzSXpVazVIYTIxVmJWbElVRkZ4TmxOamRHazVVRVZoYW5aM1VsUXlhVmRVU0ZGeU1ESm1aWE54VDNGQ1dUSkZWRlYzWjFwUksyeHNkRzlPUm5ab2MwODVkSFpDUTA5SllYcHdjM2RYUXpsaFNqbDRhblUwZEZkRVVVZzRUbFpWTmxsYVdpOVlkR1ZFVTBkVk9WbDZTbkZRYWxrNGNUTk5SSGh5ZW0xeFpYQkNRMlkxYnpodGR5OTNTalJoTWtjMmVIcFZjalpHWWpaVU9FMWpSRTh5TWxCTVVrdzJkVE5OTkZSNmN6TkJNazB4YWpaaWVXdEtXV2s0ZDFkSlVtUkJka3RNVjFwMUwyRjRRbFppZWxsdGNXMTNhMjAxZWt4VFJGYzFia2xCU21KRlRFTlJRMXAzVFVnMU5uUXlSSFp4YjJaNGN6WkNRbU5EUmtsYVZWTndlSFUyZURaMFpEQldOMU4yU2tORGIzTnBjbE50U1dGMGFpODVaRk5UVmtSUmFXSmxkRGh4THpkVlN6UjJORnBWVGpnd1lYUnVXbm94ZVdjOVBTSmRmUS5leUp1YjI1alpTSTZJa3RDT1hwd01tTlJXRlpLVUdkbWIzWkpNREp6UVRkbk1rMVFMMWh2UzFaQlpHZzRNMjA1U2podGFWRTlJaXdpZEdsdFpYTjBZVzF3VFhNaU9qRTFORGMxTmpFNE1qSXhNakVzSW1Gd2ExQmhZMnRoWjJWT1lXMWxJam9pWTI5dExtZHZiMmRzWlM1aGJtUnliMmxrTG1kdGN5SXNJbUZ3YTBScFoyVnpkRk5vWVRJMU5pSTZJa3B4UzBNNVoweGlWMHRNZFM4eU1ubElLMDl0VUdSc1RuQXljemhOVlZGa1VUWXhXVUp5ZGpoQ2QyODlJaXdpWTNSelVISnZabWxzWlUxaGRHTm9JanAwY25WbExDSmhjR3REWlhKMGFXWnBZMkYwWlVScFoyVnpkRk5vWVRJMU5pSTZXeUk0VURGelZ6QkZVRXBqYzJ4M04xVjZVbk5wV0V3Mk5IY3JUelV3UldRclVrSkpRM1JoZVRGbk1qUk5QU0pkTENKaVlYTnBZMGx1ZEdWbmNtbDBlU0k2ZEhKMVpYMC5TVEp1N0xnR29VWHQzZmtveXZMZEIyd0VHZ3VHOUc0QnpEUWxFYkQ3a0dSVWdmZDd2ZHUxUGwtbWNlUUd6cnJWUEY5eHRERXFHWnR6YkpILWN1amVVN0RCbTF4eDRzNlBIenZra0xibjg0b1ROUFJNcmhFalpER0tFUHdVZzVXb0M0UUlPSERMN2xpbUN4alhxYVl5eTh0Tk4ybW1yWlBPV3oxRVJGOG1XSG1tU0VrSWNJeVpyTDhuVS1jMkhVM2pyYkF3SDFoWFoxZU1yMG9kUTllbWM2TU8tWUFhSjZ6X2g1a29MSnhGVkxnZTh3dmp6UkE3R0hZdXlzQ3FPTXdCb3FnbVBlVzUxODBLV0VtTXdJUVljd1VXanZDbTRILUlWWUl6RElGcHdMSUFaaFQxd1NHbUoyeDBaQ3lpMlF4SmhRR0RjR1JuZjZyTlllc3FnSXpqV0FoYXV0aERhdGFYxcRs74KtG1Rkd1kdAIsIdZ7D5tLstPOUdL_qaWmSXQO3RQAAAAC5P9lh8uZGL7EiggAiR954AEEBEAglXhhzprEVlCnJSjQ0f59qby7VJKFLROYDyglb0hOGk9VmPeojeh8mwnsf3exgIBoVovCmIaGggiF3YPIV8KUBAgMmIAEhWCDbwAl__SPL0bDsj9WldwIqhh0thFFVRWt0HHm8MT5AVyJYIL1z6R8jvPutwAinX77M3ahwoNxFWPvR15vuhv1af8c6"),
      clientDataJson = """{"type":"webauthn.create","challenge":"jQsu5pUma1KIlCaAUfptSrCZv7a8Qpcxs-N52OuO5ms","origin":"https:\/\/demo.yubico.com","androidPackageName":"com.android.chrome"}""",
      rpId =
        RelyingPartyIdentity.builder().id("demo.yubico.com").name("").build(),
    )

    val BasicAttestation: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020dd22f7c6b8aefa689d6ca9febe1ef85d31a0111353b9ba0129f3b3e0eb18cd5ca5010203262001215820eaddbc0baa43b09ba0c6c55c58cf71a3a70975b91a50af7f7dbc53f2b35e6b06225820fbfbc9c953a6e9d05a5b702c59cdc1d232b8449f1bdb7b41c5319fbc6bdaea6c63666d7471616e64726f69642d7361666574796e65746761747453746d74bf6376657268313437393930323168726573706f6e736559093c65794a68624763694f694a53557a49314e694973496e67315979493657794a4e53556c4559577044513046735332644264306c435157644a5130644d5933644555566c4b5332396153576832593035425555564d516c4642643246715257314e5131464851544656525546336432525857465a705956644f646b6c475a47785a613059785a45646f64556c49566e56685746466e5a456457656d5249545764524d45563452487042546b4a6e546c5a435157394e516d78734d566c7462477069656b567054554e42523045785655564464336461555668574d474648566e566b5232787157566853646d4e70516b4a6b53464a73597a4e536147524862485a69616b564d54554672523045785655564361453144565442566430686f5930354e56476433543152424d6b3155597a424e616b46335632686a546b31555a336450564556365456526a4d45317151586458616b4a6d54564a7a64306452575552575556464552454a4b61475249556d786a4d3146315756633161324e744f584261517a5671596a497765455236515535435a303557516b467654554a736244465a62577871596e704661553144515564424d56564651336433576c4659566a426852315a315a456473616c6c59556e5a6a61554a435a45685362474d7a556d686b52327832596d704654453142613064424d565646516d684e513155775658646e5a3056705455457752304e54635564545357497a52464646516b4652565546424e456c43524864426432646e5255744262306c43515646444d47744e5a33457263555a345958467861475a765a326835576d7048516e4e58546c4e48535570485347565556457468556e6b33574534324f5664335447354f576e70334e4652704c315a5363316c51537a566b53576c4a63337077574539794d6d5a754e6b466b596c46595557704b4d585a745958706d614664774d47646162546c4e4e55706e536c5648596c524b5755686957454a7461326c6856585a4f5631644c575739614d475259626c5a364d5868706232744f65574e344d6a56444e55314b54465a5253315249596b4e6f5455566d4b314e334e585652525564465a6e4676596c52504f484243547a4135546e4a755556686c5246564a51566834537a6852626d46355a327879654664796432564d566a5a7561324e7262554a6c4c326c4955484a48646b393157444a476356517262477075636e56774b315976613170614f55393061474e7961324e3352484d79533164335954646b5132706853305275524530764d315278535546305956686d53445a354e4459354f47784562577331575374534e323132556c6455626a637863544a775632393665456c3256564e455454567451307078655573784f4664516157564d4f446c715a6e68305747564b645770425a30314351554648616b70555157704e5130564851336c7a5230465255554a6e6456566a5156464652554a4353555646515546435157644e52554a52575568445157744c51336433546b526e4f48644555566c4b5332396153576832593035425555564d516c46425247646e52554a425230744d615774785446557a4e47637962586731656d6b724d30564e65574d3555574a334d30463062457479545668786155453162444a7264466c6c5a3070515132773252487070646c7048575731575647394b536e643251336f7754314e4f62446b7a4e6e4e34646a4e344e56527a626a63774e7a684a4e456c5a5a6c644d5a33517753454934656b46544f5652684c30786e6432565a527a466154566854645774524b316b795630637662484e6c596e524762585972566a637a566b5134564738345346564c51324a734b304d79635563775647744e5155353259304a35633170736355354f59544a6e64334e794f58564e6358704664446457596b30785332524b4e3263336358684d566d4a764d33424b5a5568475446424c4d6a4654556a5a53536b4a6963336443596d4a6f4b305a4c62445631556b633562454e6e566e4e3255564e455643746954316470596d31534e577859566d525465466855623234354d7a4652576a4670526a644e4e5746456146687a64584643576d4a506179745556477032596c49336169744d5a6b4a366145744d546e4259576d4a745a6c6f3261546c305445673059554979635738345247315154466871516c5932566e46496269393350534a6466512e65794a68634778445a584a3061575a70593246305a5552705a32567a64464e6f595449314e69493657794a4d5132457759544a714c3368764c7a56744d46553453465243516b3543546b4e4d57454a725a7a63725a79745a63475670523070744e54593050534a644c434a756232356a5a534936496d4531526e704551574e354f4374454e4564345a304e74536e644f636b783264484a784d6d4e6d656d4d774f465a5262323944566b313556556b3949697769595842725547466a6132466e5a553568625755694f694a6a623230756558566961574e764c6e646c596d4631644768754c6e526c633351694c434a6959584e7059306c756447566e636d6c306553493664484a315a53776964476c745a584e305957317754584d694f6a45324e4451344e7a51774d54497a4e445573496d4677613052705a32567a64464e6f595449314e694936496b7844595442684d6d6f76654738764e5730775654684956454a43546b4a4f51307859516d746e4e79746e4b316c775a576c48536d30314e6a5139496977695933527a55484a765a6d6c735a55316864474e6f496a7030636e566c66512e434d6e4e5a472d63686b30625952704c34337069564e6630476238767467656d75316a7773526f4c5f3443644573326f58615854534e416e63316c6233506f723738387277644a7444585a626753634159414967677032653552696e3036494861746f444b666d36487845564646567a626b6973736468373777417a734d6e4d50316164486e6a36324b65365437306641654446555579344664615a4b6e6838725053464d3430795132486e5671666a664d32335379676b7544716446516d707856594574595a57514356416f533833327756773272714f2d70346f53615170775f5356586d37324b45537a467a56743969347067784951687276514c65334d30434b7037436b4d754655594d5548357a31515a57696a666c52547a354d4571416d586f6c764250547652574c5239636350426a53764a50327938704873393177634a383948306b744f453577443837414164426367ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d0301070479307702010104205d03f530a58e5be4a9c8d757155c16d69441075bc4522379bc6d4ffbe34fc51fa00a06082a8648ce3d030107a14403420004eaddbc0baa43b09ba0c6c55c58cf71a3a70975b91a50af7f7dbc53f2b35e6b06fbfbc9c953a6e9d05a5b702c59cdc1d232b8449f1bdb7b41c5319fbc6bdaea6c")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDajCCAlKgAwIBAgICGLcwDQYJKoZIhvcNAQELBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBfMRswGQYDVQQDDBJhdHRlc3QuYW5kcm9pZC5jb20xDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC0kMgq+qFxaqqhfoghyZjGBsWNSGIJGHeTTKaRy7XN69WwLnNZzw4Ti/VRsYPK5dIiIszpXOr2fn6AdbQXQjJ1vmazfhWp0gZm9M5JgJUGbTJYHbXBmkiaUvNWWKYoZ0dXnVz1xiokNycx25C5MJLVQKTHbChMEf+Sw5uQEGEfqobTO8pBO09NrnQXeDUIAXxK8QnayglrxWrweLV6nkckmBe/iHPrGvOuX2FqT+ljnrup+V/kZZ9OthcrkcwDs2KWwa7dCjaKDnDM/3TqIAtaXfH6y4698lDmk5Y+R7mvRWTn71q2pWozxIvUSDM5mCJqyK18WPieL89jfxtXeJujAgMBAAGjJTAjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8wDQYJKoZIhvcNAQELBQADggEBAGKLikqLU34g2mx5zi+3EMyc9Qbw3AtlKrMXqiA5l2ktYegJPCl6DzivZGYmVToJJwvCz0OSNl936sxv3x5Tsn7078I4IYfWLgt0HB8zAS9Ta/LgweYG1ZMXSukQ+Y2WG/lsebtFmv+V73VD8To8HUKCbl+C2qG0TkMANvcBysZlqNNa2gwsr9uMqzEt7VbM1KdJ7g7qxLVbo3pJeHFLPK21SR6RJBbswBbbh+FKl5uRG9lCgVsvQSDT+bOWibmR5lXVdSxXTon931QZ1iF7M5aDhXsuqBZbOk+TTjvbR7j+LfBzhKLNpXZbmfZ6i9tLH4aB2qo8DmPLXjBV6VqHn/w=",
          "RSA",
          "MIIEuwIBADANBgkqhkiG9w0BAQEFAASCBKUwggShAgEAAoIBAQC0kMgq+qFxaqqhfoghyZjGBsWNSGIJGHeTTKaRy7XN69WwLnNZzw4Ti/VRsYPK5dIiIszpXOr2fn6AdbQXQjJ1vmazfhWp0gZm9M5JgJUGbTJYHbXBmkiaUvNWWKYoZ0dXnVz1xiokNycx25C5MJLVQKTHbChMEf+Sw5uQEGEfqobTO8pBO09NrnQXeDUIAXxK8QnayglrxWrweLV6nkckmBe/iHPrGvOuX2FqT+ljnrup+V/kZZ9OthcrkcwDs2KWwa7dCjaKDnDM/3TqIAtaXfH6y4698lDmk5Y+R7mvRWTn71q2pWozxIvUSDM5mCJqyK18WPieL89jfxtXeJujAgMBAAECgf98Iw16ftR/JNYqMNNmZzKg8gbfGuRLXIbYvdnGYkabS4edmFG1bKRAy/fcMi5pT5cn4MT/quHelRhjOIiXdOs8B6qTvBsopTvBjIxF/CB4SppR+hr6/xbrAhxJQKj7HgXuNkGytopCW6iWnlzg9IP+GHMwpysNIVKTk+dfI+Oh4HA9SZfI93PKK1iXgrQNtDPz9PS2L1/11zxmj2HpBYzSoLTAmaEc7vr0vl6y+bJslM0UHvNk+BgGmW64e0B/hnDKA+jJqF3xX5gMnOsP6/c62AnPkvuIvOLfVaXMi1YyineJn3NsmwNjjukmgpPPxgIVMQ951i6JxnBn2B+p6QECgYEAurAFqe7rbIkAZUd4tG6cu7S/1sRgfN3gWoWFJS2gQ1zq2HWwrjN+mTG9P7k1djBpUPX64dzs2OW4MWnHWeHOBDo+UrfBqpiX6WNLrwEnBS6bFHLZo/y/n2J+MK1v0uF/pR7cykRaVE4auRgOLSlwF/kCk0Qth9EE01PQ3iXZSrkCgYEA95riAauuFggjrbSR+2pBeFvHJnqSJoZO9eKFVW9QQRjfYxllwzmzfY59SzrIa1ifRWEy0DBQysf7xr8Bwil+L1vZneMBDIY0Sylmur8GEwqVYmWZfYGazyx9XhlKnP9nsSA28dUe0BZJYyi0mfV22TLwE24jNhMMeOOh1S6p+zsCgYA10MAROHpNE0E18OBuwuQTiAs1Ee7uj9c4wPyctwZX5NUeCO8hiF6aMqhnUjCDHXl+iSoFKfZsn+v08pUw59LHjTKiDa6aStqfwKv0itSAveqefm0WxKlIfM/7oEN3+uEc7EShWgrf+pPhf3m2sxdJEdMYOLMXT72gXaz8HNUCoQKBgQDbPiuM6yV0oLRm5RK2GfnqxulqavHqZtaX5oHFipD3czyqFR0EZp1GOds7t8srMgeleVFzArUnOTj5XLwD3pW6/YuNwCl3m4XGX9x00xxf0+k+fVQRy6b2dyBzJ9XnekeokSvVqq5j9rf4s1xnTvBzliT6L3XCNc+/Y2Ay0eT1bQKBgGO382A6Da/9rOJGlAI/pp/RqzOWyYlkf6bqOTHgyORaOu+4b+sKNz0aXbmfhSHqLXhYrdHcSr2fkaIJDp7WBTsYyfu20I2x22LcQ2BMi8WBmXrRnN8UYhvtxijyBo7lZeTOQuKFDclWk0gmji6RWL7pK+x8citQevstb9xvbZIN",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDYzCCAkugAwIBAgICA5MwDQYJKoZIhvcNAQELBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAK1Ei94EwmfSUSH5AAl1TVOY8qFzZb7W0G3r3hsucQvfbW5Q5dFHfViqPbpyg5EF6WT8Pmz3fsU437Yif8On7Q5xcA3586g/Arr/I0IdVjDGwrIXomkAfMzA8gvzy4I5tnedpVMD9GtrzAcqaq83OdmCYyNE70uNHkCR8YYkuAXFvDSTGhwb8IowOAIjpgo92qIoxGfbag3aPwnnfwejj5GiVhXn6CGIpLs9xtZ02kKy34BvXMfbjQqW/eGivmJTaaD3+jC+lO9yUQy/JN7tE/RFb9XkzyWcX6FYzUkyzkoWvk7ZRgpDQhOevAtkKk/Y4kIRqdjQkWXLMAN+0gedfb8CAwEAAaMTMBEwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAQMtEeceTZrToMIR9IBkxFxlaE7HbTrp2EZmPhKeKCFnYwGCiDw69qhX8/92pldQNr70rmqgIfhdI/qwCUp4Uvj/2r5teSEBdPqcvZ0mSGI8MHZF69onbmvxNMeKqFVWbf4B3G2PSpKEZ0RVbW5yiuVB/Lt8PsYSTPCsecS2QShlsXSMqZpX2Yr1P+JQtkGVCnTsT1KNnNJ53f91rlqfnEqM4EISnqaqoay5wvWdeNkNseJPjvz9hQbvtbSBjKzrKxDLAVWseXRdAELXUGxPxS+2ZMd44bqgvRdHGJhRz9iL9VhCyCvkyUC+zV0aIVuEDrvG4kdfDa13YeuE9NcQY0Q==",
          "RSA",
          "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCtRIveBMJn0lEh+QAJdU1TmPKhc2W+1tBt694bLnEL321uUOXRR31Yqj26coORBelk/D5s937FON+2In/Dp+0OcXAN+fOoPwK6/yNCHVYwxsKyF6JpAHzMwPIL88uCObZ3naVTA/Rra8wHKmqvNznZgmMjRO9LjR5AkfGGJLgFxbw0kxocG/CKMDgCI6YKPdqiKMRn22oN2j8J538Ho4+RolYV5+ghiKS7PcbWdNpCst+Ab1zH240Klv3hor5iU2mg9/owvpTvclEMvyTe7RP0RW/V5M8lnF+hWM1JMs5KFr5O2UYKQ0ITnrwLZCpP2OJCEanY0JFlyzADftIHnX2/AgMBAAECggEABy7pUYoG+UDp5iupibrYOtgDbxgWpsPHHleB/MR/IUvhAIrQDE4Xbz6Xkow+0htZorsmZ2QXWFvUQnvJqjXjCQ9A4wNyy43ZMiFzt8D5msoStklujUXc5qw1HLO9wydbXjgl63wlfPKaIc3rYFo8xry2GXc5KHuwPmMOjU4mZu7LOLrxPaT0tUnXuhfOGMZ16w+zYQHUhWuXiFc/0A5a6MwoBUmdZP7AXTlor8LoF5HUYz3sjQGk1mG/o528WuQfNidh87ica1YUGrG4WT56cZUzDTdlwWnYBTHxtIP/tAszPUG5Ic9VjfjGZ6Gqt0lwrNnYBbiJJ3zDvswfAqMYwQKBgQDVit5Udp08XKF1R9Z2ybM4z0m9Oq/yHeJqw3VYuiy1n9Uelg6/W5SZpHdeXG6VbHDZxDm1QEpKwzmMwgFRwg0gRJjWlmRCf2Vejk1XW8Dxk9L890YBfdGsbrFQBtr+FwCtoHfB/8EFOYLkeMf5wif+c55JwIsulV+V7HYUQdZ/3wKBgQDPt7rOEjVFog7OatKVncSzlRkG69rD2zqK4ga4+g/2802QTvtMJKHZJ2Eg2is3sf1u4TWUaL0WLj8x3dQeRNWun37hu3c8HLY4zfvtdPYUnVkLF60grrUtNgyxUgL+RRdzqj0cEH63mAdEK/7+zxDnvH/rNPS+fVMVFyQVa+E+IQKBgQDGg9OOF7qyi7Z5bfAc/ANFs8ZsSOuaHFgJQm2Lr3+y1MRuK7fIAx4Q+wkRSsJu3KHIgBfZvMuT1wtgJFbPp6NGNR8UljjcbMxS691QcfbbXb4N9t44srvCHiFuMQFSpxW1U3Ehg13wOnfJZ9MYB3vgm6EyFPIOu0Rh/rICwPXkZwKBgQCCNVAagXt3bQEPEBN1ynJViG8p0YtPHwvxp4JDTi3XxeinP3tz3bq/H1pZd6mDvkV5zh8CKy3sy4y9u6qOVuQEFOM6qYMy4WSw8x6rWZgwj/oTZAIY7KuR7cHDHf/WWIU88khgYU6t09UqPNIZ9L9KJPWjAY0yI+mC3QC3lOqbQQKBgBFbstg/DDnVeCnXnd6mrwz0k7oyXsByIUNWNoXfkcb3MJn7LIe3NchfF0jXSqHJmji+pRHRqiMTkohoe27DNIZSd0zFPFuxPlP3tNE3kcjI31n7CL4VTZCHXmzQwgRTGZnpsMA0xkROVVYn75x9yoEgZmH8svtKVpjhm98AP7p7",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(attestationMaker =
          AttestationMaker.androidSafetynet(
            AttestationSigner.ca(
              alg = COSEAlgorithmIdentifier.RS256,
              certSubject = new X500Name(
                "CN=attest.android.com, O=Yubico, OU=Authenticator Attestation, C=SE"
              ),
            )
          )
        )
    }

    val WrongHostname: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020086222018c6696a6f4dfaa0154926508e68bbf94e68c929e9092ab7d6cc18ccaa5010203262001215820261d97d11aecbe36d1c2ae680454a6ee4f43a662d1d3a52f2b024c6fc824549b2258202db58db4b22bdd57693de51703f32853418abd8402b89acb534811ddc259ec4c63666d7471616e64726f69642d7361666574796e65746761747453746d74bf6376657268313437393930323168726573706f6e736559094665794a68624763694f694a53557a49314e694973496e67315979493657794a4e53556c45596e7044513046735a57644264306c435157644a513064475658644555566c4b5332396153576832593035425555564d516c4642643170365257704e5130564851544656525546336432465857465a705956644f646b6c475a47785a613059785a45646f64556c49566e56685746466e5a456457656d524954586845656b464f516d644f566b4a42623031436247777857573173616d4a3652576c4e513046485154465652554e33643170525746597759556457645752486247705a57464a3259326c43516d5249556d786a4d314a6f5a456473646d4a715255784e515774485154465652554a6f54554e564d4656335347686a546b31555a336450564545795456526a4d4531715158645861474e4f5456526e643039555258704e56474d775457704264316471516d354e553031335356465a52465a5255555245516e42615a46644b63466b794f4764574d6c5a70555668574d4746484e47646b567a56775a454e434d467059546a426a656b56515455457752304578565556445a3364485631685761574658546e5a4e55306c335355465a52465a5255557845516d78435a466853623170584e5442685630356f5a45633565556c46526a426b52315a365a4564474d4746584f58564e55584e335131465a52465a525555644664307055556c5244513046545358644555566c4b53323961535768325930354255555643516c46425247646e5256424252454e44515646765132646e52554a42546938796256566f5a475677546e6c6c4e554e75537a424765484978636d4576635670595244426154565a7953545a4b596b677a515863344c7a6c6e55487036536d4a3663484a364e57565256576869656b4a42644664705132314b516d746a516c5172633039484e544a565655397462797450626e686962453975574646684e33517259574e3062465653546e56456130783357433968535642474b7939425a32706a566c5653616d567856575673546c5a52644777314b7a523162324a35536a46525155354765444d325132786f4e464643636d6b3362574576596a6c774e6e45764e454a6a54476c4b656e466f62484243545670784c31644a64475a48627a525062574e71626a6861545664574e473434544570354e6a5a51576c4d3452555a3661484a4a4d33527157477831556b744c57464a316330464c65555676645556595955746d4d3246795456426d55466b76626c423457455a324f57524b516a52584e6a497a596b49325469746b4e44417863335a6b6431427a533270785a3070465555783253485a304d6e644c5233684454544e334b7a6855623246464e5652486430644a563255354d3370704d57787a57474655536a56595a6d644f4d6e46735230343451304633525546425955317354554e4e64306c525755784c64316c43516b4648517a565364304a4255564646525764525555464252554e4264314647516d646a53554e52623078455154425052487042546b4a6e6133466f61326c484f586377516b465263305a42515539445156464651584a6d537a467356554a6a64474d7a63314a75614664306247744861544a706546684a647a526156453833645752424d6b6f79646e4a5a646d3132533342584d4856705a6c52564f475279546e426f4f4845315655746e6457567352324a57596e4a496545525352444e735344464c5645746b59554a30626c557255576457566a4a31626e5a586245633153453152634556755354527464537334546d523062544a34566d4645633045306555684c61306c42526a4a525a5864755747525465545179596c704b523168504b305a7752325a5262335a4256456443616e5269656b786e52315235546d74796133704d527a4e6e596b5a3253455a4c574752574d4656595a3239575a564677626e493056555a50557a686e545539765244426c53486c3655444179546a524c614649784e486431626a424d4d335a68643146784c336c355a48553465485271626b70515133564a536e684d616939795658644f6345704256337042556a4978547a645a4d46704a4f57466b593064484f476c445457785a593056734d6b6c6c4e44563453564e704e4668754d6d56754f4746535a466f3463303079546d684b576c56336230566d4e334653576d30305232684f5554557962306c7255543039496c31392e65794a68634778445a584a3061575a70593246305a5552705a32567a64464e6f595449314e69493657794a4d5132457759544a714c3368764c7a56744d46553453465243516b3543546b4e4d57454a725a7a63725a79745a63475670523070744e54593050534a644c434a756232356a5a534936496e5a59546e4a4d53465572526c4932554734795332744a537a5a50525846364d575a6a52323556566d56615a314572576c5534526d56524d334d3949697769595842725547466a6132466e5a553568625755694f694a6a623230756558566961574e764c6e646c596d4631644768754c6e526c633351694c434a6959584e7059306c756447566e636d6c306553493664484a315a53776964476c745a584e305957317754584d694f6a45324e4451344e7a51774d5449304e445973496d4677613052705a32567a64464e6f595449314e694936496b7844595442684d6d6f76654738764e5730775654684956454a43546b4a4f51307859516d746e4e79746e4b316c775a576c48536d30314e6a5139496977695933527a55484a765a6d6c735a55316864474e6f496a7030636e566c66512e3079686a3746554e48595f755643314a73455a64686a56646e59492d31716d5f496b704c56773377443976744d325774736d58736b5041496f6f466c44433363484f7236386b625f6b5f774f7933325944657275366e4631307778563871565439617a2d515775357a7849727536795678744b344f51753557416a4553796e71524d4664795572706e3956776e39474652546275554c2d424a5a7a554f6e54365746564f42565a4f5a4f41375f656d4d72734f7137506e6d51415574704b703863376358676e39474f317742366b6c5174464847334a4f6b77757a2d377457694177434f4965756e3444377259734f77564b77507252427169585f66486c737974552d61385f61706c6772624851332d466a676d414f483659754c484d7536684746576f4461575a7459756c657556697a414b5a6a45505f70774d756866716c5a69553863505a772d4f5f767471416e6f7139524c51ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d030107047930770201010420f686e0434d6dc83eff5ac2f4288e79bdafeecb266ff76636e0cbff22f78790a9a00a06082a8648ce3d030107a14403420004261d97d11aecbe36d1c2ae680454a6ee4f43a662d1d3a52f2b024c6fc824549b2db58db4b22bdd57693de51703f32853418abd8402b89acb534811ddc259ec4c")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDbzCCAlegAwIBAgICGFUwDQYJKoZIhvcNAQELBQAwZzEjMCEGA1UEAwwaWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMxDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBnMSMwIQYDVQQDDBpZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0czEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN/2mUhdepNye5CnK0Fxr1ra/qZXD0ZMVrI6JbH3Aw8/9gPzzJbzprz5eQUhbzBAtWiCmJBkcBT+sOG52UUOmo+OnxblOnXQa7t+actlURNuDkLwX/aIPF+/AgjcVURjeqUelNVQtl5+4uobyJ1QANFx36Clh4QBri7ma/b9p6q/4BcLiJzqhlpBMZq/WItfGo4Omcjn8ZMWV4n8LJy66PZS8EFzhrI3tjXluRKKXRusAKyEouEXaKf3arMPfPY/nPxXFv9dJB4W623bB6N+d401svdwPsKjqgJEQLvHvt2wKGxCM3w+8ToaE5TGwGIWe93zi1lsXaTJ5XfgN2qlGN8CAwEAAaMlMCMwIQYLKwYBBAGC5RwBAQQEEgQQAAECAwQFBgcICQoLDA0ODzANBgkqhkiG9w0BAQsFAAOCAQEArfK1lUBctc3sRnhWtlkGi2ixXIw4ZTO7udA2J2vrYvmvKpW0uifTU8drNph8q5UKguelGbVbrHxDRD3lH1KTKdaBtnU+QgVV2unvWlG5HMQpEnI4mu+8Ndtm2xVaDsA4yHKkIAF2QewnXdSy42bZJGXO+FpGfQovATGBjtbzLgGTyNkrkzLG3gbFvHFKXdV0UXgoVeQpnr4UFOS8gMOoD0eHyzP02N4KhR14wun0L3vawQq/yydu8xtjnJPCuIJxLj/rUwNpJAWzAR21O7Y0ZI9adcGG8iCMlYcEl2Ie45xISi4Xn2en8aRdZ8sM2NhJZUwoEf7qRZm4GhNQ52oIkQ==",
          "RSA",
          "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDf9plIXXqTcnuQpytBca9a2v6mVw9GTFayOiWx9wMPP/YD88yW86a8+XkFIW8wQLVogpiQZHAU/rDhudlFDpqPjp8W5Tp10Gu7fmnLZVETbg5C8F/2iDxfvwII3FVEY3qlHpTVULZefuLqG8idUADRcd+gpYeEAa4u5mv2/aeqv+AXC4ic6oZaQTGav1iLXxqODpnI5/GTFleJ/Cycuuj2UvBBc4ayN7Y15bkSil0brACshKLhF2in92qzD3z2P5z8Vxb/XSQeFutt2wejfneNNbL3cD7Co6oCREC7x77dsChsQjN8PvE6GhOUxsBiFnvd84tZbF2kyeV34DdqpRjfAgMBAAECggEAR00qeqvsCMIzTZezAThQ0/ORi+J+pepK1Z4GfzR9QF8kExkMguhaJqKj4TrGO832Eyo0qQ+Y0U5OgOaaoc4m7dpBktfytyxeCAiUZOFCIRXyK2R8oK+5zN+yJaED8mxbUPM9/fWewdHSqyaiRVcBk6yVvf7E+IVSb3MDX1RdC1JHaHpZb/rxz2F/mcGznmoGmNrrteEH6dygsH5QY9nr51dWS2bX0EqAGBrAgA+F4360MrhRclOjQkHHrhPJMqkAUVKBvvUjASoLEIg77/d/Aj8QWawltZXL20olhyyCBRPbK0US6v6pMNcXNVlGhAD5pJJniqD0yViGJxwVLc9sWQKBgQDznU0wG5GrSNRp5tQN+u6qihGCfnmFRF5baa8EPpd66X2q37LjX3Wz1nfkyNXy3aC6JuT2noWuUD9X8NXvNpYCv/8jHBp4AL9OGTpmNTjnyqWmIoZv4sFgt7bic9tcTOjYgL5J6ZB/g3crq3LDmkiL5aWGdvUtP39wtiTYpSZYSQKBgQDrWYhV9h5mSzrE7T7MzIcsTpgP2gaysyObgFFE+n+5o+NLJttEQBLOaNd7XB10wEdv84wZy6acGvvbklMVXaAntohxBSgiMBb09Z60YofOQKHlJ6dYSq3JAtLnEK3J/2KCBYL9Z/BsA5/6n5Z0KSO/3cCvA96l0Y99wtPAqPX35wKBgQCRz6L1mmqz9KF+yXQ+8eSMGpukWYLuqx8246inh7cvEDXxYnc19FsEyudz/mlgNhsPkFwW6Ibm8I0ZW8MQrMFY4AYbw6RsEzZtzlfP+ScYRYikSaHhsf1AoHVMUUAInNf5TgWXQ78DM3LOpo3IWb32Tfum4eiZrpneooanTSIIUQKBgQDodXqwTXUhXNUjhaIt7ybkoIyZu6Q6Ba75/PhIxZQ67KGorSyOcSsiLXQJKKb/lpv4+/o50Gk0b4KtEg52YA+8qhKCb7GAczd5pNGpIlk5Y6WFDnHAR6L3lI50JIlDp7jI7GDBo1RZnAr8JX0aJzhkXsffFldoOWEdur4k4b5xqQKBgFGU5Ueoatl+PW09lyYvcyUY9bPg930dZ/lYNSmtPSAjSIJz2lQSqVG0v92frkaQwtAFBSwDpdGSP7jp6paHAOrQGKT2k9XN8njzklAjiPYGAnKu/ykk447bwOoz/+rS2gETL/i8vMmRVhbVVwthecor8wvLbM6x4qvKsYPeubTv",
        )
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(attestationMaker =
          AttestationMaker.androidSafetynet(
            AttestationSigner.selfsigned(COSEAlgorithmIdentifier.RS256)
          )
        )
    }

    val FalseCtsProfileMatch: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020d98f9662aab53c0fef67d23b3503f26f1e4f79ee0a17b23c4b990321e488f9b8a501020326200121582086a6e783d0e3d9766b41403ed77291d5469adb69f8a47338759f3cd0d3831531225820fea6b90121fe5b3b5eb95f3e5839d306069b3a5bac790b9257810d7a56815bca63666d7471616e64726f69642d7361666574796e65746761747453746d74bf6376657268313437393930323168726573706f6e736559093d65794a68624763694f694a53557a49314e694973496e67315979493657794a4e53556c4559577044513046735332644264306c435157644a513052796333644555566c4b5332396153576832593035425555564d516c4642643246715257314e5131464851544656525546336432525857465a705956644f646b6c475a47785a613059785a45646f64556c49566e56685746466e5a456457656d5249545764524d45563452487042546b4a6e546c5a435157394e516d78734d566c7462477069656b567054554e42523045785655564464336461555668574d474648566e566b5232787157566853646d4e70516b4a6b53464a73597a4e536147524862485a69616b564d54554672523045785655564361453144565442566430686f5930354e56476433543152424d6b3155597a424e616b46335632686a546b31555a336450564556365456526a4d45317151586458616b4a6d54564a7a64306452575552575556464552454a4b61475249556d786a4d3146315756633161324e744f584261517a5671596a497765455236515535435a303557516b467654554a736244465a62577871596e704661553144515564424d56564651336433576c4659566a426852315a315a456473616c6c59556e5a6a61554a435a45685362474d7a556d686b52327832596d704654453142613064424d565646516d684e513155775658646e5a3056705455457752304e54635564545357497a52464646516b4652565546424e456c43524864426432646e5255744262306c4351564644545842706333707563474d7656484633525731694f4868574d5642724e575a3462546b32556a5276556b466f656c6c58634746745a5864564d6d4e4e4d564a52643070725754683552445230535339464d584d784b7a4d30624642744d6c425856546879636b355161334a31546c4a52526d4e694e326f3365484a33655856765931525562334a4d566a5636636e70794e48466a536d356162566c7a614442786246526e4f455255616d467663577468646c4e4352474a505755317a6130677863304a59565774304b304a565444425063454a32535568474f466c5062324e30566d56795a30745a656a6c4f6558466f536a4e43524749784d336c324d305235516a4e695443394c546e457963566377637a6c4c5a6a42304d577879546a4a5653486f3153444a794e797432616d6477656b7448575567325747733055324a33646c4e6d4b33646855574e715345564c5a314233565552554d5842584d3278354e6c4e745757677a5a4549345a3170695155704a5755707a4e575651636d4a5a5643743361335273535735734c79396c5755784d5332393551584e6956337046615664616255396b62325246545668364d46524b54444649526d4e35566a6c4c646b7875643152425a30314351554648616b70555157704e5130564851336c7a5230465255554a6e6456566a5156464652554a4353555646515546435157644e52554a52575568445157744c51336433546b526e4f48644555566c4b5332396153576832593035425555564d516c46425247646e52554a42526c6f3563334a73556a42535630733261474677633356315956704a656e6c525a7a6448654756434d305a355930744655456c7263453033635556335a54557252315635645735494c3342314e4535366448524a5a46646b5558647a5a6a68574e45557964335a4e555456474c335a6b556e6772513059784d6a4530536c55305232704d646e467a5a585232556e7033614652535a4764734e3231715547465563586c565457354656793945516e704e596b7777596d684352566c6b4d4777335432597a625339494d3351795a476b31524756695343396e566b46315a474976544856344e45315a56584270556e424b5446646a55445a72546a41764e6d706a547a644256574a5862575651564770585a6d46696132524361586849613163325a6d567653464a7356565a4e5446704d576a5a7565565a584e57396d6247465a62456c6c576b52506553744363465a4c596b3944526b633253467074546e463353316847636a5a4d636c6c784c30743352697372597a52755a79394d567a5231627a4231576e413461464e5656316c78566b565862474a345a464e4f4f55684953484a4a53577035646b35776443396c513264524d6b315152465a32524374545957566c52544a5650534a6466512e65794a68634778445a584a3061575a70593246305a5552705a32567a64464e6f595449314e69493657794a4d5132457759544a714c3368764c7a56744d46553453465243516b3543546b4e4d57454a725a7a63725a79745a63475670523070744e54593050534a644c434a756232356a5a534936496d7042644531686454677954564e6f5930646c526c6833534777314d5338764d444e45516a5254627a68524f4764784d6e4e57633356516232383949697769595842725547466a6132466e5a553568625755694f694a6a623230756558566961574e764c6e646c596d4631644768754c6e526c633351694c434a6959584e7059306c756447566e636d6c306553493664484a315a53776964476c745a584e305957317754584d694f6a45324e4451344e7a51774d5449314e6a6773496d4677613052705a32567a64464e6f595449314e694936496b7844595442684d6d6f76654738764e5730775654684956454a43546b4a4f51307859516d746e4e79746e4b316c775a576c48536d30314e6a5139496977695933527a55484a765a6d6c735a55316864474e6f496a706d5957787a5a58302e683351754d6c736e446b744648772d456c71615969683769776e352d3753494c4448316b487841476c316d636f717259694b5a4e647152383743564248346b7a4f6877535130777777724835775671705475564e4f364233726668664e4a387562586c4f78366b4d59615556567236674768573059696d536773486f61733250774e547958614f3644663874474143354f5a4449554b43484e3054676144467a4a6346735a764f584c436475596a4b43633653326f7249324e6256694b65797859636c42566342374e4d4a43667937666551643971384e7170727832522d4242687779484d4434644664394b573363626a49436d5876487059713266327644656d65363964582d5465705647327773363179594c35454b6e647a6a7a72626464797a63374173354a443446735452657043586d7a6f324863365935354c33325f74796c617a64464c456541386133643171786b613441ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d0301070479307702010104204afdd15339dbebb41b31fe65ed61b971f8e5aeab2ef9dc1f9ffcedd54d5b8145a00a06082a8648ce3d030107a1440342000486a6e783d0e3d9766b41403ed77291d5469adb69f8a47338759f3cd0d3831531fea6b90121fe5b3b5eb95f3e5839d306069b3a5bac790b9257810d7a56815bca")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDajCCAlKgAwIBAgICDrswDQYJKoZIhvcNAQELBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBfMRswGQYDVQQDDBJhdHRlc3QuYW5kcm9pZC5jb20xDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCMpisznpc/TqwEmb8xV1Pk5fxm96R4oRAhzYWpamewU2cM1RQwJkY8yD4tI/E1s1+34lPm2PWU8rrNPkruNRQFcb7j7xrwyuocTTorLV5zrzr4qcJnZmYsh0qlTg8DTjaoqkavSBDbOYMskH1sBXUkt+BUL0OpBvIHF8YOoctVergKYz9NyqhJ3BDb13yv3DyB3bL/KNq2qW0s9Kf0t1lrN2UHz5H2r7+vjgpzKGYH6Xk4SbwvSf+waQcjHEKgPwUDT1pW3ly6SmYh3dB8gZbAJIYJs5ePrbYT+wktlInl//eYLLKoyAsbWzEiWZmOdodEMXz0TJL1HFcyV9KvLnwTAgMBAAGjJTAjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8wDQYJKoZIhvcNAQELBQADggEBAFZ9srlR0RWK6hapsuuaZIzyQg7GxeB3FycKEPIkpM7qEwe5+GUyunH/pu4NzttIdWdQwsf8V4E2wvMQ5F/vdRx+CF1214JU4GjLvqsetvRzwhTRdgl7mjPaTqyUMnEW/DBzMbL0bhBEYd0l7Of3m/H3t2di5DebH/gVAudb/Lux4MYUpiRpJLWcP6kN0/6jcO7AUbWmePTjWfabkdBixHkW6feoHRlUVMLZLZ6nyVW5oflaYlIeZDOy+BpVKbOCFG6HZmNqwKXFr6LrYq/KwF++c4ng/LW4uo0uZp8hSUWYqVEWlbxdSN9HHHrIIjyvNpt/eCgQ2MPDVvD+SaeeE2U=",
          "RSA",
          "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCMpisznpc/TqwEmb8xV1Pk5fxm96R4oRAhzYWpamewU2cM1RQwJkY8yD4tI/E1s1+34lPm2PWU8rrNPkruNRQFcb7j7xrwyuocTTorLV5zrzr4qcJnZmYsh0qlTg8DTjaoqkavSBDbOYMskH1sBXUkt+BUL0OpBvIHF8YOoctVergKYz9NyqhJ3BDb13yv3DyB3bL/KNq2qW0s9Kf0t1lrN2UHz5H2r7+vjgpzKGYH6Xk4SbwvSf+waQcjHEKgPwUDT1pW3ly6SmYh3dB8gZbAJIYJs5ePrbYT+wktlInl//eYLLKoyAsbWzEiWZmOdodEMXz0TJL1HFcyV9KvLnwTAgMBAAECggEAG9ETc0KW1DD5iXFk5FvKnlc0C6NHtonYOG8+06pVNoTQOTP9KaawNn49+cyFfKLst9/9ywa2z04QTt5WkHUT8B22bLsR33SqR42ohviSmRubdKmSZsPUSlM5mqbtBjDWU5ZVo34Dw2/E9y/edlo/+FKbfdrZLVlPzcJQa/1oyw9Ovo7xgwSXJX9dyNvNeHUso8Hx5uWYpyqZFmJOygXhkxZWYhBDASkSGg1cIAQPMS4r+N9HeeEsvb3HB6wLiqbp3U//RK/XIT6/UDL0iBX9isbKorO9jY24/gDiP0BDwsdavsy8Ji3A/ShUPZECNNfvjEv5OzB+BmdXS67shR8VFQKBgQC/NSE4py51kmWBs8wZ+cvNJNLm/TgJl1hwx4Qrf43RlPyrzgw48pQclJOVezfb94JbYieFWWHP87kM03RgtEuINsGQ4/Mu8SdeWbmim+UA1SJKwNKArvTL5gFedb2fVwYdBG15uRAJyhFy609Liu9iYMx3pe4WGFjNKd6n7kGjpwKBgQC8TzIV8E7o9J8IbAFYfrChv8PPM1FWiy4uFGnvcz43t+TWd/mpPEcafJZqZPhi2p/CQtE9KZ4l8TvqrezE4lVXrs1QUs/EsyqfmO598kIxjI3F0SHyKkdbTD7tj+Inep7Z/c8kfvutjl76Jp9WwaV0LuG6CuBONoirAa9AJJDhtQKBgQCrh1YOJKwg/PvipxDqHJUfq3EnlvG2aPcF9XY0L3FiGm2xEl8Ul0kXepIK/0bVJezjXeJmVhDRJKtVPjygpB0+TSDIgjWeXugaVBOcNI3zeUASH3i3yDwCzotb2fQKBV+OmHI9SC+DGKselMnF0xV9A6lpjIlRePXw1ybPL4Xi8QKBgALzbsJ/QI1QAAn+v0qmuZffTG87y6OCjNe2BC73bFstK43c1XG8exTELQs/x9CswmIl7+d4dnz7uceksBgpv9Ke76K5mX3onNthZyNcH4NtQ299Jn4IAZRBrp7EaXPa7RBXdN6KiuEeYQikgEy4viIC9hCXSQqQujWL0jY8HHUdAoGAOV0Ow6H9UORj0qWHwyTrpY8IPd4+Rsfj7Iqis/5rgGGB4sI0WqjkUs71mktE+TVFmKdxj3DnV4a5SFzP83Ti3dHZqT0Kea9phS5w6WB5SYry3tDB1vyTSHfIEPxmuEOO+vzQ/Jivg09kFhjFCU8buuapJQuMTOKa1gxjjffTkKg=",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDYzCCAkugAwIBAgICCNIwDQYJKoZIhvcNAQELBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMnR1N4c24tVbnocI95FlWBK80id6PPBxF9XKWCB1n8KSOAC/Bb6dhl591Pd/UrmUzwMwIO+VKMybrZ1WJM24ZRog2nrBggONi7zbr9AWE5kqaPBtrnWSrdHsc7R81x3XGmFWZDL2agVShgwDhj6UQGUObSp6poHQV/3iU58O9TOzOBsNwJ5IBxhqA+WWzDsE0LrVtjzzuS8DebFOsuH3ENpQQ+ht4JKrv3SMDAYcuJ8K4xmy0DcNycMZhEe2OxmCTrSLcCar5PcgzHrqRuEmtrjo2PNsZAyhomZXDSlWzdrbW50ntK56n9jMy6PmVQqtUEbS/9HHzhwNjgrU/fTTYsCAwEAAaMTMBEwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAeHXrscbkfGTIW4oBFJBh5nOI9JjjUzqCtrbvrloWGIDL6uPLVft0D4wTxQGJofuyOCEmcmMWgCbTtW4ic/Xy2F5ikAAF+74hCvrrzKjnEySxRg/AhK55WKssAEReUuwzzEEH8tnHcZVLlmO+roOAl4zdsbuiSKjoOald7BGdF7uTIDbFWh2hNf4Ser86xzICNdiUGxfvUq277tv44hDp34K0uAK6tTJ4ZPgp8E8KBEpWJKmKxZMu4sLyrCQpR+8+LfLDp6lBcTANkxFEc6qmiLtzWB3GwzZNaGKEfyk0iJR46Fd6qjFHqcwq7SGWAio+upJ5HjMdYb2n9SBqNS0nzg==",
          "RSA",
          "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDJ0dTeHNuLVW56HCPeRZVgSvNInejzwcRfVylggdZ/CkjgAvwW+nYZefdT3f1K5lM8DMCDvlSjMm62dViTNuGUaINp6wYIDjYu826/QFhOZKmjwba51kq3R7HO0fNcd1xphVmQy9moFUoYMA4Y+lEBlDm0qeqaB0Ff94lOfDvUzszgbDcCeSAcYagPllsw7BNC61bY887kvA3mxTrLh9xDaUEPobeCSq790jAwGHLifCuMZstA3DcnDGYRHtjsZgk60i3Amq+T3IMx66kbhJra46NjzbGQMoaJmVw0pVs3a21udJ7Suep/YzMuj5lUKrVBG0v/Rx84cDY4K1P3002LAgMBAAECggEAMN15aP4bujTJNw+xL5Qxgssi9KYnTT3RSjRUdGV7he77jiGq3/VsuuZpGAlb1tLFvHhp9HwVCh6f59WpyJs1KzXS+8ZIA5NNUzjly7DMsM52tIumroBQPuhBCQ6UmgLcgUAkW4bAAI6HDiw0fZ++FV/KSRALGZhAH/hTaolyAyhQs6KBDJmNSNZZIRUF6UDxt0jC+HOVk8ksaXvHVWF13189cjgVFIE5qwHbDvqzotb7d1I12hMuQPDvliqOG+Qk83a2Lv/yY1XJyGldrR4bt3GgGD5ohhxoN1xAp4fsqpPVHq1J2jK+0cXz3xhgmmZlWomZFQ+zaQMMbaTJ7P4oYQKBgQDPg3amcRbDNs+1vWmJqoWi3Qi8PQ839b1hHP/GDM3ROAWmTtG+1VUpwMLPmiGhKLQJ8IHZPXtm0NXa287IIwcwp0JjonXwNhXcJzhrBsyx0URyjX1ZV43TRXv86NXKVwUmiEsBA64iCsmbp6G+LGME0TsWCp1+H+nEoIu4PB1sZwKBgQD4+cknyCFZLgvAgty///9lvxfvlBuaXSv5N1gf/stqFld1jxkIioau7DVrBs2KdQM0rGM3YYOn8AG/bfAJdHla8CvNYZwssh3yYVD9krBpPQhSTKA5LDz1i2pb8aZTmE8M2A4/BNs8/hslez6nzq1Mp6YSvh6/eqOnVisBV9AfPQKBgEYhswbbb4r4SkisxC9PnyyEsUAVDsCl36QjjdncV+7elSI4vzBUnxymVfCdscHqpLY7P1cxLTR5Xd1Crmb7V6G81XYg4OUXElo+MxYQzTtHc2+XnAaGzZraf+XgtuhUcpwsMdUc7kv5A1wE0mgYTjrBj8uKOOH4XSQj8jSItJT/AoGBAJbUC25UKQ+ze18WZ9DQrtHeoAt9N/OdugPx6SsI2gXcnwMSu2GXOdxCMGIz7tSP6m9Ad6KXKoDUPtrPKPkxXEsg8Agtt8TD6qxpE/1pngFC/gWNcgrwp8VAviARFmfR/yGSyZ6XvJEIhz1/mgdih03Gyi7UiiAJlZbL9qWLowMpAoGADSJaHEF7RO9qylmQob1n3w6N6ao7nJd/7bDkJdwxJa8N0Oiv1eRkWevealnPKWF45RRUZcEtI5N1BsRa8C6ecplDmlZNfWAj+OnPn2pdev82yQ9wfc2SDiXaOe3jNuXZGS+PYaXzne4JUPXGJn3q6A06LsCEzqq50LkZFTWCb8w=",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(attestationMaker =
          AttestationMaker.androidSafetynet(
            AttestationSigner.ca(
              alg = COSEAlgorithmIdentifier.RS256,
              certSubject = new X500Name(
                "CN=attest.android.com, O=Yubico, OU=Authenticator Attestation, C=SE"
              ),
            ),
            ctsProfileMatch = false,
          )
        )
    }
  }
  object FidoU2f {

    val BasicAttestation: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f00206c6bce2ee5169934d2d590abb976db458c0dcfcd9d82360fbc93c268668b56a6a5010203262001215820171d8294528e18ebcec47f0426f5aa9dcb4c8b7ab7d38609baf333c41c4d2c852258209d653007939949f6daee042081d6434a50d7eb8a4fafd142cc8189435b6a9f1563666d74686669646f2d7532666761747453746d74bf63783563815901ea308201e63082018ca0030201020202269d300a06082a8648ce3d040302306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453059301306072a8648ce3d020106082a8648ce3d03010703420004ea588dd17cbc7f702116e53a1caf6f40b51b30c89536bdcbe8ce70cd3c78dc61198ebeff86c5f012d57921c39f9b80342109c7a30c63bd341b15ad32076853bca32530233021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f300a06082a8648ce3d040302034800304502210091d462574131dd530219334938561c4a752c0177c7ff9e85af455248aca2debc02204ea8005deafd97acab96f509751f45ff12b57640162880dc6f7fa18ae44883d863736967584730450220362d1f5e267509d28401a6e9762c3d6ef22116c7f8e267cab9c5eb2ddb78673f022100bf8fc4e079570315669cf7580ea18ecc7bc15cd66125073c1d68f8ca220dc238ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d0301070479307702010104209c979b0f5035b44f2ac7ed29d4d20cc127895fbba82b69b0311dea9b2e57e8dea00a06082a8648ce3d030107a14403420004171d8294528e18ebcec47f0426f5aa9dcb4c8b7ab7d38609baf333c41c4d2c859d653007939949f6daee042081d6434a50d7eb8a4fafd142cc8189435b6a9f15")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIB5jCCAYygAwIBAgICJp0wCgYIKoZIzj0EAwIwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBnMSMwIQYDVQQDDBpZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0czEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABOpYjdF8vH9wIRblOhyvb0C1GzDIlTa9y+jOcM08eNxhGY6+/4bF8BLVeSHDn5uANCEJx6MMY700GxWtMgdoU7yjJTAjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8wCgYIKoZIzj0EAwIDSAAwRQIhAJHUYldBMd1TAhkzSThWHEp1LAF3x/+eha9FUkisot68AiBOqABd6v2XrKuW9Ql1H0X/ErV2QBYogNxvf6GK5EiD2A==",
          "EC",
          "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgfMvSYwJCO1Mu7owbFmLYt9lQ2H8zqFoD4+kqeiybvnmgCgYIKoZIzj0DAQehRANCAATqWI3RfLx/cCEW5Tocr29AtRswyJU2vcvoznDNPHjcYRmOvv+GxfAS1Xkhw5+bgDQhCcejDGO9NBsVrTIHaFO8",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIB1zCCAX2gAwIBAgICJTwwCgYIKoZIzj0EAwIwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABB+mZAZb/g/+MPZiqGJw3BJ05x6Ku/Hqs3Po6dOVkUhcVUTMviUrKWcLY2m6/fAuEKNmrMc1nIs7HMryxYQK4C+jEzARMA8GA1UdEwEB/wQFMAMBAf8wCgYIKoZIzj0EAwIDSAAwRQIhAPfhXdfTbgSsg9qNz/s1pPUZumWW7rgG790HGsL5o2H9AiAJiLmlnBZNR1hS1dNYXBOJorEWXUq3rMF0EjCh7sD8aw==",
          "EC",
          "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQg712jkzFvwyWNpRxBkG/bao9vp2rHkHnYJl7V4Sz1SV2gCgYIKoZIzj0DAQehRANCAAQfpmQGW/4P/jD2YqhicNwSdOceirvx6rNz6OnTlZFIXFVEzL4lKylnC2Npuv3wLhCjZqzHNZyLOxzK8sWECuAv",
        ),
      ),
      transports = Set(AuthenticatorTransport.USB),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(attestationMaker =
          AttestationMaker.fidoU2f(
            AttestationSigner.ca(COSEAlgorithmIdentifier.ES256)
          )
        )
    }

    val SelfAttestation: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f00205267098911e4511a52dfc89555f2f75d0ca770ed4069838e73e6053455c4335fa50102032620012158206d5e477a82ff2d85ff9ee7cd9b42cd5af679808b07fa16e3d66bdc5630a6841b2258201319661e863ff2bb0e8f681898263213bdcdec15df31919cfa3f981114e3b61863666d74686669646f2d7532666761747453746d74bf63783563815901e7308201e330820189a0030201020202183c300a06082a8648ce3d04030230673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453059301306072a8648ce3d020106082a8648ce3d030107034200046d5e477a82ff2d85ff9ee7cd9b42cd5af679808b07fa16e3d66bdc5630a6841b1319661e863ff2bb0e8f681898263213bdcdec15df31919cfa3f981114e3b618a32530233021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f300a06082a8648ce3d0403020348003045022100d6ec5292f53196d8ab6cb49dac3ef2df71d68fb4e9ab5c5be22633ea813504250220349be966dd47802e31128fc930c09917d84d84b2a6580122880293be1460ed556373696758473045022100f09eda7e673451cb8401b5694b56cbda454473253fb3aba7092fae11d64d409002203fd12750831ba78384a308a4692841fc3e21c0d702d0196ba9ee0e98bcb4da59ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d0301070479307702010104205e7c760543570afd43acd64e7d44ee1dfc3d0eec2f5909c8da58450d36dccb39a00a06082a8648ce3d030107a144034200046d5e477a82ff2d85ff9ee7cd9b42cd5af679808b07fa16e3d66bdc5630a6841b1319661e863ff2bb0e8f681898263213bdcdec15df31919cfa3f981114e3b618")
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createSelfAttestedCredential(
          AttestationMaker.fidoU2f(_)
        )
    }
  }
  object NoneAttestation {
    val Default = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f00205136465ab035f7cc9fb6cd6baa2588f25b6753f1bbffe0aea9453a854fcbe642a5010203262001215820a65616f668c6ba0eb0d819c3a0a9e61d44e5747f17ae7adfe31c290ff3b1c210225820b5d549b3164fd00756d8260a534f54e1d2bce7dd4b46df9b05231d8dd19f5b7f63666d74646e6f6e656761747453746d74bfffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d030107047930770201010420228ec10ee79fc66580c844317a9404b3fb4badb7c46d5f00402a51b334b427f3a00a06082a8648ce3d030107a14403420004a65616f668c6ba0eb0d819c3a0a9e61d44e5747f17ae7adfe31c290ff3b1c210b5d549b3164fd00756d8260a534f54e1d2bce7dd4b46df9b05231d8dd19f5b7f")
      ),
    ) {
      override def regenerate() = TestAuthenticator.createUnattestedCredential()
    }
  }
  object Packed {

    val BasicAttestation: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020086125e8b2570b01906cbbaa4e1fcd8e4847bb3ea362c4fe535af9f9e558279ea5010203262001215820ea1812b7dfd3593d9e211cad6bba5a26e10d2cdcf06daf19814c5398238996c12258206cb3b9405fd278ffeee82dff4f1d62780a94f232037530f5b2d94f279477295463666d74667061636b65646761747453746d74bf63616c67266373696758473045022071fd0b77039d2676e286270f63f95d3bb2a0c336faa8e4d4b0805c540e36520a022100c23284f7cbcb83f38e49c7b6ddcc4c251a5f0238055abab55fbed4c636b877d763783563815901e9308201e53082018ca0030201020202102c300a06082a8648ce3d040302306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453059301306072a8648ce3d020106082a8648ce3d03010703420004d87f24d800b1ed2d51e8b43b1655511036c8ec79c62a4e2ea47fac0825f0887a625bb0bc80ca0d81fc1710cf8d40cc8551ae3d8d7afd81ffa8889cab2b2bdefca32530233021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f300a06082a8648ce3d040302034700304402206daf4349fdb2e84c3a7c797e1bb96a4bcc84a465ca4af3ca5db2d38e638a241b02204aed881c7ba4921f705253fde0c093629d7f5593b6b026a2f3e894454806094dffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d030107047930770201010420894eba4a6df7a4f2093443cdf65c8cca3dd38a79c6763a0105aa5690c69d7b61a00a06082a8648ce3d030107a14403420004ea1812b7dfd3593d9e211cad6bba5a26e10d2cdcf06daf19814c5398238996c16cb3b9405fd278ffeee82dff4f1d62780a94f232037530f5b2d94f2794772954")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIB5TCCAYygAwIBAgICECwwCgYIKoZIzj0EAwIwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBnMSMwIQYDVQQDDBpZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0czEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABNh/JNgAse0tUei0OxZVURA2yOx5xipOLqR/rAgl8Ih6YluwvIDKDYH8FxDPjUDMhVGuPY16/YH/qIicqysr3vyjJTAjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8wCgYIKoZIzj0EAwIDRwAwRAIgba9DSf2y6Ew6fHl+G7lqS8yEpGXKSvPKXbLTjmOKJBsCIErtiBx7pJIfcFJT/eDAk2Kdf1WTtrAmovPolEVIBglN",
          "EC",
          "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgZRMJiDvUaoZYLRgOuFTJb3jzU6OOH+kT5RyZyFF5wLmgCgYIKoZIzj0DAQehRANCAATYfyTYALHtLVHotDsWVVEQNsjsecYqTi6kf6wIJfCIemJbsLyAyg2B/BcQz41AzIVRrj2Nev2B/6iInKsrK978",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIB2DCCAX2gAwIBAgICAaswCgYIKoZIzj0EAwIwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABLtJrr5PYSc4KhmUcwBzgZgNadDnCs/ow2oh2jiKYUqq1A6hFcFf1NPfXLQjP2I4fBI36T6/QR2iY9mbqyP5iVejEzARMA8GA1UdEwEB/wQFMAMBAf8wCgYIKoZIzj0EAwIDSQAwRgIhANWaM2Tf2HPKc+ibCr8G4cxpQVr9Gib47a0CpqagCSCwAiEA3oKlX/ID94FKzgHvD2gyCKQU6RltAOMShVwoljj/5+E=",
          "EC",
          "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgGEdS0qEf53TitZg2XniD2RIbYeNgAc3QOL3msfAb6PagCgYIKoZIzj0DAQehRANCAAS7Sa6+T2EnOCoZlHMAc4GYDWnQ5wrP6MNqIdo4imFKqtQOoRXBX9TT31y0Iz9iOHwSN+k+v0EdomPZm6sj+YlX",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(attestationMaker =
          AttestationMaker.packed(
            AttestationSigner.ca(COSEAlgorithmIdentifier.ES256)
          )
        )
    }

    val BasicAttestationEdDsa: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.EdDSA,
      attestationObject =
        ByteArray.fromHex("bf686175746844617461588149960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f00206854a9bf7bf33e8820d2df695429e4d108ef68a8dad621b577139834ca8e14b9a401010327200621582083bf9038ed9a530d13b9d6ad40afcefbb637f10189c52496a2f3fa7f8217991663666d74667061636b65646761747453746d74bf63616c6726637369675848304602210096cea94d347ec08a1a0eb225290c83b377a39ec5e1584c4bb7743c8f65f639a3022100bfd1b29d8d7b7837cb0935aadd40fc62d936282229a7b051fc33f68e1754ee3763783563815901e7308201e330820189a0030201020202186d300a06082a8648ce3d04030230673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453059301306072a8648ce3d020106082a8648ce3d03010703420004c8921a7512d4d0c4f9b5bedcc7153cc4bfc44ea215daf98e96c237d18c830e2ee3ecf85e4fcad1cd17d6fc08d2325d3fa56a06a819b721473c568cc109c4d358a32530233021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f300a06082a8648ce3d0403020348003045022100b178e0f6f2e3412d938548fcb966abd24a6b4191f2f669696210e817ee1a309c02204090ef8e279ae7f1a8e30fcace260e08ac3ad7712ada8a18355a9361ceed316effff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("3051020101300506032b657004220420f3c025221210a3cd666ab9369a56b859fd8d2d0c5a160f20f0a0afb7d2b2756c81210083bf9038ed9a530d13b9d6ad40afcefbb637f10189c52496a2f3fa7f82179916")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIB4zCCAYmgAwIBAgICGG0wCgYIKoZIzj0EAwIwZzEjMCEGA1UEAwwaWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMxDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBnMSMwIQYDVQQDDBpZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0czEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMiSGnUS1NDE+bW+3McVPMS/xE6iFdr5jpbCN9GMgw4u4+z4Xk/K0c0X1vwI0jJdP6VqBqgZtyFHPFaMwQnE01ijJTAjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8wCgYIKoZIzj0EAwIDSAAwRQIhALF44Pby40Etk4VI/Llmq9JKa0GR8vZpaWIQ6BfuGjCcAiBAkO+OJ5rn8ajjD8rOJg4IrDrXcSraihg1WpNhzu0xbg==",
          "EC",
          "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgxYFd/4ffTDkyuzLYMWhJpqsR+hwUkkiROFT8Q++TQ5ugCgYIKoZIzj0DAQehRANCAATIkhp1EtTQxPm1vtzHFTzEv8ROohXa+Y6WwjfRjIMOLuPs+F5PytHNF9b8CNIyXT+lagaoGbchRzxWjMEJxNNY",
        )
      ),
      assertion = Some(
        AssertionTestData(
          request = JacksonCodecs
            .json()
            .readValue(
              """{"publicKeyCredentialRequestOptions":{"challenge":"N3LjI2J5ylyWe3ED5OT4XHLRqHwm_J48_D_hoJOFf30","userVerification":"preferred","extensions":{}},"username":"test@test.org"}""",
              classOf[AssertionRequest],
            ),
          response =
            PublicKeyCredential.parseAssertionResponseJson("""{"id":"aFSpv3vzPogg0t9pVCnk0QjvaKja1iG1dxOYNMqOFLk","response":{"authenticatorData":"SZYN5YgOjGh0NBcPZHZgW4_krrmihjLHmVzzuoMdl2MBAAAFOQ","clientDataJSON":"eyJjaGFsbGVuZ2UiOiJOM0xqSTJKNXlseVdlM0VENU9UNFhITFJxSHdtX0o0OF9EX2hvSk9GZjMwIiwib3JpZ2luIjoiaHR0cHM6Ly9sb2NhbGhvc3QiLCJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwidG9rZW5CaW5kaW5nIjp7InN0YXR1cyI6InN1cHBvcnRlZCJ9fQ","signature":"LySrkl9s9vF6F9tssQLrsXX2QVV87ZQQn8ZEwROt2tdmbkUprrEM08hkNX7Qmj70M8wYhSosy3jjyThrHn2fDg"},"clientExtensionResults":{},"type":"public-key"}"""),
        )
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.EdDSA,
          attestationMaker = AttestationMaker.packed(
            AttestationSigner.selfsigned(COSEAlgorithmIdentifier.ES256)
          ),
        )
    }

    val BasicAttestationRsa: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.RS256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746159016849960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f00209b5d5b5702b6f70cf40c612063a9e327a427d5d1f6b7635e4d8fa9077e927249a40103033901002059010100a2e03644c82525d79a6467b1d5ebcdfcc23bf254a9746522075ee8b814e2603100edcf7828e8051f39d546a5d0ab2eef8d946785fa1c120fac3e22d6804de7d979b6d456a6be39ead335117218efc5ed2522db7bae615195c49da0fadc79c116e9717af465cf9af580d410a34ae07f9ac7828687fde92dcdeb557bdfe2778e8987a66e1026feb0bae5f2171e27d8635d9b54fda7030f920230264b0104345b18677385e60decd9e01f74d3ae477502029dfdc002ad8d0d24e68fd24c92870429adf7ace121855d336ed0db6b461e0cbdba8be257eabb0351130f948c7b5dde021bdc7cd960717fa5d46ff83c3e0a8d9c7ead172a6b1ccfeb6df170f437ee8745214301000163666d74667061636b65646761747453746d74bf63616c67390100637369675901009b93e7392c66341a64eb977791c1dc7d39f6d41c3b07fbc02f5d641f64e0b0ffe748f86eefd49f5695e07a3aefacf189e8adea0bdf178943203d44467028968fc85f5852926060d588366bd58df2b316e92c4a484f9a144fc2710a68da762050bda97496ce953590efca145c561d7ee264cdd8070e22be94b9c3be5a492b738085be311e9f56c90b5ddf844560e309f811e254f819c7da999ef922ab3ead4a883ef474374a77b100f258df5676f34b6ae253986a80939fdd6d4d2dc541830dfb416d4bde82a199cb90f8d5149a19cb5599366d9fd762ac41d0268cf59cf120eb6d2a4b56e250182e6904f4ef33f3ef662f58fc3a222eff7e978004eaa496ebac63783563815903733082036f30820257a003020102020224d6300d06092a864886f70d01010b050030673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b300906035504061302534530820122300d06092a864886f70d01010105000382010f003082010a0282010100e251e8399aa9b7c35f33f2f64de878dd3aaf67d33e731735166d207d3b0c4b5393244ec867c5b6ecf97bae6cb89926e027f12efe46c9ac02a2e1a0711f404c62895338ea1d4e44e70339522fa42f8a2603d53891d2ff3b80b684dae295c29fa1641d5b57860fbd414fdf9957588e8c7b3c6442d4702e90fc3e0950e8e8fc8bd1814f11bbc7135f320f8cacef0a3399d3a6d268123cd59e59ca9bbdec9b1ae2171d64b8938f5b9a1cfc4b7a3cd7d3975a87d64fc743981419cb57b7c7526840caac380c7d1cc2d3d24456c175508d415e37666abdb1b3371a0ae714ddd52017218e492231698a1ca99c072c5e304a3f110b1bc0ad940dd7f333d862b7527cf0590203010001a32530233021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f300d06092a864886f70d01010b050003820101000463b142ba46c9c0900ab2742aeb91497ff62d6a583b84d66f280847b90062ba32060df8bdd8d551cdd011d557707f0dd2f5c3ee3f60d16d4d78c0550f93261deaecc640c2b4b4933765897934d2bb2cab98544cdf679ad21d10a4b291f06e71a46bfebf800086abcea59a8fc6efeb861d6e62fcb46285673451b5c93b5172e07e0bd1115b11a989c4a935053c345f8e43c500b15defbe00cfc8ba0f4e4dccc71463cc681a7ff00df2e331be04ae2090eb8fe9e34c4b123eb49d942c6f5a6c34b4393ed89a6eb0d83c69c4459d867a0e02e2d4725fd88a8731508642cff2f829dc2dfb988229b34ec7c7c111e5984dfb05ef7ea2ef2e25284b53f0c7a1c41475ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308204bc020100300d06092a864886f70d0101010500048204a6308204a20201000282010100a2e03644c82525d79a6467b1d5ebcdfcc23bf254a9746522075ee8b814e2603100edcf7828e8051f39d546a5d0ab2eef8d946785fa1c120fac3e22d6804de7d979b6d456a6be39ead335117218efc5ed2522db7bae615195c49da0fadc79c116e9717af465cf9af580d410a34ae07f9ac7828687fde92dcdeb557bdfe2778e8987a66e1026feb0bae5f2171e27d8635d9b54fda7030f920230264b0104345b18677385e60decd9e01f74d3ae477502029dfdc002ad8d0d24e68fd24c92870429adf7ace121855d336ed0db6b461e0cbdba8be257eabb0351130f948c7b5dde021bdc7cd960717fa5d46ff83c3e0a8d9c7ead172a6b1ccfeb6df170f437ee874502030100010282010005bb21edb5a528f9b723054b0a9deb7793560ca6d1f7987f640700e54946d5dfa38aba9c1dc45c39c70d2c19358870745964f9678b6f656b4bc23bf3943c29864b7415709f195e6c56d62d30f893a7413ae74915c703019de5772e6ce5491b7434ee9b46f23625dbb196c4a71a415ffc103d1582bf7a6ef429edae18289dd054141e94d5640cc2a92d28e4338300db089101e780ad8ee900005b0d7647c281af0035c99d74ce8f92ee6015e4b82dbd88ca3f3117294d1553c8ebfc47fe0654fabd67473a40c2185f29392f2d2fdfefae1e6cc126b5b0139d61e97cd08eed9d14791c3798043c80db94e908a0615d8a3a48f93c89f0f2d728833bc4f80636968102818100c06493326a52f78e63704a6a9263ebbcc9906ee1c09bef7890fdc0c39f00d07a0dfd2947324e19ec5b0854ba6e7ccbbd08bd5bdfe8b301308168d6113dcd720056987620ace63b0d58f856330820cb645b95116bf6f9277fdbbf5a65ed25b2b4a2e21fa9b9a1fceae34932fde85a177dd29951033f36896cc2eefa9bbf03b31102818100d8b96c4c6e7fe795c58d6a850bc181e7dd42d5fa34f420c56b4ef8a99c2d62ee11e19f175f80f4a12d8d8c682ed80cb1837dbeaf45285a74ec2bf559efe333753b9dc1927f3d89799d05fdf6679b2aeb02b995415723a10a1baf65a9cdb365054ab81efdef941b7a22988041e35a5bf09426b35f2e0874bfaddd5c641bd1a8f50281806baf5f9c565abde95acb1d3bed58343864f18cbe9b1a2cbd651a42ecbb70af3fc1d8b364004a2ac45a679d550446a19adaeb72232f9211d65e789968e918b6f86d7fc48ea177f411927cdd728ed81c3fbdeaffe7584338d29de2caec460255b6397d2b8fca315ae8f5f2a0b1f17d8bac8755fd3c3e037e83fbcfdb419576b2a1028180178fc923621c0bbc6fb6d92ecfc160f3294dfbdf70e45dafb8e3e40ae48cd6a59552172ebe5651c238269c6e33318fe7b8a8f213320c9a10fe2025537ace13a91a2b23815ecdfce538da0eeb3c06559b2937adef659edd023152575627a3ea46b201e474ad184808763c682d419f70416e89ea945d77d3e186f07afbf33e4f050281803c118e1f9314462087ae90a3ebaa238990e9ad0eb22ed83c7618e7929c234e0d75913ebf903e27ba0c2e340e2a2e847f1aaffb9efc6919eb7044df946d9d6dc835cad23b3b2d8e4dd49e10cfac52c773b362732086a40444c3acfe23a5b9101895cc2dc53e1ebe914a4f308ad12dd1211d0c091b3b91250f191866af8f90de8a")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDbzCCAlegAwIBAgICJNYwDQYJKoZIhvcNAQELBQAwZzEjMCEGA1UEAwwaWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMxDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBnMSMwIQYDVQQDDBpZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0czEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOJR6DmaqbfDXzPy9k3oeN06r2fTPnMXNRZtIH07DEtTkyROyGfFtuz5e65suJkm4CfxLv5GyawCouGgcR9ATGKJUzjqHU5E5wM5Ui+kL4omA9U4kdL/O4C2hNrilcKfoWQdW1eGD71BT9+ZV1iOjHs8ZELUcC6Q/D4JUOjo/IvRgU8Ru8cTXzIPjKzvCjOZ06bSaBI81Z5Zypu97Jsa4hcdZLiTj1uaHPxLejzX05dah9ZPx0OYFBnLV7fHUmhAyqw4DH0cwtPSRFbBdVCNQV43Zmq9sbM3GgrnFN3VIBchjkkiMWmKHKmcByxeMEo/EQsbwK2UDdfzM9hit1J88FkCAwEAAaMlMCMwIQYLKwYBBAGC5RwBAQQEEgQQAAECAwQFBgcICQoLDA0ODzANBgkqhkiG9w0BAQsFAAOCAQEABGOxQrpGycCQCrJ0KuuRSX/2LWpYO4TWbygIR7kAYroyBg34vdjVUc3QEdVXcH8N0vXD7j9g0W1NeMBVD5MmHersxkDCtLSTN2WJeTTSuyyrmFRM32ea0h0QpLKR8G5xpGv+v4AAhqvOpZqPxu/rhh1uYvy0YoVnNFG1yTtRcuB+C9ERWxGpicSpNQU8NF+OQ8UAsV3vvgDPyLoPTk3MxxRjzGgaf/AN8uMxvgSuIJDrj+njTEsSPrSdlCxvWmw0tDk+2JpusNg8acRFnYZ6DgLi1HJf2IqHMVCGQs/y+CncLfuYgimzTsfHwRHlmE37Be9+ou8uJShLU/DHocQUdQ==",
          "RSA",
          "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDiUeg5mqm3w18z8vZN6HjdOq9n0z5zFzUWbSB9OwxLU5MkTshnxbbs+XuubLiZJuAn8S7+RsmsAqLhoHEfQExiiVM46h1OROcDOVIvpC+KJgPVOJHS/zuAtoTa4pXCn6FkHVtXhg+9QU/fmVdYjox7PGRC1HAukPw+CVDo6PyL0YFPEbvHE18yD4ys7wozmdOm0mgSPNWeWcqbveybGuIXHWS4k49bmhz8S3o819OXWofWT8dDmBQZy1e3x1JoQMqsOAx9HMLT0kRWwXVQjUFeN2ZqvbGzNxoK5xTd1SAXIY5JIjFpihypnAcsXjBKPxELG8CtlA3X8zPYYrdSfPBZAgMBAAECggEAEAfBLSNZVhzOh310GLyYowLfHbmGuNwx9G6yWGxwSH2Y9H9oDoGgnVRmgEpPIPnx8qJQs84LxtVA+D5HBPGm92vGq0dZ4AtdWYsb2SgF/gEHUHj7Szis3EcRTfeyp+BqrA6wQ5jJUJxprerMlwcxyCDU8S7e6011sGc0herKyJRiNyfpq27OjQpzx6RMlaIwJSHyc2ZUkcTf7agDDPxxntLVL83RLdQ1VBiTZ6aSpRk35mCToQWRHJ/DEPHp2s4nYLuT6Q80tmzbUyiDJLPYWs/DFplgdhz6xPXcJT8AAJ4u/bx2rgn+Qs0hVLCWS5TndU8uUVMOga8nSolB69wx6QKBgQDn+jn3yo98DKfQq6okxaqk/JHEIfk+CRxqfT0M0jv1Yu2i+AcURXi9c1YbWj5mnmL1cbRvAqROPirSVbKthNr6f1LOBQNE28Wp6e0UhbpdCysAJQ42zIt5zpkjNR3sv7Ov6rNpd9rESprCrlZVGO6ASqyE4MLDyleeKvyWAcap3wKBgQD5wbL9tTyi2egTPrNKk2SNAbaSN3kWh5fyO9iFgaWJXcx9HLOxQw4eHKbd0yivf/p+rA2cxT43V+JGeYUabPAdqlxwnogiAFhkKHRK4uykpYtbcXKl1bcokPpjUIZhW0eBuTzLHW+TqtARUwTvJarXcMO97ElpjqyggOs71dWcxwKBgG2LeHxPJ1rJDyY3Km2a+m5W5u7brDtjSgvvgDjhvnaudNGUlqM3+0Bbirn376e9+7U0MKSLdtOL/+S7m1jdeBr6rTukmlqV/c2zLcWXMN5nO7MhzIiMJwEqUp6RosP98viLuJWBh8lSAasVcKdW0qm6maVWDiMvFhkW65ha1lm5AoGBAIlWkFye+rb6aHmcsu7BWjuHw6Nnybgv28giTJAtmJ+O6tGppM5G905rpv64DNlk4JQjfGDGvc2lEBJ85EqBuRA3DBoJswYvdmutKzW6zzJCrf0cx1SVzuAJyQYv05VZolqdR+bRSvfCqCO+qSnwZp+NrLWVZ1EaWabw/WmrzoklAoGAZU7ZG2qjp/XNKDvimqpwUMEFnj4KJXsbKEuL8CmLyhOOtmwvOeCva/Ks+Mf0rIaPX8Y7ZYzngxXvts2F3wMPwe1hrdJvlPtUnGAjSWd23z99klQ/LxUlmKhaILefG4oH0SaoaWq2/jdXUVno3MYgAm7r9jChhKNLoQVhBCpmOI4=",
        )
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.RS256,
          attestationMaker = AttestationMaker.packed(
            AttestationSigner.selfsigned(COSEAlgorithmIdentifier.RS256)
          ),
        )
    }

    val BasicAttestationRs1: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.RS1,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746159016849960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020b7462ea8d0c81456b6f15293642361bf5774a683dce4ed57ce9ed627e6ff18e6a401030339fffe2059010100c6e9a3c8649c81373f25650c4c92e54dcc3d7efbd7b601ee50479fca749fa44e2ed68de5d0ebaa83d3ee98ff457096bb9f02445c7a72ba2fe688fc4bebbd1a7d5e51d15a4b59315939b65e1823c6ef222dcee32c4ab2d971675ef8086d694e4fdcdd55c358eaf279eae7c9529239d07f236893bee9c74627a9b1c655aff3a486e3888a563155432e7c7f35fb7307c79c8408513a396d9d0b6094948a6b385c0143fe0645483dd04a775d17a884a78cd54c87f5b0b992664f5caed69d5f37544e0fe8ddc725f5ebf89e9e70bb98c6138749c5ab6e328eae4fd61d4898ad8219337ec008db674058842ea6a4d3740d8794ee799eff6a04bf75141499aa9a8dfdff214301000163666d74667061636b65646761747453746d74bf63616c6739fffe637369675901002ec4b2537e85566e913dc78f1e0a49141b88709e90e24f241d0a217d488194cdbe84a5a52e703d23116ad95d4c5540d514786b8215d2953d5a2dc6a8db68239b6cdf80dde7477a13ed92b7dd86e73a996b23607af3824e8703383a6f7c244c8c82a8a858dc44ac15e58fdfcf46b6bade67c4a04657932edf7a5fececc70a70817d8645113ed02650c4f38b32c89e5160f40b516db54e4e7677e109f07e7279f46643641623019c378ba733347a43290a22b37b71bcc172d208bf551e3109d6fd18f2214faf4263d236be2170296af5151d1e61f11beb2aebf5f40885ee2ab026c5212d9633f806d956714854ebeb8a27c56f37b7e10aa717273e9af84f95fd7163783563815903733082036f30820257a00302010202021750300d06092a864886f70d010105050030673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b300906035504061302534530820122300d06092a864886f70d01010105000382010f003082010a0282010100ae0beb5c73cd4445d3e589d30ab26bca92c33db6d18f4861d707757a7efda235f91c2ec93bbd728cdb286f0d911ac7eba2c9433a04d2e227af0c55d82dcbbbc82b96c3ed079eebd1502150c9e2ca128a08c499cd11f72058d7edd6db4937d5de67083a1d04c9637555ab8d9ba2702ca24db8b48a558e9721935b9415ee783e8d5d378bbd494a7a7226495dbe61b699d80479393d3e40fb2dcb90b66ce1edc8bb554f839c4f4621e06be32eecd434a8d26eecd011552e45b0563647f12a76d41209db7ea2cb0821723155bfcb4479f8911f503af5a7488a5e3f587915949537bd324ff5b81d13f99838d9e1daa1b47c7f9cf3900b74c62abd31345a0802545f5f0203010001a32530233021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f300d06092a864886f70d0101050500038201010049b713e2a6d40c6d03ea70015a2e5bdcd981dfaa95a1028c52439caa3c7a82a9c203c5da1370578fc0be2442cb96bc35d58ba9a56cf16a10f1c870d72831caaf26092ee131b8adbc0f1b88a2fb911ff91708aae28e057b1b5c78a67765e8c77aa5d7eb3caf77bc8d5b50e02bf290a605d6bb57d2ce2f1190862143b8c0897351d3ad886708a505565847301649f90edeece4a37a5983cc5f8bc1350ac6eb4f5a61ea7544a8c20887b5564b72b95b6dc1ef8f31581a77de7ed0b212a9c0d0c8027184d1ca4536a3d38c4d20f5cfc1b9191d9e1797676cfa229a61ee63755892e7714bf30065c4b68b31a8f65ecd65fd1a77a5db3f91845413afa5e2e47643f03effff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308204be020100300d06092a864886f70d0101010500048204a8308204a40201000282010100c6e9a3c8649c81373f25650c4c92e54dcc3d7efbd7b601ee50479fca749fa44e2ed68de5d0ebaa83d3ee98ff457096bb9f02445c7a72ba2fe688fc4bebbd1a7d5e51d15a4b59315939b65e1823c6ef222dcee32c4ab2d971675ef8086d694e4fdcdd55c358eaf279eae7c9529239d07f236893bee9c74627a9b1c655aff3a486e3888a563155432e7c7f35fb7307c79c8408513a396d9d0b6094948a6b385c0143fe0645483dd04a775d17a884a78cd54c87f5b0b992664f5caed69d5f37544e0fe8ddc725f5ebf89e9e70bb98c6138749c5ab6e328eae4fd61d4898ad8219337ec008db674058842ea6a4d3740d8794ee799eff6a04bf75141499aa9a8dfdff02030100010282010015cb0d606c4835640f2d6802794a9d8846389ff6b46ded8ce5b623375ef5b55e6cdaa1ab5740d56accc7d71d7371e021e84c559f12e4b4ff80864100df1ad5e7271eac62f489c37d5f745a9f7c73fef3ee0992718cdc46df44e5c3ce709104127deeb0c7240681d0826b28c492342162d1f1fd96022e6217ab0b9e364f29263d01071e09c724600996d64784208c66cbfe45c16855bf692997fce05cda8f78525e6368a9a764e21d6c8daf93f3ff78da2bd975dae066b6bb47f13d88142038b9e968ecb262e331ff6768af61f52f9ddf7d2dbdb82d7528ae6afbffac7e288564e9277ef8cad93c1ed4688318a2afd7d4a521e2fb927711d73fa60b68db726e7902818100de9c4f2236579c5aed66679b7ce5f33711bf41725d6167401fd167355055565a68b021c2c92c7eafcfb6da486b72d1725c0e992ab3f40937284a1d2e9dd4e4e38731050b86e2e33e66257c7d89f05e924efb305db4ff4ea77f89866b8916c223bf397ff604e7e2a5792e03da6648a2e00d825c852d995170cb66529d31f2dbf302818100e4bf63af4c2ac829c5b2b81ce8692297c6266b1bc1dd1da5164b7d52d0687cb3e46758d4c804a7dc8486fdbf6cffbec3306cc035822b3f5929fff6d0cd23a7d9999986a309220c4e97f8bddc53293740b76f3065eeafcd0e4e3e496d12efddbb25dee0d46560051bfa38be985ee8f7b43d03c203f590f61dce4c2ba3864554c502818100c72721e8a2a3389f6439b44137b8e52104408d858a2324e30a5425b85d992afb112359e0d0677d233e7a00c8bf4fe62f204a731ef00547e54fa7167a68fb589671911a4958b04ccabb4998191bb9ae71c83512ed128b41cbb9dec822167004d9442f65da2c4363d1d41aa599d2ddf2d0ed650dee9b7fc98b567cc1361ec47d9f0281800a7b469b12b767229adf7c963e840ac4bf9ca50dc98d533d6c4f1b37ff3aba7417c4308ad77b7721a0a4fadd99a6025cb94c5266614790088ae722ad20a94098b4f416fa4381dee47f0c33cef3b490c6936131eb89cb5e6f0860cc4686369d8764cdd8a982d7aa8444abf2f7d26984682adf9035543c473ac8682f1bb81c572d02818100c4b4a8466afcf8a822aa53570f25dbdd5424960ceba2899ca1853d8c56cdaed6b52091807be7f5d94bc2350b89e458a1ec4bb2ee8742c2acfea9cd35bae56eed38b6c4ce1f7b0e8c4c8a823fb8d6b7e0c2da3da21944d44821adcba757346c228d5bbb767b858e1adf1bde99fc838b119f0aceb9f2b79e55b32a0ffcab590c43")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDbzCCAlegAwIBAgICF1AwDQYJKoZIhvcNAQEFBQAwZzEjMCEGA1UEAwwaWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMxDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBnMSMwIQYDVQQDDBpZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0czEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAK4L61xzzURF0+WJ0wqya8qSwz220Y9IYdcHdXp+/aI1+RwuyTu9cozbKG8NkRrH66LJQzoE0uInrwxV2C3Lu8grlsPtB57r0VAhUMniyhKKCMSZzRH3IFjX7dbbSTfV3mcIOh0EyWN1VauNm6JwLKJNuLSKVY6XIZNblBXueD6NXTeLvUlKenImSV2+YbaZ2AR5OT0+QPsty5C2bOHtyLtVT4OcT0Yh4GvjLuzUNKjSbuzQEVUuRbBWNkfxKnbUEgnbfqLLCCFyMVW/y0R5+JEfUDr1p0iKXj9YeRWUlTe9Mk/1uB0T+Zg42eHaobR8f5zzkAt0xiq9MTRaCAJUX18CAwEAAaMlMCMwIQYLKwYBBAGC5RwBAQQEEgQQAAECAwQFBgcICQoLDA0ODzANBgkqhkiG9w0BAQUFAAOCAQEASbcT4qbUDG0D6nABWi5b3NmB36qVoQKMUkOcqjx6gqnCA8XaE3BXj8C+JELLlrw11YuppWzxahDxyHDXKDHKryYJLuExuK28DxuIovuRH/kXCKrijgV7G1x4pndl6Md6pdfrPK93vI1bUOAr8pCmBda7V9LOLxGQhiFDuMCJc1HTrYhnCKUFVlhHMBZJ+Q7e7OSjelmDzF+LwTUKxutPWmHqdUSowgiHtVZLcrlbbcHvjzFYGnfeftCyEqnA0MgCcYTRykU2o9OMTSD1z8G5GR2eF5dnbPoimmHuY3VYkudxS/MAZcS2izGo9l7NZf0ad6XbP5GEVBOvpeLkdkPwPg==",
          "RSA",
          "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCuC+tcc81ERdPlidMKsmvKksM9ttGPSGHXB3V6fv2iNfkcLsk7vXKM2yhvDZEax+uiyUM6BNLiJ68MVdgty7vIK5bD7Qee69FQIVDJ4soSigjEmc0R9yBY1+3W20k31d5nCDodBMljdVWrjZuicCyiTbi0ilWOlyGTW5QV7ng+jV03i71JSnpyJkldvmG2mdgEeTk9PkD7LcuQtmzh7ci7VU+DnE9GIeBr4y7s1DSo0m7s0BFVLkWwVjZH8Sp21BIJ236iywghcjFVv8tEefiRH1A69adIil4/WHkVlJU3vTJP9bgdE/mYONnh2qG0fH+c85ALdMYqvTE0WggCVF9fAgMBAAECggEADxD0E6w97CI5ThOeDmfUjJQjd4+rA1gU3swuqhHH0Jy9zufpPpUkjzdCKvQwh/Ifc+zajMaxyfxScGMWqXGLSgV6nG+ZKx4nH+R1EwzhSN/kaL8W8UOvFqcWgnS4GVps/AafyoxJXKU3Fc3WglDAjwo4VNSWxGxRGT73tOWlnhByR8pDg0RY+IUywvTwrMkK1t5klMKn8iGXp4FoJH5+9g2cyThhZKsbFbX79ldxvp6ZPXztQutejFLUGgYjE8kc0WjYOpdktHb5vaA1Fb1EovMPVrw309TDoc7a7vd0/JWextsDilSeK9osOqSjtaK6lqDU60MpW88dXHqf2/KJUQKBgQDpiMPJgmMgS2Q4NDDjhh/pXOSzylB0C4Ut0orzV8XzhLBZK+2zpOfeshO0NEl5HKrD5+U6qRUutDnziN1XNAi9zaBxE59HHsBn/mEQAZ4BABh7yqoRzsPZyXHqH9I9nXH4E1ul7e8olEkTMxfoVpogvd6ouIHRzqMcdfVu+SIl8QKBgQC+yiecSUpUeqrYXamjJNMGffMcylE3TBRxnxsxb1Kc9K0fP4Kg96P0pd6n8ZVyIlwQbPHf0SO16bCmMWAFcW359Gwih7RsXtiVn7E3rCJh2v/xXYVTXaLVPPBTFmltEptHB9pdB898TXeD3HxEvK3T6pO3ikxi4Qhv5iA70ANKTwKBgB9i6i1jAL+OYmHLYeayWAedHH+taTKvea625UXfPhOEec8CQGgseZ1MgalufZFxcOHzgLNplhc40bERa+4UaDhaMn4ADSAZ2fIgFht4nCu2P5QjoMfT6i6TDGRS8oalanPU5jRezg2+IDQcYdIwEXblDc/PPGNeSj3A/MN1aEmBAoGAGTU2hJS+aGkIt6uwZSjRZPMxMuWcU3UO4nBGNILj5G8DjLRkewYdOI7N21y1BS57AYSTdKH6WOe2ek7dw/pXsIXV374UXZkufp5p2NQ6erlnxak4m2oswIXbru6wIUQrFfh4poAIrwDBQL/Z/276fJxqxf5U11+qMLa0HZL/TEsCgYEAyrcR+1DZJEcMeQXGc3bwDuCKcZRxSSnmYeWBL4aY0BV6/ktRKF4a0VZtXeNCUeXmdJZmr6yG0YdD4spUBlZZuWqEnEWbmhKTDzJKhEYktBxC+DGiYrkSZwWQAVjgKpPo0PL5I0j38UZfk2s2w0KAecGWhqMZmFQHh2DxwvQ9ECs=",
        )
      ),
      assertion = Some(
        AssertionTestData(
          request = JacksonCodecs
            .json()
            .readValue(
              """{"publicKeyCredentialRequestOptions":{"challenge":"N3LjI2J5ylyWe3ED5OT4XHLRqHwm_J48_D_hoJOFf30","userVerification":"preferred","extensions":{}},"username":"test@test.org"}""",
              classOf[AssertionRequest],
            ),
          response =
            PublicKeyCredential.parseAssertionResponseJson("""{"id":"t0YuqNDIFFa28VKTZCNhv1d0poPc5O1Xzp7WJ-b_GOY","response":{"authenticatorData":"SZYN5YgOjGh0NBcPZHZgW4_krrmihjLHmVzzuoMdl2MBAAAFOQ","clientDataJSON":"eyJjaGFsbGVuZ2UiOiJOM0xqSTJKNXlseVdlM0VENU9UNFhITFJxSHdtX0o0OF9EX2hvSk9GZjMwIiwib3JpZ2luIjoiaHR0cHM6Ly9sb2NhbGhvc3QiLCJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwidG9rZW5CaW5kaW5nIjp7InN0YXR1cyI6InN1cHBvcnRlZCJ9fQ","signature":"jZ9gU1TUKJ851-tmsBVtoE89Zt08UkOFSx7_LSQHYluLZ8Tj-LAfsxLp6TOHtNd82yg9oSFZZRUHCunZgtljBuLS6zWyhUd6kU9uoh4tUZ1ZPQuKj5F9YbjzB_qd3xRMsk_wKydErCr6S-TZ7sxAXuXs5JnjyUWTvDJILwv-bzIgaPaXZ_twXAe-h5sN14Vcf02cMo2kFm0wx86jOg25CEljJN-rQdRzSq4pHew8YhU_asXoMbGrkEtNhhjlCmyMoVamPd23kNMCjP05ofiM4av4BuZvi8RaeNhRJ1-oy-TQgMDG_Itpu-cSiD7zUOvNByjycicSevHvqLaOFyrhzw"},"clientExtensionResults":{},"type":"public-key"}"""),
        )
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.RS1,
          attestationMaker = AttestationMaker.packed(
            AttestationSigner.selfsigned(COSEAlgorithmIdentifier.RS1)
          ),
        )
    }

    val BasicAttestationRsaReal
        : RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.RS256,
      // Real attestation object from SKY3
      attestationObject =
        ByteArray.fromBase64Url("o2NmbXRmcGFja2VkaGF1dGhEYXRhWQFXAU4Ai_91hLmkf2mxjxj_SJrA3qTIOjr6tw1rluqSp_5FAAAAAG1Eupv27C5JuTAMj-kgy3MAEApbxn7DR_LpWJ6yjXeHxIGkAQMDOQEAIFkBAPm_XOU-DioXdG6YXFo5gpHPNxJDimlbnXCro2D_hvzBsxoY4oEzNyRDgK_PoDedZ4tJyk12_I8qJ8g5HqbpT6YUekYegcP4ugL1Omr31gGqTwsF45fIITcSWXcoJbqPnwotbaM98Hu15mSIT8NeXDce0MVNYJ6PULRm6xiiWXHk1cxwrHd9xPCjww6CjRKDc06hP--noBbToW3xx43eh7kGlisWPeU1naIMe7CZAjIMhNlu_uxQssaPAhEXNzDENpK99ieUg290Ym4YNAGbWdW4irkeTt7h_yC-ARrJUu4ygwwGaqCTl9QIMrwZGuiQD11LC0uKraIA2YHaGa2UGKshQwEAAWdhdHRTdG10o2NhbGcmY3NpZ1hHMEUCIQDLKMt6O4aKJkl71VhyIcuI6lqyFTHMDuCO5Y4Jdq2_xQIgPm2_1GF0ivkR816opfVQMWq0s-Hx0uJjcX5l5tm9ZgFjeDVjgVkCwTCCAr0wggGloAMCAQICBCrnYmMwDQYJKoZIhvcNAQELBQAwLjEsMCoGA1UEAxMjWXViaWNvIFUyRiBSb290IENBIFNlcmlhbCA0NTcyMDA2MzEwIBcNMTQwODAxMDAwMDAwWhgPMjA1MDA5MDQwMDAwMDBaMG4xCzAJBgNVBAYTAlNFMRIwEAYDVQQKDAlZdWJpY28gQUIxIjAgBgNVBAsMGUF1dGhlbnRpY2F0b3IgQXR0ZXN0YXRpb24xJzAlBgNVBAMMHll1YmljbyBVMkYgRUUgU2VyaWFsIDcxOTgwNzA3NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABCoDhl5gQ9meEf8QqiVUV4S_Ca-Oax47MhcpIW9VEhqM2RDTmd3HaL3-SnvH49q8YubSRp_1Z1uP-okMynSGnj-jbDBqMCIGCSsGAQQBgsQKAgQVMS4zLjYuMS40LjEuNDE0ODIuMS4xMBMGCysGAQQBguUcAgEBBAQDAgQwMCEGCysGAQQBguUcAQEEBBIEEG1Eupv27C5JuTAMj-kgy3MwDAYDVR0TAQH_BAIwADANBgkqhkiG9w0BAQsFAAOCAQEAclfQPNzD4RVphJDW-A75W1MHI3PZ5kcyYysR3Nx3iuxr1ZJtB-F7nFQweI3jL05HtFh2_4xVIgKb6Th4eVcjMecncBaCinEbOcdP1sEli9Hk2eVm1XB5A0faUjXAPw_-QLFCjgXG6ReZ5HVUcWkB7riLsFeJNYitiKrTDXFPLy-sNtVNutcQnFsCerDKuM81TvEAigkIbKCGlq8M_NvBg5j83wIxbCYiyV7mIr3RwApHieShzLdJo1S6XydgQjC-_64G5r8C-8AVvNFR3zXXCpio5C3KRIj88HEEIYjf6h1fdLfqeIsq-cUUqbq5T-c4nNoZUZCysTB9v5EY4akp-A"),
      clientDataJson = new String(
        ByteArray
          .fromBase64Url(
            "ew0KCSJ0eXBlIiA6ICJ3ZWJhdXRobi5jcmVhdGUiLA0KCSJjaGFsbGVuZ2UiIDogImxaMllKbUZ2YWkteGhYMElteG9fQlk1SkpVdmREa3JXd1ZGZllmcHQtNmciLA0KCSJvcmlnaW4iIDogImh0dHBzOi8vZGVtbzMueXViaWNvLnRlc3Q6ODQ0MyIsDQoJInRva2VuQmluZGluZyIgOiANCgl7DQoJCSJzdGF0dXMiIDogInN1cHBvcnRlZCINCgl9DQp9"
          )
          .getBytes,
        StandardCharsets.UTF_8,
      ),
      rpId =
        RelyingPartyIdentity.builder().id("demo3.yubico.test").name("").build(),
      userId = UserIdentity
        .builder()
        .name("foo")
        .displayName("Foo Bar")
        .id(
          ByteArray.fromBase64Url("NiBJtVMh4AmSpZYuJ--jnEWgFzZHHVbS6zx7HFgAjAc")
        )
        .build(),
    )

    val BasicAttestationWithoutAaguidExtension: RegistrationTestData =
      new RegistrationTestData(
        alg = COSEAlgorithmIdentifier.ES256,
        attestationObject =
          ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f002032b7598c61949137c693b792dd4d036546efeef8cd9998869f72e33b9989c429a501020326200121582026ee0679adcbdb11a2cf0e5fca991c0473644ff33eea4f917c570bfa58315fcf2258206135429534addbcbc9fd7b4f65cdb9f6b26082721c0b388b9b3076492e4e753f63666d74667061636b65646761747453746d74bf63616c67266373696758483046022100914467c73433609371460eb9ca3a12d70c5ecfe942621f830a04a402f284151102210082a3aee4e2cf2dec408b7db938f154ed35e027159e1643d85817e5583cd1bc4563783563815901c0308201bc30820162a003020102020224f1300a06082a8648ce3d04030230673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453059301306072a8648ce3d020106082a8648ce3d030107034200047cbe20ac36a8636bc7db9f09e982d2b42ac14dcfae2b4817779dc866e447567be05809d3cb1d86175066b11450e9e7f3c41b80738f47434e4943ca7262742054300a06082a8648ce3d04030203480030450220090e769ad19167008e077b2e59a4970eeb0f2a012ceea26b29d9839807d0c0fe022100dbe4ca02fbe9e2c35556d7d41ae37fba68a9ea1fdc629e49e1b31bffa1482ed4ffff"),
        clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
        privateKey = Some(
          ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d030107047930770201010420d2b1178e0663be84ac03cc4b0a780932d6888505e96e028a8eb88316ce403e42a00a06082a8648ce3d030107a1440342000426ee0679adcbdb11a2cf0e5fca991c0473644ff33eea4f917c570bfa58315fcf6135429534addbcbc9fd7b4f65cdb9f6b26082721c0b388b9b3076492e4e753f")
        ),
      ) {
        override def regenerate() =
          TestAuthenticator.createBasicAttestedCredential(attestationMaker =
            AttestationMaker.packed(
              new AttestationCert(
                COSEAlgorithmIdentifier.ES256,
                TestAuthenticator.generateAttestationCertificate(
                  alg = COSEAlgorithmIdentifier.ES256,
                  extensions = Nil,
                ),
              )
            )
          )
      }

    val BasicAttestationWithWrongAaguidExtension: RegistrationTestData =
      new RegistrationTestData(
        alg = COSEAlgorithmIdentifier.ES256,
        attestationObject =
          ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d976341000005390f0e0d0c0b0a090807060504030201000020be7b974862619d3b0cade8425a6d9f9e45d6fdcc81f3753746fb77239f3493d6a50102032620012158202441c80a3b195d4843e403e1099a754d3a535135eea95b930dc2edacaf615e1a2258202250729253ca17376e87c7c1129ce29a5385f3358fa902473c1e971cba531c7a63666d74667061636b65646761747453746d74bf63616c67266373696758483046022100bb0e0f781d9379a86140fec8daa4c264dd9f038a0f2bf114933b10fb65e12d050221008b7a33c94396e746f53c51f173825da83284a8b5ab22f8966cd8a16b6229dd8663783563815901e7308201e330820189a003020102020223f4300a06082a8648ce3d04030230673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30673123302106035504030c1a59756269636f20576562417574686e20756e6974207465737473310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453059301306072a8648ce3d020106082a8648ce3d030107034200049ae973f617944d82164bd0ab6fef650e6f1f16ee9651b7a1bfc64a46a0ae0ba37a5ac0fda5e89a9056e7fb18af8f72c38434a834a49f6b4be69c3f5cac680216a32530233021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f300a06082a8648ce3d040302034800304502203092c9c29195223366d935be85e724ef83c85b819fa693bdc1873b49b73426400221008d9744429db78e1cc8fb338010c6f3d5bd87ee9dfc180e618007ebf3ad01b559ffff"),
        clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
        privateKey = Some(
          ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d0301070479307702010104201e032ba8427464054d6b938d76bd08525610812af53256e23c417be37f9cd6dfa00a06082a8648ce3d030107a144034200042441c80a3b195d4843e403e1099a754d3a535135eea95b930dc2edacaf615e1a2250729253ca17376e87c7c1129ce29a5385f3358fa902473c1e971cba531c7a")
        ),
        attestationCertChain = List(
          RegistrationTestDataGenerator.importAttestationCa(
            "MIIB4zCCAYmgAwIBAgICI/QwCgYIKoZIzj0EAwIwZzEjMCEGA1UEAwwaWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMxDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBnMSMwIQYDVQQDDBpZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0czEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJrpc/YXlE2CFkvQq2/vZQ5vHxbullG3ob/GSkagrgujelrA/aXompBW5/sYr49yw4Q0qDSkn2tL5pw/XKxoAhajJTAjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8wCgYIKoZIzj0EAwIDSAAwRQIgMJLJwpGVIjNm2TW+heck74PIW4GfppO9wYc7Sbc0JkACIQCNl0RCnbeOHMj7M4AQxvPVvYfunfwYDmGAB+vzrQG1WQ==",
            "EC",
            "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgaztl9/kO098o7Rt1vnCg2bWkN83fEN0qlBzFDiTZYSWgCgYIKoZIzj0DAQehRANCAASa6XP2F5RNghZL0Ktv72UObx8W7pZRt6G/xkpGoK4Lo3pawP2l6JqQVuf7GK+PcsOENKg0pJ9rS+acP1ysaAIW",
          )
        ),
      ) {
        override def regenerate() =
          TestAuthenticator.createBasicAttestedCredential(
            aaguid = new ByteArray(
              Array(15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0)
            ),
            attestationMaker = AttestationMaker.packed(
              AttestationSigner.selfsigned(COSEAlgorithmIdentifier.ES256)
            ),
          )
      }

    val SelfAttestation: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020e3550a5097d3a496c37eb51b9eebaf1f2b26888f82d611a945d02f06a232035ea5010203262001215820bb79c99a09888bdc49eb4714aa674df11c41e95c5ce25ba55e9ea7b6dfa59430225820b50119d7bcf64573eb6f298196a86ec1fc698b98b68f0686a75ed871f352f15e63666d74667061636b65646761747453746d74bf63616c67266373696758463044022100848fd7ad4bd6d19b9f8278c2fa21be42337a8407b3a14332bd741628f4c96781021f2ce04061cce131be0e0b0839cbb8a262ebc7dbac9e732feb47e3c159999938ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d0301070479307702010104209ae0d69504d4a0ee4b1077aa05e82aa5883c1c9c9fba08a7b884995e1b07af2aa00a06082a8648ce3d030107a14403420004bb79c99a09888bdc49eb4714aa674df11c41e95c5ce25ba55e9ea7b6dfa59430b50119d7bcf64573eb6f298196a86ec1fc698b98b68f0686a75ed871f352f15e")
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createSelfAttestedCredential(
          AttestationMaker.packed(_)
        )
    }

    val SelfAttestationRs1: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.RS1,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746159016849960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020e4b8a8b5c225031de6ff7b7de055afd8f6894db33a7dfef71f9905588931b427a401030339fffe2059010100aa235e49d81e92013f0d12d21e461d6289d48d955c480b7144ee71bedf96df015e20c35185a43813d2a09c1264d58a2463d602ed563c52e5b3cee29969cfd595cd3a8a84f1b3ed5b4cba4888690368844f9d0778bc3c56b9ea2531f2f19b776a6758fc60cc3c5869d73d68f1f381ae6a8440efa305d62f5b1ed3228112af989aa20517e37443f7725f7329e3a212a2a62a5d4dc1bf650706a6e5c7cb648c56a144ecb9c1ff29a6e83188fa83a9a2f0daed0dda05b0645bb742b3b40bea52c5c82c14ff014f363e3b6830007346ce30a21feb0547bfbc5fb3c64c793f036f743e050c172047fc9d4d805c377be2ec7d2a64cfb62ad11d0527b1b4ab61ccd60787214301000163666d74667061636b65646761747453746d74bf63616c6739fffe63736967590100316bd76326d49143881c7385acdb010903357b551c73eb85dc0b52de517bc6dd7f6e576e2ce6ca1220903e364d37da4296cb635afcf2eab7b318607998bd8a1443d428193748bcfeacad6f138667b39dc06986a7ef1470628083a104eadf70bfcc49a4b418453b3aecd78e9c593e08ffab3acae59f0bcab24c0f5881772c498344e2e5979d27cfc49307b5d20a847b8a93d1e8b87600e4f55efbe03c2386f47879ecb7528db69c2b1e667877284a9e9cbbac833ea15c950c3e7d0006252344bd760e19549ac2cf2cc4220a3886d187dc6fe538d79935947b41287420466ba53f2fcef6a6a43f95de913dcedbfc85caebd8a5de6b36d603dd26b3d9c84fc17885ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308204bd020100300d06092a864886f70d0101010500048204a7308204a30201000282010100aa235e49d81e92013f0d12d21e461d6289d48d955c480b7144ee71bedf96df015e20c35185a43813d2a09c1264d58a2463d602ed563c52e5b3cee29969cfd595cd3a8a84f1b3ed5b4cba4888690368844f9d0778bc3c56b9ea2531f2f19b776a6758fc60cc3c5869d73d68f1f381ae6a8440efa305d62f5b1ed3228112af989aa20517e37443f7725f7329e3a212a2a62a5d4dc1bf650706a6e5c7cb648c56a144ecb9c1ff29a6e83188fa83a9a2f0daed0dda05b0645bb742b3b40bea52c5c82c14ff014f363e3b6830007346ce30a21feb0547bfbc5fb3c64c793f036f743e050c172047fc9d4d805c377be2ec7d2a64cfb62ad11d0527b1b4ab61ccd6078702030100010282010040474c80299ea31ac56f7304df5b2e0ee473e169e48b73873fbbb64d9ebba95522f2cdd826dd7c3241095cedb61ad72e1869ea81306b6a064e80832be2c61ab395ede0178a19a83b2e29d2ed767f4b2571cea9dbfb81f0621d0c206ae0cd13b8a782ff16b312b97483553828f10eb58e9898cff08f6bf44840c513ec1fdb2793e5220a1e3a679b9a56802bd022886912bd8c5a39771267676b1818a82f9baf14974528062ca92c27c8a0e5632d34049e85f29f49483d60a4d0805294ba3aab83d587b91243b962c5f3fc4e896ffb68fdfde5825b3572077f66078fc6369f2c64edfca3aa470c40bdfd19cc017bb8443929b0320f3baa654612678d03fed958c102818100ef759c2ee1751c085486aca0a4b757ff7ff8aaf97bddaa1e7f622b9e70cd1cc140355b1cfb068fe49f9eabbe4e87b00d420a628b4d87bd1f03059fd43f260bd5708998e7f930601ca2d2edbf1a15306bfb2fb282c24a585ab16da6856d63ce6e6b6db0781396a9a54c984e6a6e78560d0e44497a99d1a82264bece88e1ed7efb02818100b5e3f12814079e996a83ea316380b94a349e1fde55c4c0a42337ce21c872904ef47c7c0e6d9aaf9c8aa1205383ba35f10b08601cc23eb5910a71163bac0211b9271e656aad54cadacaf6fa53947a8aa90b77be4a53bea74d5c982015e95d960d873d716bcb9d5f53db2e44edf931128107b43f1e6a258da6d831570fe1eb83e502818100a290a9b37a04533fa482b97765dbc2b6065eff53d82fa86a83f855bc7ec001218141b7d578e5ff922a7b420534b311662ecb761334534ea55b1bda61f16d16e3943f15bb8684bcfb33df16e082089892f6386f6c2e12e2e0cf4bad9d2fa26e66b0300b79b972b341313ac521a455b5b5af55d4bc92e8aec88ab4aeea66d72139028180338eee5feef58df66ce401b1884407c1ca127c741899d20574da2fbb11c7afb241c93b9d17627e9f0008d651f608059c530547c13f2a696b38ab7fa2e08a219dfb41b97bb8b04d64219e4aad006c8ffb84fda75a084d05bd7f1ebc1199f9e63be576fc3c931603dc90479850608f917033cfdb08730c3c0fec3e68305f58d42502818040721fd4a13d7001227d4c54fd36344145263de906923bc6c950aa573a8ef9df2ec3f92670895bd19bb79c0aa2608dc2e5f004d95e93ba1b7ae9483ec0439767c93ed09667e08a962f0bf4ab237e499327698ac44b1d1fb8147bbd39698b680406dcffdf297a9c7437f90ef61b0022df6a995fe026775ed49c971ed5e80a99f0")
      ),
      assertion = Some(
        AssertionTestData(
          request = JacksonCodecs
            .json()
            .readValue(
              """{"publicKeyCredentialRequestOptions":{"challenge":"N3LjI2J5ylyWe3ED5OT4XHLRqHwm_J48_D_hoJOFf30","userVerification":"preferred","extensions":{}},"username":"test@test.org"}""",
              classOf[AssertionRequest],
            ),
          response =
            PublicKeyCredential.parseAssertionResponseJson("""{"id":"5LiotcIlAx3m_3t94FWv2PaJTbM6ff73H5kFWIkxtCc","response":{"authenticatorData":"SZYN5YgOjGh0NBcPZHZgW4_krrmihjLHmVzzuoMdl2MBAAAFOQ","clientDataJSON":"eyJjaGFsbGVuZ2UiOiJOM0xqSTJKNXlseVdlM0VENU9UNFhITFJxSHdtX0o0OF9EX2hvSk9GZjMwIiwib3JpZ2luIjoiaHR0cHM6Ly9sb2NhbGhvc3QiLCJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwidG9rZW5CaW5kaW5nIjp7InN0YXR1cyI6InN1cHBvcnRlZCJ9fQ","signature":"cFBvEhe-qgBaq7uqKrtgnb_9CwL3uejbeBDNcX9sii0PtEwDHLltnMFWAOSjPDyovQVPci8Quz65ft4eLIWdCnd_er4gN8GC8WG5eX5JEePBZbKZF5grkntIFMJieBX0CvremEmItKkEEa4U-k2Itn_pdh0zCtGGGQhXYIzHpGe4_iA2bkCIYjCYBy0xUw_tHccRhGp6WB88xLrUlkb5fF9mQulL3O3EzV8-J3SQoMBuh2kvUFNRx1SCXgA_ckaeMp9sHqCdDoreCjm0vd8hEDYiXMDW6I9fglVMivrskTE_Ddms2HFE-IkFxwnE2jJhEAysEooq4I7DXSKPL5q-ZA"},"clientExtensionResults":{},"type":"public-key"}"""),
        )
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createSelfAttestedCredential(
          AttestationMaker.packed(_),
          keyAlgorithm = COSEAlgorithmIdentifier.RS1,
        )
    }
  }

  object Tpm {

    private val tpmCertExtensions = List(
      (
        Extension.subjectAlternativeName.getId,
        true,
        new GeneralNamesBuilder()
          .addName(
            new GeneralName(
              new X500Name(
                Array(
                  new RDN(
                    Array(
                      new AttributeTypeAndValue(
                        new ASN1ObjectIdentifier("2.23.133.2.1"),
                        new DERUTF8String("id:00000000"),
                      ), // tcg-at-tpmManufacturer
                      new AttributeTypeAndValue(
                        new ASN1ObjectIdentifier("2.23.133.2.2"),
                        new DERUTF8String(
                          "TEST_Yubico_java-webauthn-server"
                        ),
                      ), // tcg-at-tpmModel
                      new AttributeTypeAndValue(
                        new ASN1ObjectIdentifier("2.23.133.2.3"),
                        new DERUTF8String("id:00000000"),
                      ), // tcg-at-tpmVersion
                    )
                  )
                )
              )
            )
          )
          .build(),
      ),
      (
        Extension.extendedKeyUsage.getId,
        true,
        new DERSequence(new ASN1ObjectIdentifier("2.23.133.8.3")),
      ),
    )

    val RealExample: RegistrationTestData =
      new RegistrationTestData(
        alg = COSEAlgorithmIdentifier.RS256,
        // Real attestation object from Windows
        attestationObject =
          ByteArray.fromBase64Url("o2NmbXRjdHBtZ2F0dFN0bXSmY2FsZzn__mNzaWdZAQBFEaTe-uZvbZBNsIMtJa26eigMUxEM1mBtddR7gdEBH5Hyeo9hFCqiJwYVKUq_iP9hvFaiLzoGbAWDgiG-fa3F-S71c8w83756dyRBMXNHYEvYjfv0TqGyky73V4xyKpf1iHiO_g4t31UjQiyTfypdP_rRcm42KVKgVyRPZzx_AKweN9XKEFfT2Ym3fmqD_scaIeKSyGs9qwH1MbILLUVnRK6fKK6sAA4ZaDVz4gUiSUoK9ZycCC2hfLBq5GjiTLgQF_Q2O3gRTqmU8VfwVsmtN5OMaGOyaFrUk97-RvZVrARXhNzrUAJT7KjTLDZeIA96F3pB_F_q3xd_dgvwVpWHY3ZlcmMyLjBjeDVjglkFuzCCBbcwggOfoAMCAQICEHHcna7VCE3QpRyKgi2uvXYwDQYJKoZIhvcNAQELBQAwQTE_MD0GA1UEAxM2RVVTLU5UQy1LRVlJRC04ODJGMDQ3Qjg3MTIxQ0Y5ODg1RjMxMTYwQkM3QkI1NTg2QUY0NzFCMB4XDTIyMDEyMDE5NTQxNloXDTI3MDYwMzE3NTE0OFowADCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALtT5frDB-WUq6N0VYnlYEalJzSut0JQx3vP29_ub-kZ7csJrm8uGXQGUkPlf4EFehFTnQ1jX_oZ8jNPw1m3rV5ijcuCe3r5GICFD6gpbuErmGS2mDVfe3fl_p0gPvhtulqatb1uYkWfW5SIKix1XWRvm92s3lRQvd-6vX_ExPIP-pEf0tkeINpBNNWgdtx3VdW4KVFTcv-q2FKhqfqXiAdOMHmwmWyXYulppYqW2XC7Pw9QmHZR_C5Urpc5UMmABz4zWSAYOyBMkKsX8koAsk8RgLtus07wW3FhJqi-BYczIe0IxG0q9UL295lkaxreTkfWYZHMMcU4M-Tm1w7QvKsCAwEAAaOCAeowggHmMA4GA1UdDwEB_wQEAwIHgDAMBgNVHRMBAf8EAjAAMG0GA1UdIAEB_wRjMGEwXwYJKwYBBAGCNxUfMFIwUAYIKwYBBQUHAgIwRB5CAFQAQwBQAEEAIAAgAFQAcgB1AHMAdABlAGQAIAAgAFAAbABhAHQAZgBvAHIAbQAgACAASQBkAGUAbgB0AGkAdAB5MBAGA1UdJQQJMAcGBWeBBQgDMFAGA1UdEQEB_wRGMESkQjBAMT4wEAYFZ4EFAgIMB05QQ1Q3NXgwFAYFZ4EFAgEMC2lkOjRFNTQ0MzAwMBQGBWeBBQIDDAtpZDowMDA3MDAwMjAfBgNVHSMEGDAWgBSMmnF_AA0xD8rW7i0pqjSXJYwSHjAdBgNVHQ4EFgQUFmUMIda76eb7Whi8CweaWhe7yNMwgbIGCCsGAQUFBwEBBIGlMIGiMIGfBggrBgEFBQcwAoaBkmh0dHA6Ly9hemNzcHJvZGV1c2Fpa3B1Ymxpc2guYmxvYi5jb3JlLndpbmRvd3MubmV0L2V1cy1udGMta2V5aWQtODgyZjA0N2I4NzEyMWNmOTg4NWYzMTE2MGJjN2JiNTU4NmFmNDcxYi84ODIzMGNhMi0yN2U1LTQxNTEtOWJhMi01OWI1ODJjMzlhYWEuY2VyMA0GCSqGSIb3DQEBCwUAA4ICAQCxsTbR5V8qnw6H6HEWJvrqcRy8fkY_vFUSjUq27hRl0t9D6LuS20l65FFm48yLwCkQbIf-aOBjwWafAbSVnEMig3KP-2Ml8IFtH63Msq9lwDlnXx2PNi7ISOemHNzBNeOG7pd_Zs69XUTq9zCriw9gAILCVCYllBluycdT7wZdjf0Bb5QJtTMuhwNXnOWmjv0VBOfsclWo-SEnnufaIDi0Vcf_TzbgmNn408Ej7R4Njy4qLnhPk64ruuWNJt3xlLMjbJXe_VKdO3lhM7JVFWSNAn8zfvEIwrrgCPhp1k2mFUGxJEvpSTnuZtNF35z4_54K6cEqZiqO-qd4FKt4KYs1GYJDyxttuUySGtnYyZg2aYB6hamg3asRDjBMPqoURsdVJcWQh3dFnD88cbs7Qt4_ytqAY61qfPE7bJ6E33o0X7OtxmECPd3aBJk6nsyXEXNF2vIww1UCrRC0OEr1HsTqA4bQU8KCWV6kduUnvkUWPT8CF0d2ER4wnszb053Tlcf2ebcytTMf_Nd95g520Hhqb2FZALCErijBi04Bu6SNeND1NQ3nxDSKC-CamOYW0ODch05Xzi1V0_sq0zmdKTxMSpg1jOZ1Q9924D4lJkruCB3zcsIBTUxV0EgAM1zGuoqwWjwYXr_8tO4_kEO1Lw8DckZIrk1s3ySsMVC89TRrIVkG7zCCBuswggTToAMCAQICEzMAAAQI5W53M7IUDf4AAAAABAgwDQYJKoZIhvcNAQELBQAwgYwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xNjA0BgNVBAMTLU1pY3Jvc29mdCBUUE0gUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgMjAxNDAeFw0yMTA2MDMxNzUxNDhaFw0yNzA2MDMxNzUxNDhaMEExPzA9BgNVBAMTNkVVUy1OVEMtS0VZSUQtODgyRjA0N0I4NzEyMUNGOTg4NUYzMTE2MEJDN0JCNTU4NkFGNDcxQjCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAMEye3QdCUOGeseHj_QjLMJVbHBEJKkRbXFsmZi6Mob_3IsVfxO-mQQC-xfY9tDyB1jhxfFAG-rjUfRVBwYYPfaVo2W58Q09Kcpf-43Iw9SRxx2ThP-KPFJPFBofZroloNaTNz3DRaWZ2ha-_PUG2nwTXR7LoIpqMVW1PDzGxb47SNpRmKJxVZhQ2_wRhZZvHRHJpZmrCmHRpTRqWSzQT1jn7Zo9VuMYvp_OFj7-LFpkqi4BYyhi0kTBPDQTpYrBi7RtmF1MhZBmm1HGDhoXHcPSZkN5vq5at4g03R15KWyRDgBcckCAgtewd6Dtd_Zwaejlm57xyGqP6T-AE-N8udh1NPv_PZVlSc4CnCayUTPORuaJ7N-v7Y4wpNSIdipq29hw19WVuO_z7q6GpQbn17arYf6LSoDZfwO8GHXPrtBOYYSZCNKuZ_IK8nomBLJPtN5AzwEZNyLCZIkg0U0sJ-oVr2UEYxlwwZQm5RSDxProaKU-OXq4f_j_0pEu5_DbJx9syR3Nsv6Lt9Zkf3JSJTVtWXoM0-R_82vAJ669PX0LLr603PKWBZbW7zQvtGojT_Pc1FDGfwhcdckxd3MGpEjZwh_1D8elYcxj3Ndw5jClWosZKr33pUcjqeFtSZSur0lbm6vyCfS16XzSMn8IkHmbbXcpgGKHumUCFD8CHJIBAgMBAAGjggGOMIIBijAOBgNVHQ8BAf8EBAMCAoQwGwYDVR0lBBQwEgYJKwYBBAGCNxUkBgVngQUIAzAWBgNVHSAEDzANMAsGCSsGAQQBgjcVHzASBgNVHRMBAf8ECDAGAQH_AgEAMB0GA1UdDgQWBBSMmnF_AA0xD8rW7i0pqjSXJYwSHjAfBgNVHSMEGDAWgBR6jArOL0hiF-KU0a5VwVLscXSkVjBwBgNVHR8EaTBnMGWgY6Bhhl9odHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2NybC9NaWNyb3NvZnQlMjBUUE0lMjBSb290JTIwQ2VydGlmaWNhdGUlMjBBdXRob3JpdHklMjAyMDE0LmNybDB9BggrBgEFBQcBAQRxMG8wbQYIKwYBBQUHMAKGYWh0dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9wa2lvcHMvY2VydHMvTWljcm9zb2Z0JTIwVFBNJTIwUm9vdCUyMENlcnRpZmljYXRlJTIwQXV0aG9yaXR5JTIwMjAxNC5jcnQwDQYJKoZIhvcNAQELBQADggIBAHG-1grb-6xpObMtxfFScl8PRLd_GjLFaeAd0kVPls0jzKplG2Am4O87Qg0OUY0VhQ-uD39590gGrWEWnOmdrVJ-R1lJc1yrIZFEASBEedJSvxw9YTNknD59uXtznIP_4Glk-4NpqpcYov2OkBdV59V4dTL5oWFH0vzkZQfvGFxEHwtB9O6Bh0Lk142zXAh5_vf_-hSw3t9adloBAnA0AtPUVkzmgNRGeTpfPm-Iud-MAoUXaccFn2EChjKb9ApbS1ww8ZvX4x2kFU6qctu32g7Vf6CgACc1i-UYDT_E-h6c1O4n7JK2OxVS-DVwybps-cALU0gj-ZMauNMej0_x_NerzvDuQ77eFMTDMY4ZTzYOzlg4Nj0K8y1Bx_KqeTBO0N9CdEG3dBxWCUUFQzAx-i38xJL-dtYTCCFATVhc9FFJ0CQgU07JAGAeuNm_GL8kN46bMXd_ApQYFzDQUWYYXvRIt9mCw0Zd45lpAMuiDKT9TgjUVDNu8LQ8FPK0KeiQVrGHFMhHgg2pbVH9Pvc1jNEeRpCo0BLpZQwuIgEt90mepkt6Va-C9krHsU4y2oalG2LUu-jOC3NWNK8LssYVUCFWtaKh5d-xdTQmjx4uO-1sq9GFntVJ94QnEDhldz0XMopQ8srTGLMqR3MT-GkSNb5X1UFC-X1udXI8YvB3ADr_Z3B1YkFyZWFZATYAAQALAAYEcgAgnf_L82w4OuaZ-5ho3G3LidcVOIS-KAOSLBJBWL-tIq4AEAAQCAAAAAAAAQC6zY02JuN_qf28iVCISa6d6aUM5sS2PsKvZMO0P_-28lLX_9-xbmbEcTPvCj5aIEqVUfCb07U4qCBBUdaWygAbhAckvzYrACm5I8hjMoGkxMkZLw5kX0SjtHx6VfgksElxnu4DcC2g9pqL_McgddZV0zNGrYNj1iamzoxTyOcYyvZjQv_4gU-t9mEc0uqHHv-H6k23p4mensyaGAhkGTV8odyBxsNpdnR8IPnXWPO7tBDTbk4mg3VtclqLhS0-TCh_QnZ6lcEl27wTE8FjwqVdQG9F1Ouyn-eNAAq0EufbzwjSNpuDrlj-Kj5xY_lS5BMEjQUXqP-U5nzW22TehX8VaGNlcnRJbmZvWKH_VENHgBcAIgALt-OVET9fzihC1dzyG5xG70MVdRkPpSEkWQ0nns4zaYkAFGo6XjXu3JY-wup-EHJYWEuLpb45AAAACMgZxo6-OwT1-cIZwQGjXsp0dUws1gAiAAvzCsernlTAewF0QwNOA-iWpyhGxC-k_xBRjTtGNz9m6gAiAAs54tyczU1aCAh_N3Vy3qcAnC9zGeOxtQQKCe8CAanbbGhhdXRoRGF0YVkBZ-MWwK8fdtoeGn4DEn0TAUu4IUP_PMiBiJd4lDRznbBDRQAAAAAImHBYytxLgbbhMN5Q3L6WACBxLUIzn9ngKAM11_UwWG7kCiAvVyO1mYGSsEhfWeyhDaQBAwM5AQAgWQEAus2NNibjf6n9vIlQiEmunemlDObEtj7Cr2TDtD__tvJS1__fsW5mxHEz7wo-WiBKlVHwm9O1OKggQVHWlsoAG4QHJL82KwApuSPIYzKBpMTJGS8OZF9Eo7R8elX4JLBJcZ7uA3AtoPaai_zHIHXWVdMzRq2DY9Ymps6MU8jnGMr2Y0L_-IFPrfZhHNLqhx7_h-pNt6eJnp7MmhgIZBk1fKHcgcbDaXZ0fCD511jzu7QQ025OJoN1bXJai4UtPkwof0J2epXBJdu8ExPBY8KlXUBvRdTrsp_njQAKtBLn288I0jabg65Y_io-cWP5UuQTBI0FF6j_lOZ81ttk3oV_FSFDAQAB"),
        clientDataJson = new String(
          ByteArray
            .fromBase64Url(
              "eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoia0lnZElRbWFBbXM1NlVOencwREg4dU96M0JERjJVSllhSlA2eklRWDFhOCIsIm9yaWdpbiI6Imh0dHBzOi8vZGV2LmQydXJweXB2cmhiMDV4LmFtcGxpZnlhcHAuY29tIiwiY3Jvc3NPcmlnaW4iOmZhbHNlfQ"
            )
            .getBytes,
          StandardCharsets.UTF_8,
        ),
        rpId = RelyingPartyIdentity
          .builder()
          .id("d2urpypvrhb05x.amplifyapp.com")
          .name("")
          .build(),
        userId = UserIdentity
          .builder()
          .name("foo")
          .displayName("Foo Bar")
          .id(
            ByteArray.fromBase64Url("AAAA")
          )
          .build(),
        attestationRootCertificate = Some(
          CertificateParser.parsePem("MIIF9TCCA92gAwIBAgIQXbYwTgy/J79JuMhpUB5dyzANBgkqhkiG9w0BAQsFADCBjDELMAkGA1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjE2MDQGA1UEAxMtTWljcm9zb2Z0IFRQTSBSb290IENlcnRpZmljYXRlIEF1dGhvcml0eSAyMDE0MB4XDTE0MTIxMDIxMzExOVoXDTM5MTIxMDIxMzkyOFowgYwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xNjA0BgNVBAMTLU1pY3Jvc29mdCBUUE0gUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgMjAxNDCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAJ+n+bnKt/JHIRC/oI/xgkgsYdPzP0gpvduDA2GbRtth+L4WUyoZKGBw7uz5bjjP8Aql4YExyjR3EZQ4LqnZChMpoCofbeDR4MjCE1TGwWghGpS0mM3GtWD9XiME4rE2K0VW3pdN0CLzkYbvZbs2wQTFfE62yNQiDjyHFWAZ4BQH4eWa8wrDMUxIAneUCpU6zCwM+l6Qh4ohX063BHzXlTSTc1fDsiPaKuMMjWjK9vp5UHFPa+dMAWr6OljQZPFIg3aZ4cUfzS9y+n77Hs1NXPBn6E4Db679z4DThIXyoKeZTv1aaWOWl/exsDLGt2mTMTyykVV8uD1eRjYriFpmoRDwJKAEMOfaURarzp7hka9TOElGyD2gOV4Fscr2MxAYCywLmOLzA4VDSYLuKAhPSp7yawET30AvY1HRfMwBxetSqWP2+yZRNYJlHpor5QTuRDgzR+Zej+aWx6rWNYx43kLthozeVJ3QCsD5iEI/OZlmWn5WYf7O8LB/1A7scrYv44FD8ck3Z+hxXpkklAsjJMsHZa9mBqh+VR1AicX4uZG8m16x65ZU2uUpBa3rn8CTNmw17ZHOiuSWJtS9+PrZVA8ljgf4QgA1g6NPOEiLG2fn8Gm+r5Ak+9tqv72KDd2FPBJ7Xx4stYj/WjNPtEUhW4rcLK3ktLfcy6ea7Rocw5y5AgMBAAGjUTBPMAsGA1UdDwQEAwIBhjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBR6jArOL0hiF+KU0a5VwVLscXSkVjAQBgkrBgEEAYI3FQEEAwIBADANBgkqhkiG9w0BAQsFAAOCAgEAW4ioo1+J9VWC0UntSBXcXRm1ePTVamtsxVy/GpP4EmJd3Ub53JzNBfYdgfUL51CppS3ZY6BoagB+DqoA2GbSL+7sFGHBl5ka6FNelrwsH6VVw4xV/8klIjmqOyfatPYsz0sUdZev+reeiGpKVoXrK6BDnUU27/mgPtem5YKWvHB/soofUrLKzZV3WfGdx9zBr8V0xW6vO3CKaqkqU9y6EsQw34n7eJCbEVVQ8VdFd9iV1pmXwaBAfBwkviPTKEP9Cm+zbFIOLr3V3CL9hJj+gkTUuXWlJJ6wVXEG5i4rIbLAV59UrW4LonP+seqvWMJYUFxu/niF0R3fSGM+NU11DtBVkhRZt1u0kFhZqjDz1dWyfT/N7Hke3WsDqUFsBi+8SEw90rWx2aUkLvKo83oU4Mx4na+2I3l9F2a2VNGk4K7l3a00g51miPiq0Da0jqw30PaLluTMTGY5+RnZVh50JD6nk+Ea3wRkU8aiYFnpIxfKBZ72whmYYa/egj9IKeqpR0vuLebbU0fJBf880K1jWD3Z5SFyJXo057Mv0OPw5mttytE585ZIy5JsaRXlsOoWGRXE3kUT/MKR1UoAgR54c8Bsh+9Dq2wqIK9mRn15zvBDeyHG6+czurLopziOUeWokxZN1syrEdKlhFoPYavm6t+PzIcpdxZwHA+V3jLJPfI=")
        ),
      )

    val ValidEs256: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158a449960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f00204ba50777bcdb0749e472452d00783d09e3946fa23f2cb6036b851c9cfa1f4e54a50102032620012158203b20d5b76242f25632daf1eee349c2f5ea2aefbcedd5a422e645ce95d891ec71225820ed953dc6b66c59bc027c82e19f45d5af2969596632ce28fba9bc02072f6fcdbe63666d746374706d6761747453746d74bf63616c67266373696758473045022100bbce3f5c82af4e2e4bce9fe75bea7a153cc884765762da7ba7fdc354c00841110220164dfc8eb26e85b0f9c5015b921653be62853ebd701c9f51b200e15ae4a19065637835638259020630820202308201a7a003020102020212b2300a06082a8648ce3d040302306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30003059301306072a8648ce3d020106082a8648ce3d03010703420004fee4104d866caf972a45fe3c9e50458980bde7c443777237b0e318195a1e20cc128a05114d5f66da1873b2d648aae3f0b81c586300a25fee6439dec4531d5a72a381a63081a33021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f30690603551d110101ff045f305da45b305931573014060567810502010c0b69643a30303030303030303014060567810502030c0b69643a30303030303030303029060567810502020c20544553545f59756269636f5f6a6176612d776562617574686e2d73657276657230130603551d250101ff0409300706056781050803300a06082a8648ce3d0403020349003046022100937b55680c54f4e310b877d7d4920c0ab5cc595d09051c296c9f3d340fc1f552022100d91f3d5e31148826e1136e176189a905467fe99c6dce329e39b332170fedcd1b5901db308201d73082017da00302010202021a1a300a06082a8648ce3d040302306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453059301306072a8648ce3d020106082a8648ce3d030107034200049d957c950587a67f7560d3216a47f6c52c40f01c7b2de5d8250809d73aab814eccd0d77e4288189d905980a1072191925f82649965f2e5e2c5b1803fb5347328a3133011300f0603551d130101ff040530030101ff300a06082a8648ce3d0403020348003045022100ac1ff60cbc9e80c46ae62b51a47cdbbedce65d0aadc11d320543347d3099aab6022024914461e3b580eb737026ffb32969ce0463cf75edda2b96bc6645da8ab843c86863657274496e666f5869ff544347801700000020c18552e578be4f9c30427a963c5fca784031f97126de0c7e560ffd65b20bce65000000000000000011111111222222223300000000000000000022000bb418e5cf50f689f828bdb3fee73d6e8d478674c711c2971f588fb38dbaad537700006376657263322e30677075624172656158570023000b000400000000001000100003001000203b20d5b76242f25632daf1eee349c2f5ea2aefbcedd5a422e645ce95d891ec71002100ed953dc6b66c59bc027c82e19f45d5af2969596632ce28fba9bc02072f6fcdbeffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308193020100301306072a8648ce3d020106082a8648ce3d0301070479307702010104207660425e23b16c9b8618674c1c6279d67dc01f038f12a954a8d0b0b41d761b3da00a06082a8648ce3d030107a144034200043b20d5b76242f25632daf1eee349c2f5ea2aefbcedd5a422e645ce95d891ec71ed953dc6b66c59bc027c82e19f45d5af2969596632ce28fba9bc02072f6fcdbe")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIICAjCCAaegAwIBAgICErIwCgYIKoZIzj0EAwIwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/uQQTYZsr5cqRf48nlBFiYC958RDd3I3sOMYGVoeIMwSigURTV9m2hhzstZIquPwuBxYYwCiX+5kOd7EUx1acqOBpjCBozAhBgsrBgEEAYLlHAEBBAQSBBAAAQIDBAUGBwgJCgsMDQ4PMGkGA1UdEQEB/wRfMF2kWzBZMVcwFAYFZ4EFAgEMC2lkOjAwMDAwMDAwMBQGBWeBBQIDDAtpZDowMDAwMDAwMDApBgVngQUCAgwgVEVTVF9ZdWJpY29famF2YS13ZWJhdXRobi1zZXJ2ZXIwEwYDVR0lAQH/BAkwBwYFZ4EFCAMwCgYIKoZIzj0EAwIDSQAwRgIhAJN7VWgMVPTjELh319SSDAq1zFldCQUcKWyfPTQPwfVSAiEA2R89XjEUiCbhE24XYYmpBUZ/6ZxtzjKeObMyFw/tzRs=",
          "EC",
          "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgzP/U0pW2a4diOrv5m9K2V8+FBO/YMt6y2P5gsqwgGLigCgYIKoZIzj0DAQehRANCAAT+5BBNhmyvlypF/jyeUEWJgL3nxEN3cjew4xgZWh4gzBKKBRFNX2baGHOy1kiq4/C4HFhjAKJf7mQ53sRTHVpy",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIB1zCCAX2gAwIBAgICGhowCgYIKoZIzj0EAwIwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJ2VfJUFh6Z/dWDTIWpH9sUsQPAcey3l2CUICdc6q4FOzNDXfkKIGJ2QWYChByGRkl+CZJll8uXixbGAP7U0cyijEzARMA8GA1UdEwEB/wQFMAMBAf8wCgYIKoZIzj0EAwIDSAAwRQIhAKwf9gy8noDEauYrUaR8277c5l0KrcEdMgVDNH0wmaq2AiAkkURh47WA63NwJv+zKWnOBGPPde3aK5a8ZkXairhDyA==",
          "EC",
          "MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQgM23lz14jimoztDLaGkIUwU1M0nBptdn8U+/f7Lqc5l6gCgYIKoZIzj0DAQehRANCAASdlXyVBYemf3Vg0yFqR/bFLEDwHHst5dglCAnXOquBTszQ135CiBidkFmAoQchkZJfgmSZZfLl4sWxgD+1NHMo",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.ES256,
          attestationMaker = AttestationMaker.tpm(
            AttestationSigner.ca(
              alg = COSEAlgorithmIdentifier.ES256,
              certSubject = new X500Name(Array.empty[RDN]),
              certExtensions = tpmCertExtensions,
            )
          ),
        )
    }
    val ValidEs384: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES384,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158c549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020ba64a3d23cef24334cc7d4c07745fa5a83cfed05c656ddd83a5a64b61715b33ea5010203382220022158305b5d607978a6a706069df8fb997b2fabc049220d675965ca8effe285aaa9a97643c89cc4a595165663f9a958ba5a722b2258303af880a2b7668261c92c070394e517b00ac7991b52848feb8a9bc936d5e9d06471d2c4edea5937324aba9e9047b8654063666d746374706d6761747453746d74bf63616c6738226373696758673065023100c25740fc43cc97687b4c450456885ce21df6ec45fa41682bb64b7f8196f66ef554e6f62e4ddfc084fbc7d83876a8c624023042c8a0a2146aedb0ab493e7f9ef50d93ddae2eac4895dd4f59de16b787cf5747b42bdae5c39cb8b3f698d7fd48bca95263783563825902413082023d308201c4a00302010202020469300a06082a8648ce3d040303306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a30003076301006072a8648ce3d020106052b81040022036200047b6946084762e55c3d921dfc3dcb466e8b49c00df8ee0a794c0005c24c37fb64ac82cdbb1263b7a9b644f9d1d03f4e568af99d245c61ed317e559950686210fcd01b596f4dfb249e0664a96a73884190f3ffb47710b88728386fb84800f51a97a381a63081a33021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f30690603551d110101ff045f305da45b305931573014060567810502010c0b69643a30303030303030303014060567810502030c0b69643a30303030303030303029060567810502020c20544553545f59756269636f5f6a6176612d776562617574686e2d73657276657230130603551d250101ff0409300706056781050803300a06082a8648ce3d0403030367003064023046958ad5fc19260b2a62fec767b6669054fd7d2a392953c0593a72924be0d70cdc168071f750fd5a68037fe11da8507d0230162a11b4e3605de4f4bac6c9cfba2f51c28280859788d6a92583c1a8f5a72a4092cd8e523298550105643ad4a1dab5bd590219308202153082019aa0030201020202099c300a06082a8648ce3d040303306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b30090603550406130253453076301006072a8648ce3d020106052b810400220362000402ef421a687384c2cc1719570d2d11d8be506e67841a8e893706cbb700f2312a1b4900fda578a927de59a7b6cd0a7fb540a336a03734307e2b8aed380826754a170575eb705e466c704e50a52eabaa1815761b85c995479e8371ed554c6a549aa3133011300f0603551d130101ff040530030101ff300a06082a8648ce3d0403030369003066023100e4c8f4f7ad6d1c74cbbbdc1da11061ba46fcf49aef01f465f324db8e2fe0e32de69c1d5de20eeb3f3d1e366c98b113bc023100ee69b5cf545a56ba343fb2a9f22a3cdc934f2f38574091a8b28db96e0bcb8f0413259347097c6f37870780ab1ad7d2156863657274496e666f5889ff544347801700000030195a7269268dc231b13139b0116973364984bc22956b5a77d3505bdbd04946a77492fdc30198599beefc9ab73234cf31000000000000000011111111222222223300000000000000000032000c68b9c0508642ec9bd644425a23f6ce911fa6bf3a1af3f473cf90a38038ad7824b7ae0e6a653a475d349affd9e1be5a9200006376657263322e30677075624172656158760023000c000400000000001000100004001000305b5d607978a6a706069df8fb997b2fabc049220d675965ca8effe285aaa9a97643c89cc4a595165663f9a958ba5a722b00303af880a2b7668261c92c070394e517b00ac7991b52848feb8a9bc936d5e9d06471d2c4edea5937324aba9e9047b86540ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("3081bf020100301006072a8648ce3d020106052b810400220481a73081a4020101043031b5ed68c23d09ef553b053a723f654b08069a1bc38f6e061860dd07197ebf6fb7df1711ee2d8954d2921519e2f2220ba00706052b81040022a164036200045b5d607978a6a706069df8fb997b2fabc049220d675965ca8effe285aaa9a97643c89cc4a595165663f9a958ba5a722b3af880a2b7668261c92c070394e517b00ac7991b52848feb8a9bc936d5e9d06471d2c4edea5937324aba9e9047b86540")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIICPTCCAcSgAwIBAgICBGkwCgYIKoZIzj0EAwMwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjAAMHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEe2lGCEdi5Vw9kh38PctGbotJwA347gp5TAAFwkw3+2Ssgs27EmO3qbZE+dHQP05WivmdJFxh7TF+VZlQaGIQ/NAbWW9N+ySeBmSpanOIQZDz/7R3ELiHKDhvuEgA9RqXo4GmMIGjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8waQYDVR0RAQH/BF8wXaRbMFkxVzAUBgVngQUCAQwLaWQ6MDAwMDAwMDAwFAYFZ4EFAgMMC2lkOjAwMDAwMDAwMCkGBWeBBQICDCBURVNUX1l1Ymljb19qYXZhLXdlYmF1dGhuLXNlcnZlcjATBgNVHSUBAf8ECTAHBgVngQUIAzAKBggqhkjOPQQDAwNnADBkAjBGlYrV/BkmCypi/sdntmaQVP19KjkpU8BZOnKSS+DXDNwWgHH3UP1aaAN/4R2oUH0CMBYqEbTjYF3k9LrGyc+6L1HCgoCFl4jWqSWDwaj1pypAks2OUjKYVQEFZDrUodq1vQ==",
          "EC",
          "MIG/AgEAMBAGByqGSM49AgEGBSuBBAAiBIGnMIGkAgEBBDAZb9xZRaxukSkUc9DxDx9bEzIt3MVPbHKNw1Q3A8icRIcwZAV48zOeoWSEIiO7bmugBwYFK4EEACKhZANiAAR7aUYIR2LlXD2SHfw9y0Zui0nADfjuCnlMAAXCTDf7ZKyCzbsSY7eptkT50dA/TlaK+Z0kXGHtMX5VmVBoYhD80BtZb037JJ4GZKlqc4hBkPP/tHcQuIcoOG+4SAD1Gpc=",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIICFTCCAZqgAwIBAgICCZwwCgYIKoZIzj0EAwMwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTB2MBAGByqGSM49AgEGBSuBBAAiA2IABALvQhpoc4TCzBcZVw0tEdi+UG5nhBqOiTcGy7cA8jEqG0kA/aV4qSfeWae2zQp/tUCjNqA3NDB+K4rtOAgmdUoXBXXrcF5GbHBOUKUuq6oYFXYbhcmVR56Dce1VTGpUmqMTMBEwDwYDVR0TAQH/BAUwAwEB/zAKBggqhkjOPQQDAwNpADBmAjEA5Mj0961tHHTLu9wdoRBhukb89JrvAfRl8yTbji/g4y3mnB1d4g7rPz0eNmyYsRO8AjEA7mm1z1RaVro0P7Kp8io83JNPLzhXQJGoso25bgvLjwQTJZNHCXxvN4cHgKsa19IV",
          "EC",
          "MIG/AgEAMBAGByqGSM49AgEGBSuBBAAiBIGnMIGkAgEBBDC0yTOXQkL9UVCkqhnQnrcDz0Lhq7MyG9JcBiy2CI+82SXQJmRWUlj8kAoyQ2J5qvagBwYFK4EEACKhZANiAAQC70IaaHOEwswXGVcNLRHYvlBuZ4Qajok3Bsu3APIxKhtJAP2leKkn3lmnts0Kf7VAozagNzQwfiuK7TgIJnVKFwV163BeRmxwTlClLquqGBV2G4XJlUeeg3HtVUxqVJo=",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.ES384,
          attestationMaker = AttestationMaker.tpm(
            AttestationSigner.ca(
              alg = COSEAlgorithmIdentifier.ES384,
              certSubject = new X500Name(Array.empty[RDN]),
              certExtensions = tpmCertExtensions,
            )
          ),
        )
    }
    val ValidEs512: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.ES512,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746158e949960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f0020f24b6c18dad993c043e8bca98c466d602b011332e3497c5293ab00f11607a96da50102033823200321584201f3895d6d36dbd789e9836d069a91e94876bf2f50b3537eef21229fe9b278172be2fd693e8a619d75ba6a0e9428149eda716eb68c7fdcdfaa9dc450ac342c0902f422584200d952ce99778ceb86ef5b26185789d17df0562595c2424cedefb24352e0ba09ba9fd1e52a0b99b25bf80cd509bc2f0fa7f3324507058032e8d6eb0494972addb44063666d746374706d6761747453746d74bf63616c67382363736967588a308187024151efde3ed5d6fefb16e51d076b365a90ea302585faf92e0083f6505fdc46fccbce414676440733da36df515303ef76580125d0da69d757e7f4036e506167d6b84b0242018c8d65f68f7e1c5a38239cfee8fd88e9abf20628f349bb62f12f5f362dc9039c077139a5f083ac34fae9315f0456497b1af7328f9c138ca94cb4df813417cb545c637835638259028b30820287308201eaa00302010202021528300a06082a8648ce3d040304306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a300030819b301006072a8648ce3d020106052b8104002303818600040016b1ebf22c294a4a62092508a19cdbd4ca58e66e7a0125b9c59b10da194b69e939922b63b1903f9eb2a744fb82582ed6f17b2c4f9036aaf8ca3a5d6d3fd60c100301cf35805517cd1b5f98849c90a4ce4e5a0fc4dd61fedef2fb99c8cdea04ab5bf7f6d01877364d9ae8046096c71271fdd928f826b24b510d81333f5f64ad0a8d6629a381a63081a33021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f30690603551d110101ff045f305da45b305931573014060567810502010c0b69643a30303030303030303014060567810502030c0b69643a30303030303030303029060567810502020c20544553545f59756269636f5f6a6176612d776562617574686e2d73657276657230130603551d250101ff0409300706056781050803300a06082a8648ce3d04030403818a0030818602416db6495537bbe31113ce6fc707477bd4a7b9207e099b68e14f03f549def3d171a33c37d2281b046e8009354f4e267b60f5c5eb4ef4c2adeeb526d6aa00283d37d50241245df418b75d4c31dc026585ff53a0fc039e387978d996a81f51afb1697d92d9e7e8a2431ea9e063f8c4af35c3660d478cd9e8285057b6c98e9c5ec47e7fd0a70a5902623082025e308201c0a003020102020221bb300a06082a8648ce3d040304306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b300906035504061302534530819b301006072a8648ce3d020106052b8104002303818600040052d9b121c847b6ac9432ced565d863e4efed1d9ef7e95903ecc4f5dde0bd2ebe5ec54bee60d54de75f457f241c6d92ea39b42f6f188365bd606c07c66f102cb4f60186c816e16b72481b7ad370069f82765c042cb3f9ba503affd376a2a99a6ce114e3bd2b8fd09c649eda1311c0c40baa6d25d97a13eb1e041ca03c4ce498131a7976a3133011300f0603551d130101ff040530030101ff300a06082a8648ce3d04030403818b00308187024130f07431cfcdcafd7fc357d0d7689a0f030c859c2d9c86a196476a4d7360d668b3fcdc26453c6cb963d54a9bee3bbd62358753f0c88c9504749b19a4b846a92fcf024201373abfa5c71c47b4b5f4fbd64d44273ed85a192447c6eca0e3f506868c5b317141b3182975353c65c45ee90dfc65aaa09e210190d35eb56ecd4f5593fc1b36c2886863657274496e666f58a9ff544347801700000040302269d22180e0485672fd616d14833f68575c4f9821e5f88c96866bc2d12219001a809c3fed3636c08b454a56703275289b912a25c647da8e18826e60267733000000000000000011111111222222223300000000000000000042000d2b46abf13d16a2e40d5dd76ccaa6f9ac4f051bf2c040cc3effb86ffed66556903fde2e70162c5aa89abade483b2a1843f2a7b7cae4969a242880b7d46a2b41e200006376657263322e306770756241726561589a0023000d0004000000000010001000050010004201f3895d6d36dbd789e9836d069a91e94876bf2f50b3537eef21229fe9b278172be2fd693e8a619d75ba6a0e9428149eda716eb68c7fdcdfaa9dc450ac342c0902f4004200d952ce99778ceb86ef5b26185789d17df0562595c2424cedefb24352e0ba09ba9fd1e52a0b99b25bf80cd509bc2f0fa7f3324507058032e8d6eb0494972addb440ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("3081f7020100301006072a8648ce3d020106052b810400230481df3081dc020101044201a3c355e4920f3fb144732a5d93322ff10777467f64a4fff60507225c4576bf67174c69e0d443e982b7b0c0726d248b8511a071548be473e6e3b237116cea537ccda00706052b81040023a18189038186000401f3895d6d36dbd789e9836d069a91e94876bf2f50b3537eef21229fe9b278172be2fd693e8a619d75ba6a0e9428149eda716eb68c7fdcdfaa9dc450ac342c0902f400d952ce99778ceb86ef5b26185789d17df0562595c2424cedefb24352e0ba09ba9fd1e52a0b99b25bf80cd509bc2f0fa7f3324507058032e8d6eb0494972addb440")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIChzCCAeqgAwIBAgICFSgwCgYIKoZIzj0EAwQwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjAAMIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQAFrHr8iwpSkpiCSUIoZzb1MpY5m56ASW5xZsQ2hlLaek5kitjsZA/nrKnRPuCWC7W8XssT5A2qvjKOl1tP9YMEAMBzzWAVRfNG1+YhJyQpM5OWg/E3WH+3vL7mcjN6gSrW/f20Bh3Nk2a6ARglscScf3ZKPgmsktRDYEzP19krQqNZimjgaYwgaMwIQYLKwYBBAGC5RwBAQQEEgQQAAECAwQFBgcICQoLDA0ODzBpBgNVHREBAf8EXzBdpFswWTFXMBQGBWeBBQIBDAtpZDowMDAwMDAwMDAUBgVngQUCAwwLaWQ6MDAwMDAwMDAwKQYFZ4EFAgIMIFRFU1RfWXViaWNvX2phdmEtd2ViYXV0aG4tc2VydmVyMBMGA1UdJQEB/wQJMAcGBWeBBQgDMAoGCCqGSM49BAMEA4GKADCBhgJBbbZJVTe74xETzm/HB0d71Ke5IH4Jm2jhTwP1Sd7z0XGjPDfSKBsEboAJNU9OJntg9cXrTvTCre61JtaqACg9N9UCQSRd9Bi3XUwx3AJlhf9ToPwDnjh5eNmWqB9Rr7FpfZLZ5+iiQx6p4GP4xK81w2YNR4zZ6ChQV7bJjpxexH5/0KcK",
          "EC",
          "MIH3AgEAMBAGByqGSM49AgEGBSuBBAAjBIHfMIHcAgEBBEIA2IorORYB75tWAa1vGmUrIDa73QfrZCKwAqO9sFKYCj+UE0sSX5Yop8sYau7U7TLCPch7dsuiRRSYefh6Y9PA3u2gBwYFK4EEACOhgYkDgYYABAAWsevyLClKSmIJJQihnNvUyljmbnoBJbnFmxDaGUtp6TmSK2OxkD+esqdE+4JYLtbxeyxPkDaq+Mo6XW0/1gwQAwHPNYBVF80bX5iEnJCkzk5aD8TdYf7e8vuZyM3qBKtb9/bQGHc2TZroBGCWxxJx/dko+CayS1ENgTM/X2StCo1mKQ==",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIICXjCCAcCgAwIBAgICIbswCgYIKoZIzj0EAwQwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCBmzAQBgcqhkjOPQIBBgUrgQQAIwOBhgAEAFLZsSHIR7aslDLO1WXYY+Tv7R2e9+lZA+zE9d3gvS6+XsVL7mDVTedfRX8kHG2S6jm0L28Yg2W9YGwHxm8QLLT2AYbIFuFrckgbetNwBp+CdlwELLP5ulA6/9N2oqmabOEU470rj9CcZJ7aExHAxAuqbSXZehPrHgQcoDxM5JgTGnl2oxMwETAPBgNVHRMBAf8EBTADAQH/MAoGCCqGSM49BAMEA4GLADCBhwJBMPB0Mc/Nyv1/w1fQ12iaDwMMhZwtnIahlkdqTXNg1miz/NwmRTxsuWPVSpvuO71iNYdT8MiMlQR0mxmkuEapL88CQgE3Or+lxxxHtLX0+9ZNRCc+2FoZJEfG7KDj9QaGjFsxcUGzGCl1NTxlxF7pDfxlqqCeIQGQ0161bs1PVZP8GzbCiA==",
          "EC",
          "MIH3AgEAMBAGByqGSM49AgEGBSuBBAAjBIHfMIHcAgEBBEIBH6QXnTBYT/m2fGSf89i9z1PvzG80y8JSVZi9BXBor5V9lsvrhTQGp5YNc6HtkUpmqfu30RllBppic6jAzwnBclSgBwYFK4EEACOhgYkDgYYABABS2bEhyEe2rJQyztVl2GPk7+0dnvfpWQPsxPXd4L0uvl7FS+5g1U3nX0V/JBxtkuo5tC9vGINlvWBsB8ZvECy09gGGyBbha3JIG3rTcAafgnZcBCyz+bpQOv/TdqKpmmzhFOO9K4/QnGSe2hMRwMQLqm0l2XoT6x4EHKA8TOSYExp5dg==",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.ES512,
          attestationMaker = AttestationMaker.tpm(
            AttestationSigner.ca(
              alg = COSEAlgorithmIdentifier.ES512,
              certSubject = new X500Name(Array.empty[RDN]),
              certExtensions = tpmCertExtensions,
            )
          ),
        )
    }

    val ValidRs256: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.RS256,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746159016849960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f002007bdca7ffc3f53dc8b02deffaa4798ba2c7a21eeb2f47f186829ef825bd06c48a4010303390100205901010087ffcd54a9763897fa951c30e00fd39aca161f9d5bee8cc6b5cb410603adb6ccda7ac447acf5cd8a40dc3c3d8f463e1ef5dd1522d2f57350fb9a4cfe5aa977e63abafa480e3d8f1f357284882e91dd7ec0ff5e22fe79703c0121682a5015df589a0c2af526c4a8ee700cc98142c437b0105dc226b672aab44b09bcecf273fae4173f75ac6c5b8c9b417446e9a339977d8f54cdb3e39cdf5cb0cc78439c55bbd3601e61ed99ae2d6a5707d40d10661aecc765142b006bf6fd0d0a214433f84f66b50397f306a541f71c340cc0b80d71771a6c3ccbdc27dd9a90c7681f972771e3cdeea08193d98a7c25ab53e92d91c465074700b09088a68127c424a2f9dc1027214301000163666d746374706d6761747453746d74bf63616c67390100637369675901004cff0e000761d22cdc6ae0aec28fb4e0727b45cc5cd7d162c7f1008f919ca8df2d437829130acda6a55c96d9fe2edbb4669ad09302c40a979bb1d8c51ea9a4339cbab82cf981039433bea04096ce3ba637426f68e0de5a2df1229ababa935043ac2cfdc5a8c74018bf3c84c073497403bff8c7c654087b690944df98c79e86be66c012a9af01440ae78b044f90bacd33841aa06426b3a159eaa90882d8e471ddf42bdafe7ce4349d04bec8cfbc451f6b62721e82fc1dec09337f9342aca3adb3ce6ceb7265647a712390319faa80e5130a28622b923ede9b0d9862cc3d8a46d000f7b416ccd7a1f67607d3d2aa730604cb4e827a981ce7246bc07f4339e87d8763783563825903913082038d30820275a00302010202020810300d06092a864886f70d01010b0500306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a300030820122300d06092a864886f70d01010105000382010f003082010a02820101008830d398bc44b894cf3ec4e4ff835284906e9af9df1b343888cbcc18916853a54d49b9424e91aa108dee96e61fafc1392fe4fefe005905aba406b1ccb6f32bb9cd932c3baa56568ab38a5555c3229b08a6e6406fdf18e34692b9bd8d54adad6c04d2b375a46cb5cb1502c0a92515787f5c69b4db92ebe5402260845575546788a278248bcde3cc70bf7c0cba0da8b6e1ca48ceb98333e27beac93b68ee17d11a9ade8b3153bb9ee57c9ab893503bfbfb765ce1ac05a64a9bf8b3280bf739869b3ca10fb7b4e52ceeae2a3a15bbddfc372ca4e82d1874f50815f8f940a09bf733df7c9c0e4887e7c4fe871eb45cef94d9544d78594eaace95c245660321806f5b0203010001a381a63081a33021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f30690603551d110101ff045f305da45b305931573014060567810502010c0b69643a30303030303030303014060567810502030c0b69643a30303030303030303029060567810502020c20544553545f59756269636f5f6a6176612d776562617574686e2d73657276657230130603551d250101ff0409300706056781050803300d06092a864886f70d01010b050003820101000dc5b21c713a09e9eeba1e0ad56d839976c8468ac0759cf2891b1bc439fe6857a6ec4ee327b717ab67bb1085de4f433f30d6b4a664975eb509c981ec2105ce9f6dbef1f9b392e9fd1d2a1bee185803f9ca5fa0fbbfddf41d0df369b39532c2465f53b12c4ec00ec180604b1b61982a913a72b2099e09fc71b4b395b1c1432b8b9f540761eae7b15b7d0c65cc0641d32207ac6e6f7f33073b5e62efecf6ed07487c8cb000640c018df760ff72588efcead5328506b5ea270b90666fdc3bf077cd5492a61d10389d44c5d31850c024dc886349e9a7e998058956f877fc162c5389086629f434cabd7b57f2e1bd3d1637676dceb8e66c1d0fca46d9e9b02e964463590367308203633082024ba00302010202020514300d06092a864886f70d01010b0500306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b300906035504061302534530820122300d06092a864886f70d01010105000382010f003082010a028201010098aff2d0259ef6f996989af530238a6ab15f6536168050bbd08e28bdb2fd7dba7fefb79e733255f8e7b6c32b7dbacac7a1611bd0c705f53a463f55ef4e0f0bf4153f46ae2c63acb1f74d2389159b9020ea8fb344d5e2af18f33fe4d6d6be84d775130773d836e25706113c99e604bd45e8a1710674e943326d52053b6372e753eddfef380dab1ce440fa1c77fa02aa4b5dbbcfd2a4679497a8c6c450b468b168725345e81dcf37f3c41c7d3a0c20e1f8e806725fbe7a3af4fd135c8f90cd30d81c3bdda15b8c20e007ae48ddb8aece5f8526c9a78d44d607f81f8f214f84226be8400050d277305eac2a088a27f8382a415e77c13e6aba9ca79494aca45ad29f0203010001a3133011300f0603551d130101ff040530030101ff300d06092a864886f70d01010b05000382010100817e70d6eda767e160b7883531bcf5dc09ec405f8a1ab222673b9631898dd249fec7ecd616bddf812315c8bfcb361cb88931a6a38041da7c2e88be1cfee341cacd079101de6ccb9cf1ddca88e82cba89bd29591313ba3681195d850e06922f6691c3a74acfde6de30bf1a63faa10d4a5b5b97bc537cf34abdd2e66f295fc1e93d987a5d0b38b1ebf1668f494e46054e89ebe0b420c6238fe645eb87779cdede7470c5fb7111a75cc143391f528bd49878eb86e0618c3c3b89856d2cbaf4745c1bd598625b0fb94902ece3516b52604a5fad04e79210790dd69acf08855ce4f6f2392f24d1484bd7d194a158c8d608acd06cb0f056fbaa6caacafd3e6b0ef7fcd6863657274496e666f5869ff5443478017000000208c4aae34ac9284f203ee6bf5f5e8900ffa5d9389ea351bb8234ffffbb894c09f000000000000000011111111222222223300000000000000000022000b9cf8d6842ad9d92c115b71017e2ca26f4c7b878ad5bd1efd7bdf342060e77bfa00006376657263322e3067707562417265615901170001000b0004000000000010001408000001000101010087ffcd54a9763897fa951c30e00fd39aca161f9d5bee8cc6b5cb410603adb6ccda7ac447acf5cd8a40dc3c3d8f463e1ef5dd1522d2f57350fb9a4cfe5aa977e63abafa480e3d8f1f357284882e91dd7ec0ff5e22fe79703c0121682a5015df589a0c2af526c4a8ee700cc98142c437b0105dc226b672aab44b09bcecf273fae4173f75ac6c5b8c9b417446e9a339977d8f54cdb3e39cdf5cb0cc78439c55bbd3601e61ed99ae2d6a5707d40d10661aecc765142b006bf6fd0d0a214433f84f66b50397f306a541f71c340cc0b80d71771a6c3ccbdc27dd9a90c7681f972771e3cdeea08193d98a7c25ab53e92d91c465074700b09088a68127c424a2f9dc1027ffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308204bd020100300d06092a864886f70d0101010500048204a7308204a3020100028201010087ffcd54a9763897fa951c30e00fd39aca161f9d5bee8cc6b5cb410603adb6ccda7ac447acf5cd8a40dc3c3d8f463e1ef5dd1522d2f57350fb9a4cfe5aa977e63abafa480e3d8f1f357284882e91dd7ec0ff5e22fe79703c0121682a5015df589a0c2af526c4a8ee700cc98142c437b0105dc226b672aab44b09bcecf273fae4173f75ac6c5b8c9b417446e9a339977d8f54cdb3e39cdf5cb0cc78439c55bbd3601e61ed99ae2d6a5707d40d10661aecc765142b006bf6fd0d0a214433f84f66b50397f306a541f71c340cc0b80d71771a6c3ccbdc27dd9a90c7681f972771e3cdeea08193d98a7c25ab53e92d91c465074700b09088a68127c424a2f9dc102702030100010282010062af108c8566fe8bf14dafa61b8000790a78e139eb127f5e555e0671d9cb7ca0cb4c580ef6876a3d0ef18058df150650aaf160bbe33e2e0e2e73f9b87b8b0b30a99f31ab8581cfcfc295b56ba7f73a3516d076bb87d210c9c9bc36fcb51e19f20dde1471cd4ed8922406735573603454729bc61d1738bf7b92139fde83d3fad1e2284b75bb613abe34e7b640eccbe2b9fe59a818b02c9b6fa50a4aa2f125626200746810995a02fe3d05a785d11c612314ea47343a02dcde420e34501911d97c3c9da41084d9d865ab719b44ca70e596e41ab8254a73dd0adadfaa70b76f0648cff3017cecbb16e7a289e859e34b2a7c04852c567ba84d1fc5e3d398f72cc40102818100e110ce79365dc443d43d7bd76babe21788b68cebbfc8afcf9c41ffbf8ce7976318b1d2dcc8a9dc5659241621dadac4ed5c9381289a9b49c0935b6d89f7ab182814b5b7a5a3b3b3d823d6d7440f6390a0c4ff1ff3856d1c247d187f8c33f5836c26332cd3790bbb767c48e1d83f90a96dfe472b10551c3b5359032967985fb227028181009ab1175270a0347e6cb97f5a3a74c5463cc6846cfd4e06d777faff95e2a693cf749ffb6e277c0c840b3816c4420c69f7917686e0d23fd07969fce0207773f4bbf6b091a01855d53432782490b68590117861b70ae51c29abe8e4f9e01aced95f11957883be28860c636907a55d1bd595b4c5ab59088d94a286e7e7ab9e0172010281803a01b5e581c09b040c60a8597633bfbae70e7db589217546a1f454b10ee4e59cb1d1ab122259bd23382857d7f3eb2c942ca70bc3e64d1dae178c99e7d44071a26aec06e017180ac32b41850bd2978bc013e5d95b4f4936d6a4b33ab46cf3db227599fcf4a81f00fae1bf7b0ddc1c31bedaa9870cd792c62b8e26857660cc51430281802f8d54b000f31e6fe698372fd35c65f02b6a92f6b5ff30573808ae5cb2e9a5f255d58002e29c5d7491c652294e6c667eb5f68b8bbcd5e50e0da8b0750a8358ae172d3bf6ccc445dfdfcbd2e1b159e9699569e44cb3152f322b4b880c7df12c1cef58d54d1a3d76c7841f9b3c181d2050fedaeccb57b7be03201955bc09bc4401028181008052d596595fcb6ecd5f29f86874bcb4830566485a9a059c2ecec1d085775b33ed96da7d32a8d8edc1bebf820d9fc56d308ec91b5433331f3dde784172912c4520c695ea741693cdf1f365c43b06b0cbc508d9b9b93ed96d4c49fef32618e445ae0f98cd599c15e1871e4d62e44708118433aadcbb76e55bf053f3dbfb3c1479")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDjTCCAnWgAwIBAgICCBAwDQYJKoZIhvcNAQELBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjAAMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAiDDTmLxEuJTPPsTk/4NShJBumvnfGzQ4iMvMGJFoU6VNSblCTpGqEI3uluYfr8E5L+T+/gBZBaukBrHMtvMruc2TLDuqVlaKs4pVVcMimwim5kBv3xjjRpK5vY1Ura1sBNKzdaRstcsVAsCpJRV4f1xptNuS6+VAImCEVXVUZ4iieCSLzePMcL98DLoNqLbhykjOuYMz4nvqyTto7hfRGpreizFTu57lfJq4k1A7+/t2XOGsBaZKm/izKAv3OYabPKEPt7TlLO6uKjoVu938Nyyk6C0YdPUIFfj5QKCb9zPffJwOSIfnxP6HHrRc75TZVE14WU6qzpXCRWYDIYBvWwIDAQABo4GmMIGjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8waQYDVR0RAQH/BF8wXaRbMFkxVzAUBgVngQUCAQwLaWQ6MDAwMDAwMDAwFAYFZ4EFAgMMC2lkOjAwMDAwMDAwMCkGBWeBBQICDCBURVNUX1l1Ymljb19qYXZhLXdlYmF1dGhuLXNlcnZlcjATBgNVHSUBAf8ECTAHBgVngQUIAzANBgkqhkiG9w0BAQsFAAOCAQEADcWyHHE6Cenuuh4K1W2DmXbIRorAdZzyiRsbxDn+aFem7E7jJ7cXq2e7EIXeT0M/MNa0pmSXXrUJyYHsIQXOn22+8fmzkun9HSob7hhYA/nKX6D7v930HQ3zabOVMsJGX1OxLE7ADsGAYEsbYZgqkTpysgmeCfxxtLOVscFDK4ufVAdh6uexW30MZcwGQdMiB6xub38zBzteYu/s9u0HSHyMsABkDAGN92D/cliO/OrVMoUGteonC5Bmb9w78HfNVJKmHRA4nUTF0xhQwCTciGNJ6afpmAWJVvh3/BYsU4kIZin0NMq9e1fy4b09Fjdnbc645mwdD8pG2emwLpZEYw==",
          "RSA",
          "MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCIMNOYvES4lM8+xOT/g1KEkG6a+d8bNDiIy8wYkWhTpU1JuUJOkaoQje6W5h+vwTkv5P7+AFkFq6QGscy28yu5zZMsO6pWVoqzilVVwyKbCKbmQG/fGONGkrm9jVStrWwE0rN1pGy1yxUCwKklFXh/XGm025Lr5UAiYIRVdVRniKJ4JIvN48xwv3wMug2otuHKSM65gzPie+rJO2juF9Eamt6LMVO7nuV8mriTUDv7+3Zc4awFpkqb+LMoC/c5hps8oQ+3tOUs7q4qOhW73fw3LKToLRh09QgV+PlAoJv3M998nA5Ih+fE/ocetFzvlNlUTXhZTqrOlcJFZgMhgG9bAgMBAAECggEAHx8JO13KVmOq+C0GJ11a/fADVmbDFPRZ9uibOwH/VR3xC2fKPyoKMr48Rz9O/lqpNsidfG2X6jPOx7jZjvUCiPLxLqpzwkcEawKxfWeaANN5UCRpbBHD3dyplSc2snlutatwVvG75c8Cfh6IiHDfmDsF7M5ARKeegDyOAPlO0FmSo2Om+lI4avvTGfp6zVxGXTboI/lE0HqP5uDf5ZNC6Wksm5PMvjWVnUSEwLql/0dXC/DRTsxbuXJBXtp4QXOcHCIE3BVwWEmCDDTUGg8zwmaZLI7wf/cs0owivmM36enoVEiuMbRA3EWPLyS+AHn+N2Vj+HPEx8/+5qFWEOXkAQKBgQDWHt+wmAfE+JbQnY0IaifvFQIRJUO+/mlnd1hfgD63nSGass0HD6uKhTyWPMsGQ4aCUHzLYDnmgNfbMEzXhP4wMTk0xBOES3ddtxvnRuhzERNKkCWnkY4aYdHiA3vi3aAxD3OAxlVdG+mp9e758IalG3x93QWU2l6XFG1/XsG/PQKBgQCi0/cA/RY9H76VLmWN3MvgOJrjaQKWo4k1ErGwtBWsJTLfHU7S7Y1F25IQvnZTXODhHtugGxH0asCooe/1p7+1KyoGvqsDG43WpIEvS+CDYLmzuc4OLAXjsP2zgN7fKoDFboI4RXAJSLLA6G4wCQnZqxRW94DtjQXSvHQx8dtSdwKBgClQOa7UFqOtp0PHMmAOQ3hA4G44d3LRmbrJ7zY2A2PgIIy9tQuIvXtzq7X9MtsZikl4iCuhfGp6L6vuDNWEpprb1ILW1kEvYm+lle+w4cbZ45P+bhV/4yA6AYoPTAcA5hixN4MAQZY+fX46oop9Gy2eOQ376EjJPXj/CwWJXe6tAoGAI5NqYWXqqPo5msCjYaZ/SQM1HEDCVwVuIhFuj2wZXB5YihUONtm+RygdNtlWYwpk++rRE582gg+c/ns7QZIgOcYvjX+1P52SlPYmX54VdL76dAFBuyj1NHVkSQb8KwhPUFO/0emh+/VNUQa3pHklFNDjRckX+08XmZ6hSJROVisCgYAVWimW0WLbg1FQ04ub1dwmOLbUTIdiEpP74ZJQYJAUn1upinvEy/+grB5VHlX5zoLGSL5OkL/VRcOJFKlb6TDkHRg6u4KJv4XVBLFPq0HOFQeRWxRglFFdfD+P6r6YpTRzvgwLRNVD2r9NteCc/KB5yQqG5kHFDX6ECG/s6u+yDg==",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDYzCCAkugAwIBAgICBRQwDQYJKoZIhvcNAQELBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJiv8tAlnvb5lpia9TAjimqxX2U2FoBQu9COKL2y/X26f++3nnMyVfjntsMrfbrKx6FhG9DHBfU6Rj9V704PC/QVP0auLGOssfdNI4kVm5Ag6o+zRNXirxjzP+TW1r6E13UTB3PYNuJXBhE8meYEvUXooXEGdOlDMm1SBTtjcudT7d/vOA2rHORA+hx3+gKqS127z9KkZ5SXqMbEULRosWhyU0XoHc8388QcfToMIOH46AZyX756OvT9E1yPkM0w2Bw73aFbjCDgB65I3biuzl+FJsmnjUTWB/gfjyFPhCJr6EAAUNJ3MF6sKgiKJ/g4KkFed8E+arqcp5SUrKRa0p8CAwEAAaMTMBEwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAgX5w1u2nZ+Fgt4g1Mbz13AnsQF+KGrIiZzuWMYmN0kn+x+zWFr3fgSMVyL/LNhy4iTGmo4BB2nwuiL4c/uNBys0HkQHebMuc8d3KiOgsuom9KVkTE7o2gRldhQ4Gki9mkcOnSs/ebeML8aY/qhDUpbW5e8U3zzSr3S5m8pX8HpPZh6XQs4sevxZo9JTkYFTonr4LQgxiOP5kXrh3ec3t50cMX7cRGnXMFDOR9Si9SYeOuG4GGMPDuJhW0suvR0XBvVmGJbD7lJAuzjUWtSYEpfrQTnkhB5DdaazwiFXOT28jkvJNFIS9fRlKFYyNYIrNBssPBW+6psqsr9PmsO9/zQ==",
          "RSA",
          "MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCYr/LQJZ72+ZaYmvUwI4pqsV9lNhaAULvQjii9sv19un/vt55zMlX457bDK326ysehYRvQxwX1OkY/Ve9ODwv0FT9GrixjrLH3TSOJFZuQIOqPs0TV4q8Y8z/k1ta+hNd1Ewdz2DbiVwYRPJnmBL1F6KFxBnTpQzJtUgU7Y3LnU+3f7zgNqxzkQPocd/oCqktdu8/SpGeUl6jGxFC0aLFoclNF6B3PN/PEHH06DCDh+OgGcl++ejr0/RNcj5DNMNgcO92hW4wg4AeuSN24rs5fhSbJp41E1gf4H48hT4Qia+hAAFDSdzBerCoIiif4OCpBXnfBPmq6nKeUlKykWtKfAgMBAAECggEAKi7iDHN4WY9W9c5J0wTept9eFZ491TF40gOUaeRbeDLgSaAXHIhZjCyoJ3+KeuKvCHzFrIZvtPJmmfTp6kzp5oNAOgzAosEBYetj1+mqUsVlSFIkwFqiOWhqzJQ2O+iDhgq90ll3wEx+lqCBfDTu/bNpdspr3k38TouMen3dLt9p3btvpfLJmwTfJJ6/gEFcUjS0pOkFAICEkaNVaeyxFFlGrpEhdehkizFSUqLAo58rzXZMrjvSsA6zf7pZ2eD5S7Uuh3Kn00wwoV6SXHJggBpBH4Bs9BE584MdKd2ZJCYBD18N2Q1D4zvZLAjw6qaQKHH99lCWJS9F7oUybMfgMQKBgQDLP2BBfQGo2jOedtl0Yym+eg1nNbbCOT7MNR4fWJ3BAZJSijamTORA6iHN/0eKHOhZmBt5J5D4bgC7SbkjyA0N0Cj638wLyVAQmxvTQKX80Qvp91x/AOGlP9tqq6twalf3B6qtKwB+f6S1lKvwRmDAQV4ZiyNkYyroroajP2ihLQKBgQDAUSK5WiLM1ay65Oggr1qX3goaFzTvkJnp+HDYhRO2VSPFPRh7n3vKU/jacFbhgMaz3K2vBA6LoJ05MCK5w1qMRigs+gsHkVV8x3V+I7MCji4dNc8/obi/So+iiXP2SQrnjs6J1b0mbPzuBWJ1vgIhbLMbYuPZGaMTK3YOy7QqewKBgAnCelHKueisyavDUz/WfyupWrlpB+SdsRlHN7ITpEefVrJl9qfXq2I+m+7zYjEMoE+lETSpJLn5NknICX7hXVcbdsxNMNQkD5csi5KCWTYhp6vNeACVP0CbJ2Mg6TOVt7GiCZ0VIonwgS1C/VqlVoIE4YridomchXP05XwzUEflAoGAQzSXQ9qByr7oy67uh21/5Q5MzW1KrGUFxENze9aVWuRJycVd5uWGpt/NWNhlJAySY4w8jaqHQrfv+Woe2HeyDs79fyop7I0XKLGzF092YPA6oS6KrBvhqcduhkguY+SGkQDQoE42+VSg1rS/AZJSwEdyF6HpKZbR7AMGEImS/j0CgYBhxtpqycW2jkL1/z+/AyCxEPclliw5dzPDHwi5c8OgVoSo4WtZKUJzdF+KpKrhkZIZWP40p5yMAl50p50gfbfIN1KEK7AcxoGn9xQtASONrAwdkKzJTwq5hG/vEUG9yBmaM9ErS49n52S6lJgB+wLnNetYbu5cz6Nz6NkoZkiaQg==",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.RS256,
          attestationMaker = AttestationMaker.tpm(
            AttestationSigner.ca(
              alg = COSEAlgorithmIdentifier.RS256,
              certSubject = new X500Name(Array.empty[RDN]),
              certExtensions = tpmCertExtensions,
            )
          ),
        )
    }

    val ValidRs1: RegistrationTestData = new RegistrationTestData(
      alg = COSEAlgorithmIdentifier.RS1,
      attestationObject =
        ByteArray.fromHex("bf68617574684461746159016849960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97634100000539000102030405060708090a0b0c0d0e0f00201bc746ca3c93b3bbe5b5feda72c0ea5ec308b8137fd541920cc65d9ecc4cd3b1a401030339fffe2059010100a2d13b2f968f779c12ecc59c29816128da728e7e17ea099483153b08fd8078ee7bd638430bd8cef561c6a6fdddcb02ca1bb54d0afc1a47e9416e92374c062fa1229376937493bae8091cfc3c6b3fe9f92440aa597bd1af96a3c72c58ef020038c73e3a9ac476856fb6a07fc5606ed4eab4c7d1567f8ed7aede16f9f86f7d1b3f8de8544aa14a26eac934fe083844a1457c60a610f8d9bc57a5dd7c197de48eaa44a64457358bab6ac1f14a63c9f662d520c2d0424c8b78de3810bb091b75786b92839db10776e2ad9572f7d222565a2b5ff6ba769f0a3c3f28a12311123531e672f55748a3772002a43935d5b1b0c1da4267466dafaead60ae3db4fd1052e37f214301000163666d746374706d6761747453746d74bf63616c6739fffe637369675901001da18c3e41a175b65fea5474f99853693d49dd9fcafbf0e6402f74ca4971babb3aed4fdda21964e18fd689ccd9e17dc0794a5a761454fe1383061e3bd898918316f571855b923087385a037f3857e839a14bcc9ff3be3e5c9adfaebad48fe649f16d6098ac9036329184c74dd45c52891de982d2c0b69e80ec10391fe321dca47af772495c69abef0d1d0b7e4749574391370373aa3afeabb2879bf98ffb0dead8119fe0e00a0e0c485f805823f97225e8c377884814ba24bd2628f54b82f73ef343d9a5fb91c02cb299afc4d45ac8888d3465794f05e9a49b8209d8907cea78e569e736185fb08847104f7bb7d6212c1b9866b6aff4e46039916419e8e1eaab63783563825903913082038d30820275a00302010202020620300d06092a864886f70d0101050500306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a300030820122300d06092a864886f70d01010105000382010f003082010a0282010100912405950730aac20ef5dabc286c463b2212619bea17d96a6ae11780c8241b97c61ca6ccf15b4a7befbbb9ee263e980e49627517905fffd07d9eb1c91e84aa3e663a4e1bb683846961f7e1a6d5f7ac27edbc76beacc699fa3825bc44ed1667b306f1b745d3ada92c5587fde0e1a5659654bf3489455d4a604bbfbf661f462451196c2dd15db2f5e583d1936901b6a8d9a46041971705fb07eed1388ce117b423dfd29b60e20ac0ab205c081b6d0477cd8c1203a30d565c1a74623ab310d16d3e4cf486596ce103f92df8414e4835f51e96ac4ecfcd422c964cb97fd20193fd57aee06d33e48d48250189c0036aa80e3cfece7c85cd0e44ff981daf4adc69ae810203010001a381a63081a33021060b2b0601040182e51c01010404120410000102030405060708090a0b0c0d0e0f30690603551d110101ff045f305da45b305931573014060567810502010c0b69643a30303030303030303014060567810502030c0b69643a30303030303030303029060567810502020c20544553545f59756269636f5f6a6176612d776562617574686e2d73657276657230130603551d250101ff0409300706056781050803300d06092a864886f70d0101050500038201010045408e411fd40f2e7af4d26d13bd38b699a86a40c352d4a965fb6bf66c3c3e832aa01a01534925581f3ccf2cddc681b15c867c1811ee2009a10952a2f82da5ea9db2eed1791c037a6352a9d36dbc2081111b59648df3bc15e6c4e7f14e1c6635fd158d012fba273feb35ca37b7cceda750784c1e28973ef4f64bf77ca2d54d598dd86b2f4795a8e56a4ccd48b899d870685254baff6419bc45602b548ef18308baca33a23c09789eb42fb5b58edaecf1aed80ce37021cc6b4b7d047dc686a982f3ca257e91db8790a5ded4c97551528793e29f98049dad1f93dd3191ae0c3119cefc8d9a5aa61b28eb44efbc2510e1f35fafbe1ed3e39a8263cc656905df80eb590367308203633082024ba00302010202022343300d06092a864886f70d0101050500306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b3009060355040613025345301e170d3138303930363137343230305a170d3138303931333137343230305a306a3126302406035504030c1d59756269636f20576562417574686e20756e6974207465737473204341310f300d060355040a0c0659756269636f31223020060355040b0c1941757468656e74696361746f72204174746573746174696f6e310b300906035504061302534530820122300d06092a864886f70d01010105000382010f003082010a02820101008284d456f685cedd23b2e2120de3383ef98ef86c24a50f5c94fe6930124e0b66666347a51653362bf40914750e32ed02db0b28a2c1e69dd1cc5bcff7f76cb867d56b2b4e031683efd5477b30b2ee809b121a6cbb44471d2a8a9a1dc4f32c3cb439d574360184f830157eb4f84c39b96e4fa43361810b7b89d96f368a757f3e3460117976b737719409eb1be4293f9b2735d9eb54b6ce8bd3cd2fdcef8e587c44848375b4a2c9a6915a18ed642e7b127c665ee1cc036050a5b349d3e5360ad11395471a68cde6398d7afbb124476932b2103bbe079998b8f186f01c0d2abce264dd317f99815eb5e0bbaf6f1d58ed50e77dd037b9ea4b0d171c214b57e5d2478b0203010001a3133011300f0603551d130101ff040530030101ff300d06092a864886f70d0101050500038201010048ff4b2f45d9e319578314774fd5bda5426318791ed992a8491a4f4e648767d697ff022d8115b2f949c2e823f8575f4a4e9abffa6cef86791b24dd342543e21e9c08671da1193fd949cfa52cb429bceb07bc08bf723e17c5618a71399896aedda98e7e1ed179a3b9f2e894b10d2934e8936bd5def9e64a296b597832d3350ba338dd9b40ceb987d6ad1b154cc3118a44010a343b027772601d52855f0c8df9d6fad8e5fad29153c6b1ee7098c16c8ef3dd25d68d4ee1c4a4492b5e4c3a8d206acbbc94d79cb32a2c9238ff8db2da85e2416f533e21baf62c323d8f93b487dee6e200283ca8d0874ff8ba5787317bf4fb5e523c75b8ecb42711f99efdb0f49b266863657274496e666f5851ff544347801700000014d5424d6b571459a67182bfe1d1d0df65be8446150000000000000000111111112222222233000000000000000000160004a07cb80887fd98656dcd946cb85185ce2e700d9600006376657263322e3067707562417265615901170001000400040000000000100014080000010001010100a2d13b2f968f779c12ecc59c29816128da728e7e17ea099483153b08fd8078ee7bd638430bd8cef561c6a6fdddcb02ca1bb54d0afc1a47e9416e92374c062fa1229376937493bae8091cfc3c6b3fe9f92440aa597bd1af96a3c72c58ef020038c73e3a9ac476856fb6a07fc5606ed4eab4c7d1567f8ed7aede16f9f86f7d1b3f8de8544aa14a26eac934fe083844a1457c60a610f8d9bc57a5dd7c197de48eaa44a64457358bab6ac1f14a63c9f662d520c2d0424c8b78de3810bb091b75786b92839db10776e2ad9572f7d222565a2b5ff6ba769f0a3c3f28a12311123531e672f55748a3772002a43935d5b1b0c1da4267466dafaead60ae3db4fd1052e37fffff"),
      clientDataJson = """{"challenge":"AAEBAgMFCA0VIjdZEGl5Yls","origin":"https://localhost","type":"webauthn.create","tokenBinding":{"status":"supported"}}""",
      privateKey = Some(
        ByteArray.fromHex("308204c0020100300d06092a864886f70d0101010500048204aa308204a60201000282010100a2d13b2f968f779c12ecc59c29816128da728e7e17ea099483153b08fd8078ee7bd638430bd8cef561c6a6fdddcb02ca1bb54d0afc1a47e9416e92374c062fa1229376937493bae8091cfc3c6b3fe9f92440aa597bd1af96a3c72c58ef020038c73e3a9ac476856fb6a07fc5606ed4eab4c7d1567f8ed7aede16f9f86f7d1b3f8de8544aa14a26eac934fe083844a1457c60a610f8d9bc57a5dd7c197de48eaa44a64457358bab6ac1f14a63c9f662d520c2d0424c8b78de3810bb091b75786b92839db10776e2ad9572f7d222565a2b5ff6ba769f0a3c3f28a12311123531e672f55748a3772002a43935d5b1b0c1da4267466dafaead60ae3db4fd1052e37f0203010001028201010087eaac42c4a80d4c5fcc0206a3eb5a65553e6e4f3abd67b3ef5d68c3cf8350f09cb62e8f61b362c91b0f4f55fbb1be2963ca0c7f90068c635ef8e3dc7f7d6683582ecbbcba839c729930f62ba5c85c145c3c1338d21130484b7e383a21838515e0d5c4ec6ff714db361473b51c14496f88ec898770c298b064bbbf7eb1eb393396c9992b24f1d159008756565530c3bd2bf8e4d3352855890887d2eb0a1fbabeed57661bae2d159b72b4f9909ea4c34dff696788b1b71974d906bd7702663abc32ab3e2b1cd8e53a892c72d3b99621cf672f351896fee74de44c3e8c69ceabc85e4977a806e6c7a7ba50bb6fc66dfd214d1e8080cc6129e7608dcae41cbeb8e902818100d268e5a0b58bf122d06a35d94734c01816f51b659ab3fcff3f5bf272cfcd6d9ed6b8add3ede5363c0b8503a4c60826a8764d9de0b756cdfb2b672764ae8947cee902a3daa1f2dfbaf2717d27c6e66cfc9a4b468138f41ef7114ce15f042b3e2d2ad9a1b13053b7d598659881157cc0368b19b88565a9cb85238ed8635af9dff302818100c618747ed089a7cc4237d908fb0d486d2bf7a07e42658ab4c3ceab52f19722ff5da21a9f8aa2b386ea7e04dd0bd03dafdff585b34d0faadf84ddc472d6ebf82644e9281d37bcee21da8c9715018405b1f00e8333350f1ba9dcc32825ec0d7dd41a659aec04256968af1e3c909843a7f3302a6421104ccfa973cbb8b982b91d4502818100969ea49270a366d0a72500bb332fddbae0e440e270e61b5b94bd7b4718de53747afce4e26acfc40d23a9ea3bcfcf11ed5212a9cbad32a46d025aeb663552ec667f82764d11d54cb704ca9cef1680e8cfc29bd432b8d4783e20d24a1abc5f4039110d8da3cb9682689299579c4007778913f62b92c27dd3c4d0f97689591cba6502818100844adaa9c22cdc11adfb4c071259f98f66f875873c6241b29cbd8d6ed406a209b687468e5b7072c25c2192afe86ec67388f697b67975482103c372a95adcb59921163082eab152baeb104ee9695cb8ccef4b51d545cef423895a0f9adbbcdad666568a92a9e62e320a19004b7454627a2725783f187aa3883fdbc25ea96d649d02818100c8bfd89a4ba39cadbd4f08ed6ec27336d361c64f3d672cc950f4d787ea84d80461fcd3c4e8f810331e01be30bd8bb825cd29f9ebecf6a0405dbbda8643573146cff6eae9e0cb71c752d7e3b9e5de609742ac9d1ebe8942002e35a560637c2cd0fd5f6fae62c2b502fd657b71e23b5b4dcb9568e1a6ef32cbb8c351379ff656cd")
      ),
      attestationCertChain = List(
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDjTCCAnWgAwIBAgICBiAwDQYJKoZIhvcNAQEFBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjAAMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAkSQFlQcwqsIO9dq8KGxGOyISYZvqF9lqauEXgMgkG5fGHKbM8VtKe++7ue4mPpgOSWJ1F5Bf/9B9nrHJHoSqPmY6Thu2g4RpYffhptX3rCftvHa+rMaZ+jglvETtFmezBvG3RdOtqSxVh/3g4aVlllS/NIlFXUpgS7+/Zh9GJFEZbC3RXbL15YPRk2kBtqjZpGBBlxcF+wfu0TiM4Re0I9/Sm2DiCsCrIFwIG20Ed82MEgOjDVZcGnRiOrMQ0W0+TPSGWWzhA/kt+EFOSDX1HpasTs/NQiyWTLl/0gGT/Veu4G0z5I1IJQGJwANqqA48/s58hc0ORP+YHa9K3GmugQIDAQABo4GmMIGjMCEGCysGAQQBguUcAQEEBBIEEAABAgMEBQYHCAkKCwwNDg8waQYDVR0RAQH/BF8wXaRbMFkxVzAUBgVngQUCAQwLaWQ6MDAwMDAwMDAwFAYFZ4EFAgMMC2lkOjAwMDAwMDAwMCkGBWeBBQICDCBURVNUX1l1Ymljb19qYXZhLXdlYmF1dGhuLXNlcnZlcjATBgNVHSUBAf8ECTAHBgVngQUIAzANBgkqhkiG9w0BAQUFAAOCAQEARUCOQR/UDy569NJtE704tpmoakDDUtSpZftr9mw8PoMqoBoBU0klWB88zyzdxoGxXIZ8GBHuIAmhCVKi+C2l6p2y7tF5HAN6Y1Kp0228IIERG1lkjfO8FebE5/FOHGY1/RWNAS+6Jz/rNco3t8ztp1B4TB4olz709kv3fKLVTVmN2GsvR5Wo5WpMzUi4mdhwaFJUuv9kGbxFYCtUjvGDCLrKM6I8CXietC+1tY7a7PGu2AzjcCHMa0t9BH3GhqmC88olfpHbh5Cl3tTJdVFSh5Pin5gEna0fk90xka4MMRnO/I2aWqYbKOtE77wlEOHzX6++HtPjmoJjzGVpBd+A6w==",
          "RSA",
          "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCRJAWVBzCqwg712rwobEY7IhJhm+oX2Wpq4ReAyCQbl8YcpszxW0p777u57iY+mA5JYnUXkF//0H2esckehKo+ZjpOG7aDhGlh9+Gm1fesJ+28dr6sxpn6OCW8RO0WZ7MG8bdF062pLFWH/eDhpWWWVL80iUVdSmBLv79mH0YkURlsLdFdsvXlg9GTaQG2qNmkYEGXFwX7B+7ROIzhF7Qj39KbYOIKwKsgXAgbbQR3zYwSA6MNVlwadGI6sxDRbT5M9IZZbOED+S34QU5INfUelqxOz81CLJZMuX/SAZP9V67gbTPkjUglAYnAA2qoDjz+znyFzQ5E/5gdr0rcaa6BAgMBAAECggEAfPqIuAA9/vwlh7z3gtNhUnAPZe+tDyZPRYNYCrPMq9nwZSGYnkhfBgO0IfGZCxNCUhyu+UB/+bcdRLaQmW/hbOP4VuP0MKGnYQ3jSBc9Mwga5ctWe050rosEq26qvT1EYrlneIBDLMaZTAXoTEVxCZcmImYFzcRK0U9mz9gkPQYteuLAzOpRyYAc4UPLK7iGNx0flp3UD/FRRDsAL6gH23YSA6iDG/wKlS9TdcBByTX29YEilwsmO64yplg4Wgr6aJNuFULxOUWUzgDDhY9j76AMD9xF2jppPUllLQaPl5/8MXA/bKtKXcXRdthRiIGKyz+oGUJu72nbEzf2lDLvxQKBgQDdT5Ly/fSJh7bKUXT7qJBsxkzo4YXJ4qzy2U3ScFSUyZm1MsI9SS5x5GwVohdE6FlI2VBANBMxgay8sTjtwq5WkU/q5yMxsOoAijNYNZc1YoywAHGKiC/l1yiMhGiLVIvpe7pjnuC5zTCWQ+iJyaLefITToSz3+lKo/RkuRpo2zwKBgQCn5AIj4IDNht5zZLwjaqJEZVIj231Fjxs4Z11kS/QH9gHYW4ep2SQyQGyVxxysirb8rdewrG0eCVH+rIQ31TkoahEF5wWNGeptmTchesjEVr8yNkdV0VfzE7NaHPSm2H48jo//Z75MK8Rzz4eN2GURGyko5CRe614hgffUhRwZrwKBgGsJfog53Zja48SMiyjgSSHi8vW7haq0EHPQN/xsyevAabAioaFkkKsTEFeSMvDn867xNAgpZ5MNJc+JY4BTJWDHHUD+k54H89VZAiZKnRx70pGZVVDsN0ZRvtHfhHTG6nh9mBNwlz4mCLbUl1Z1CGnVDaURkh9JmcsTxqcEDLgvAoGBAIhL3kDp/SbdGrJrUSEfbGRCLRDXGzfhGaQMphDKaG4eFRlkFRqaIXx6OKzPXEPmyO8Q4k2XbW44+svZme0JuMFKek9kYWlPZLVc8RjI6TwbgFRvJDJTJSc9ExlQ8HySvMjEo7ogqqiDz5SFIfLRfhsJBb0gmTZFtcFWFa/97/YZAoGBALzrMvru5IO6IYAjtl7XLqpWqIKtDpvG25S+FpzsK32VXbQNVQGNqcRHkusvYqnT80J6S/JAqkzUOf+vtHv91duX0IAjKb12VLPNGnZYXtiJc4TYHQa8jN6CGg66z0qgNuQ3KO74SgD/KZVUv9rlKUxd7W8zUPNMsaEDUERlEWxv",
        ),
        RegistrationTestDataGenerator.importAttestationCa(
          "MIIDYzCCAkugAwIBAgICI0MwDQYJKoZIhvcNAQEFBQAwajEmMCQGA1UEAwwdWXViaWNvIFdlYkF1dGhuIHVuaXQgdGVzdHMgQ0ExDzANBgNVBAoMBll1YmljbzEiMCAGA1UECwwZQXV0aGVudGljYXRvciBBdHRlc3RhdGlvbjELMAkGA1UEBhMCU0UwHhcNMTgwOTA2MTc0MjAwWhcNMTgwOTEzMTc0MjAwWjBqMSYwJAYDVQQDDB1ZdWJpY28gV2ViQXV0aG4gdW5pdCB0ZXN0cyBDQTEPMA0GA1UECgwGWXViaWNvMSIwIAYDVQQLDBlBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uMQswCQYDVQQGEwJTRTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAIKE1Fb2hc7dI7LiEg3jOD75jvhsJKUPXJT+aTASTgtmZmNHpRZTNiv0CRR1DjLtAtsLKKLB5p3RzFvP9/dsuGfVaytOAxaD79VHezCy7oCbEhpsu0RHHSqKmh3E8yw8tDnVdDYBhPgwFX60+Ew5uW5PpDNhgQt7idlvNop1fz40YBF5drc3cZQJ6xvkKT+bJzXZ61S2zovTzS/c745YfESEg3W0osmmkVoY7WQuexJ8Zl7hzANgUKWzSdPlNgrRE5VHGmjN5jmNevuxJEdpMrIQO74HmZi48YbwHA0qvOJk3TF/mYFeteC7r28dWO1Q533QN7nqSw0XHCFLV+XSR4sCAwEAAaMTMBEwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQUFAAOCAQEASP9LL0XZ4xlXgxR3T9W9pUJjGHke2ZKoSRpPTmSHZ9aX/wItgRWy+UnC6CP4V19KTpq/+mzvhnkbJN00JUPiHpwIZx2hGT/ZSc+lLLQpvOsHvAi/cj4XxWGKcTmYlq7dqY5+HtF5o7ny6JSxDSk06JNr1d755kopa1l4MtM1C6M43ZtAzrmH1q0bFUzDEYpEAQo0OwJ3cmAdUoVfDI351vrY5frSkVPGse5wmMFsjvPdJdaNTuHEpEkrXkw6jSBqy7yU15yzKiySOP+NstqF4kFvUz4huvYsMj2Pk7SH3ubiACg8qNCHT/i6V4cxe/T7XlI8dbjstCcR+Z79sPSbJg==",
          "RSA",
          "MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCChNRW9oXO3SOy4hIN4zg++Y74bCSlD1yU/mkwEk4LZmZjR6UWUzYr9AkUdQ4y7QLbCyiiwead0cxbz/f3bLhn1WsrTgMWg+/VR3swsu6AmxIabLtERx0qipodxPMsPLQ51XQ2AYT4MBV+tPhMObluT6QzYYELe4nZbzaKdX8+NGAReXa3N3GUCesb5Ck/myc12etUts6L080v3O+OWHxEhIN1tKLJppFaGO1kLnsSfGZe4cwDYFCls0nT5TYK0ROVRxpozeY5jXr7sSRHaTKyEDu+B5mYuPGG8BwNKrziZN0xf5mBXrXgu69vHVjtUOd90De56ksNFxwhS1fl0keLAgMBAAECggEAe2nAIo6uTcF6rP3pFmqg16NAFhSjvdO9tkCuE79rPopQDFZFesup8HurTkW07GCCD78IaIWyW85yTupiTPnnkH8T+/mjH9oXoHMbwBuhO8floUjo9hHMOVqficCeM1kfDYSRgzOCmO9Wk93o3qLCfNUfrVnoHIRu/0OSre+WJqkax889ugpGnj/8JplsvaPb648VX8zhgArLSxolNYtVbpR8FCDpD46PxJAK95hGoV1LT+hfw7XWRBqszoX0vf8KMrJZxJQb9WqND1Z+E2llGBkkTj2TyJTu92GLH1sXCZfShWLqOK0qXTvONYrKbUrvFvs2yL+w5wfgcyFYzHqkIQKBgQDmAr62Q6t+nDr098wvcB0+AbO3kgup9+GXToDJ1HKob1fhuFBSnbb6rmYaNcefU6j36I+S3TnyJMK77fINAZvTxUEShTi58hlXaGECshEpoA/sDUNKhEgnZL/d0iOPUDGrWl28Xd4nggnIWM2ay0faYqhHBk/hFFgCf34blHExUQKBgQCRRDK9zVpECvIBAes45GFc3U0XtfOzQyDVKMsHZI4oTCiXzl3X1LBMfgBI8q1w/sV/pp6ATX3xw+FV8ASv/Jrcb50mCbzvyyWWmze4BIfK/6AHvu/d+l3DfD16H6eNyjB3urqrrcGK0dPzCXfJGtRIeXSQl3wmpffs7vvdFZvUGwKBgGzQB6D6SntPNaUGRZZ7l5np/Ddv5Ay4tAR8ovjYhJWidxTVuUocSqA1OSBVKOb7EQiXALUd63feZDG707LLfAinXK2CUN/G5K4xNxOrYesrSd0GOTtbcTcRtqMd8qyt55GE4qtmTN6r6izZtgrw+EEcQze2iLuWgDxOTD6H7zTBAoGAGF1H5W275g2v6VtZCIHFkr3LYF60MSzhJN9iriq/bSLY7B1AwCJ8L1gy1Alf7cPNfEuF6h8VMKeZ87/+CUZk8vQFd4vKlK2N8GS4Q7T+0Z1uSd5MfP6xG0iLRyBoCfAPkQVQqdrKy23GDs1XufM2B7HXSykdOZ48pxCuTbaCHGECgYBk7LdRO6MAK48JqUW3TDHRg3cLnC+uDRBFJLcC5VpmISJtli9UE26mSGDH1C/KbYfLfyAXe/6KRn8Rr9tazqrc28u6sb2vliyUg4fQley1NqbQ1cmP3wBve/US+NOYt9UqOK59YX6E+5ZVgsy3hOBrrctT0mYshd6df6Cl8crfAw==",
        ),
      ),
    ) {
      override def regenerate() =
        TestAuthenticator.createBasicAttestedCredential(
          keyAlgorithm = COSEAlgorithmIdentifier.RS1,
          attestationMaker = AttestationMaker.tpm(
            AttestationSigner.ca(
              alg = COSEAlgorithmIdentifier.RS1,
              certSubject = new X500Name(Array.empty[RDN]),
              certExtensions = tpmCertExtensions,
            )
          ),
        )
    }
  }

  def from(
      credential: PublicKeyCredential[
        AuthenticatorAttestationResponse,
        ClientRegistrationExtensionOutputs,
      ],
      keypair: KeyPair,
      attestationCertChain: List[(X509Certificate, PrivateKey)],
  ): RegistrationTestData =
    RegistrationTestData(
      alg = WebAuthnCodecs
        .getCoseKeyAlg(
          credential.getResponse.getParsedAuthenticatorData.getAttestedCredentialData.get.getCredentialPublicKey
        )
        .get,
      attestationObject = credential.getResponse.getAttestationObject,
      clientDataJson = new String(
        credential.getResponse.getClientDataJSON.getBytes,
        StandardCharsets.UTF_8,
      ),
      privateKey = Some(new ByteArray(keypair.getPrivate.getEncoded)),
      attestationCertChain = attestationCertChain,
    )
}

case class RegistrationTestData(
    alg: COSEAlgorithmIdentifier,
    assertion: Option[AssertionTestData] = None,
    attestationObject: ByteArray,
    attestationCertChain: List[(X509Certificate, PrivateKey)] = Nil,
    attestationRootCertificate: Option[X509Certificate] = None,
    clientDataJson: String,
    authenticatorSelection: Option[AuthenticatorSelectionCriteria] = None,
    clientExtensionResults: ClientRegistrationExtensionOutputs =
      ClientRegistrationExtensionOutputs.builder().build(),
    privateKey: Option[ByteArray] = None,
    overrideRequest: Option[PublicKeyCredentialCreationOptions] = None,
    requestedExtensions: RegistrationExtensionInputs =
      RegistrationExtensionInputs.builder().build(),
    rpId: RelyingPartyIdentity =
      RelyingPartyIdentity.builder().id("localhost").name("Test party").build(),
    userId: UserIdentity = UserIdentity
      .builder()
      .name("test@test.org")
      .displayName("Test user")
      .id(new ByteArray(Array(42, 13, 37)))
      .build(),
    transports: Set[AuthenticatorTransport] = Set.empty,
) {
  validate()

  def regenerate(): (
      PublicKeyCredential[
        AuthenticatorAttestationResponse,
        ClientRegistrationExtensionOutputs,
      ],
      KeyPair,
      List[(X509Certificate, PrivateKey)],
  ) = ???
  def regenerateFull(): Try[RegistrationTestData] =
    Try({
      val (credential, keypair, attestationCertChain) = regenerate()
      val newValue =
        RegistrationTestData.from(credential, keypair, attestationCertChain)
      newValue.copy(
        assertion = assertion.map(_.regenerate(newValue))
      )
    })

  protected def validate(): Unit = {
    val alg = WebAuthnCodecs
      .getCoseKeyAlg(
        response.getResponse.getParsedAuthenticatorData.getAttestedCredentialData.get.getCredentialPublicKey
      )
      .get
    assert(alg == this.alg, s"Expected alg: ${this.alg}; was: ${alg}")
  }

  def clientDataJsonBytes: ByteArray =
    new ByteArray(clientDataJson.getBytes("UTF-8"))
  def clientData = new CollectedClientData(clientDataJsonBytes)
  def clientDataJsonHash: ByteArray = Crypto.sha256(clientDataJsonBytes)
  def aaguid: ByteArray =
    new AttestationObject(
      attestationObject
    ).getAuthenticatorData.getAttestedCredentialData.get.getAaguid
  def packedAttestationCert: X509Certificate =
    CertificateParser.parseDer(
      new AttestationObject(attestationObject).getAttestationStatement
        .get("x5c")
        .get(0)
        .binaryValue
    )

  def editClientData(updater: ObjectNode => JsonNode): RegistrationTestData =
    copy(
      clientDataJson = JacksonCodecs.json.writeValueAsString(
        updater(
          JacksonCodecs.json.readTree(clientDataJson).asInstanceOf[ObjectNode]
        )
      )
    )

  def editClientData(name: String, value: JsonNode): RegistrationTestData =
    editClientData { clientData: ObjectNode =>
      clientData.set[ObjectNode](name, value)
    }
  def editClientData(name: String, value: String): RegistrationTestData =
    editClientData(name, RegistrationTestData.jsonFactory.textNode(value))
  def responseChallenge: ByteArray = clientData.getChallenge

  def editClientData(name: String, value: ByteArray): RegistrationTestData =
    editClientData(
      name,
      RegistrationTestData.jsonFactory.textNode(value.getBase64Url),
    )

  def editAttestationObject(
      name: String,
      value: JsonNode,
  ): RegistrationTestData =
    copy(
      attestationObject = new ByteArray(
        JacksonCodecs.cbor.writeValueAsBytes(
          JacksonCodecs.cbor
            .readTree(attestationObject.getBytes)
            .asInstanceOf[ObjectNode]
            .set(name, value)
        )
      )
    )
  def updateAttestationObject(
      name: String,
      updater: JsonNode => JsonNode,
  ): RegistrationTestData = {
    val attObj = JacksonCodecs.cbor.readTree(attestationObject.getBytes)
    copy(
      attestationObject = new ByteArray(
        JacksonCodecs.cbor.writeValueAsBytes(
          attObj
            .asInstanceOf[ObjectNode]
            .set(name, updater(attObj.get(name)))
        )
      )
    )
  }

  def setAttestationStatementFormat(value: String): RegistrationTestData =
    editAttestationObject(
      "fmt",
      RegistrationTestData.jsonFactory.textNode(value),
    )

  def editAuthenticatorData(
      updater: ByteArray => ByteArray
  ): RegistrationTestData = {
    val attObj: ObjectNode = JacksonCodecs.cbor
      .readTree(attestationObject.getBytes)
      .asInstanceOf[ObjectNode]
    val authData: ByteArray = new ByteArray(attObj.get("authData").binaryValue)
    editAttestationObject(
      "authData",
      RegistrationTestData.jsonFactory.binaryNode(updater(authData).getBytes),
    )
  }

  def request: PublicKeyCredentialCreationOptions =
    overrideRequest getOrElse PublicKeyCredentialCreationOptions
      .builder()
      .rp(rpId)
      .user(userId)
      .challenge(clientData.getChallenge)
      .pubKeyCredParams(
        List(
          PublicKeyCredentialParameters.ES256,
          PublicKeyCredentialParameters.EdDSA,
          PublicKeyCredentialParameters.ES384,
          PublicKeyCredentialParameters.ES512,
          PublicKeyCredentialParameters.RS256,
        ).asJava
      )
      .extensions(requestedExtensions)
      .authenticatorSelection(authenticatorSelection.toJava)
      .build()

  def response: PublicKeyCredential[
    AuthenticatorAttestationResponse,
    ClientRegistrationExtensionOutputs,
  ] =
    PublicKeyCredential
      .builder()
      .id(
        new AttestationObject(
          attestationObject
        ).getAuthenticatorData.getAttestedCredentialData.get.getCredentialId
      )
      .response(
        AuthenticatorAttestationResponse
          .builder()
          .attestationObject(attestationObject)
          .clientDataJSON(clientDataJsonBytes)
          .transports(transports.asJava)
          .build()
      )
      .clientExtensionResults(clientExtensionResults)
      .build()

  def keypair: Option[KeyPair] =
    privateKey map { privateKey =>
      val pubKeyCoseBytes = new AttestationObject(
        attestationObject
      ).getAuthenticatorData.getAttestedCredentialData.get.getCredentialPublicKey
      val pubkey = WebAuthnCodecs.importCosePublicKey(pubKeyCoseBytes)
      val prikey = WebAuthnTestCodecs.importPrivateKey(
        privateKey,
        WebAuthnCodecs.getCoseKeyAlg(pubKeyCoseBytes).get,
      )
      new KeyPair(pubkey, prikey)
    }
}

case class AssertionTestData(
    request: AssertionRequest,
    response: PublicKeyCredential[
      AuthenticatorAssertionResponse,
      ClientAssertionExtensionOutputs,
    ],
) {
  def regenerate(testData: RegistrationTestData): AssertionTestData = {
    copy(
      response = TestAuthenticator.createAssertionFromTestData(
        testData,
        request.getPublicKeyCredentialRequestOptions,
      )
    )
  }
}
